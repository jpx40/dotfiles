(()=>{var e={412:function(e,t){var n,r,s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],n=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const s=e=>e&&"object"==typeof e&&"function"==typeof e.then,i=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},a=e=>1==e?"argument":"arguments",o=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((s,a)=>{if(t.fallbackToNoCallback)try{n[e](...r,i({resolve:s,reject:a},t))}catch(i){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,s()}else t.noCallback?(n[e](...r),s()):n[e](...r,i({resolve:s,reject:a},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,s)=>n.call(r,e,...s)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const u=(e,t={},n={})=>{let r=Object.create(null),s={has:(t,n)=>n in e||n in r,get(s,i,a){if(i in r)return r[i];if(!(i in e))return;let g=e[i];if("function"==typeof g)if("function"==typeof t[i])g=c(e,e[i],t[i]);else if(l(n,i)){let t=o(i,n[i]);g=c(e,e[i],t)}else g=g.bind(e);else if("object"==typeof g&&null!==g&&(l(t,i)||l(n,i)))g=u(g,t[i],n[i]);else{if(!l(n,"*"))return Object.defineProperty(r,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),g;g=u(g,t[i],n["*"])}return r[i]=g,g},set:(t,n,s,i)=>(n in r?r[n]=s:e[n]=s,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},i=Object.create(e);return new Proxy(i,s)},g=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),d=new r((e=>"function"!=typeof e?e:function(t){const n=u(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),h=new r((e=>"function"!=typeof e?e:function(t,n,r){let i,a,o=!1,c=new Promise((e=>{i=function(t){o=!0,e(t)}}));try{a=e(t,n,i)}catch(e){a=Promise.reject(e)}const l=!0!==a&&s(a);if(!0!==a&&!l&&!o)return!1;const u=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return u(l?a:c),!0})),m=({reject:n,resolve:r},s)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?n(new Error(s.message)):r(s)},_=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const s=m.bind(null,{resolve:e,reject:t});r.push(s),n.sendMessage(...r)}))},E={devtools:{network:{onRequestFinished:g(d)}},runtime:{onMessage:g(h),onMessageExternal:g(h),sendMessage:_.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:_.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},u(e,E,n)};e.exports=n(chrome)}else e.exports=globalThis.browser},void 0===(s="function"==typeof n?n.apply(t,r):n)||(e.exports=s)}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{ACCOUNT_STATUS_RECHECK_INTERVAL:()=>o,BASE_REPHRASING_SERVER_URL:()=>T,BASE_SERVER_URL:()=>S,BLACKLISTED_DOMAINS:()=>Ae,CHECK_DELAY:()=>V,CHECK_MAX_DELAY:()=>j,CHECK_REQUEST_TIMEOUT:()=>_,CHECK_THROTTLING_LIMIT:()=>E,CLIENT_LOGIN_URL:()=>O,COLORS:()=>z,COLORS_ON_DARK:()=>q,COUNTRY_COUPON_MAPPING:()=>se,COUPON_INTERVAL:()=>ie,DICTIONARY_SYNC_INTERVAL:()=>d,ERRORS_THAT_CAN_BE_CORRECTED_ALL_AT_ONCE:()=>ue,EXTENSION_HEALTH_RECHECK_INTERVAL:()=>i,EXTERNAL_CONFIG_RELOAD_INTERVAL:()=>c,EXTERNAL_CONFIG_URL:()=>v,FEEDBACK_SERVER_URL:()=>N,HOVER_DELAY:()=>Z,HOVER_MAX_DELAY:()=>K,HTTP_ERROR_ABORT:()=>Ee,HTTP_ERROR_GENERIC:()=>fe,HTTP_ERROR_TIMEOUT:()=>pe,IFRAME_INITILIZATION_RECHECK_INTERVAL:()=>g,INSTALL_URL:()=>p,LOCAL_SERVER_URL:()=>y,MAIN_FALLBACK_SERVER_URL:()=>I,MAIN_SERVER_RECHECK_INTERVAL:()=>x,MAIN_SERVER_URL:()=>C,MASCOT_NAME:()=>le,MAX_EXCEPTION_COUNT:()=>Q,MAX_FIXES_COUNT:()=>J,MAX_FREEMIUM_REPHRASINGS_PER_DAY:()=>he,MAX_TEXT_LENGTH:()=>k,MAX_TEXT_LENGTH_CUSTOM_SERVER:()=>W,MAX_TEXT_LENGTH_PERFORMANCE_DEGRADATION:()=>F,MAX_TEXT_LENGTH_PREMIUM:()=>B,MAX_USAGE_COUNT_ONBOARDING:()=>ee,MIN_TEXT_LENGTH:()=>U,NARROW_WHITESPACE_REGEXP:()=>_e,PACKAGE:()=>ae,PARAGRAPH_LEVEL_CHUNK_LENGTH:()=>H,PICKY_RULES_THAT_ARE_CONSIDERED_ANNOYING:()=>oe,PING_INTERVAL:()=>l,PING_URL:()=>b,PREMIUM_FALLBACK_SERVER_URL:()=>P,PREMIUM_SERVER_URL:()=>R,RELIABLE_MOTHER_TONGUES:()=>de,RENDER_INTERVAL:()=>h,RULES_ALLOWED_TO_BE_SENT_TO_API:()=>ce,SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES_INTERVAL:()=>$,SHORT_TEXT_MAX_LENGTH:()=>M,STATISTICS_URL:()=>D,STOPPED_TYPING_TIMEOUT:()=>Y,SUPPORTED_REPHRASE_LANGUAGES:()=>te,SUPPORTED_SENTENCE_SPLITTING_LANGUAGES:()=>ne,SUPPORTED_SYNONYM_LANGUAGES:()=>re,SWITCH_TO_FALLBACK_SERVER_ERRORS:()=>w,SYNC_USER_DATA_INTERVAL:()=>u,TEXT_LEVEL_MAX_LENGTH_PER_REQUEST:()=>G,TOOLBAR_DECREASE_SIZE_INTERVAL:()=>m,TRACK_RULE_EVENT_LANGUAGES:()=>ge,TRAILING_WHITESPACE_REGEXP:()=>me,UI_MODE_RECHECK_INTERVAL:()=>a,UNINSTALL_URL:()=>f,USER_ACTIVITY_PING_INTERVAL_LENGTH:()=>X,USER_DATA_URL:()=>A,WEBAPI_URL:()=>L});
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class t{static _contructor(){if(this._isInitialized)return;t._isChromium=navigator.userAgent.includes("Chrome/")||navigator.userAgent.includes("Chromium/"),t._isFirefox=navigator.userAgent.includes("Firefox/"),t._isThunderbird=navigator.userAgent.includes("Thunderbird/"),t._isOpera=navigator.userAgent.includes("OPR/"),t._isEdge=navigator.userAgent.includes("Edg/"),t._isOldEdge=navigator.userAgent.includes("Edge/"),t._isSafari=(navigator.userAgent.includes("Safari/")||navigator.userAgent.includes("AppleWebKit"))&&!t._isChromium&&!t._isEdge&&!t._isOpera,t._isYaBrowser=navigator.userAgent.includes("YaBrowser/"),t._isChrome=t._isChromium&&!t._isOpera&&!t._isEdge&&!t._isOldEdge&&!t._isYaBrowser;const e=navigator.userAgent.match(/Chrome\/(\d+)/);e&&(t._isUnsupportedChrome=parseInt(e[1])<67&&!navigator.userAgent.includes("Edge/"));const n=navigator.userAgent.match(/Firefox\/(\d+)/);n&&(t._isUnsupportedFirefox=parseInt(n[1])<60),this._isInitialized=!0}static getOS(){return navigator.userAgent.includes("Macintosh")?"Mac":navigator.userAgent.includes("Windows")?"Windows":navigator.userAgent.includes("CrOS")?"CrOS":navigator.userAgent.includes("Linux")?"Linux":"Other"}static isChromium(){return t._isChromium}static isChrome(){return t._isChrome}static isThunderbird(){return t._isThunderbird}static isFirefox(){return t._isFirefox}static isOpera(){return t._isOpera}static isEdge(){return t._isEdge}static isSafari(){return t._isSafari}static isYaBrowser(){return t._isYaBrowser}static isUnsupportedChrome(){return t._isUnsupportedChrome}static isUnsupportedFirefox(){return t._isUnsupportedFirefox}static isUnsupportedBrowser(){return t.isUnsupportedChrome()||t.isUnsupportedFirefox()}static getBrowserName(){return t.isChrome()?"Chrome":t.isFirefox()?"Firefox":t.isOpera()?"Opera":t.isEdge()?"Edge":t.isSafari()?"Safari":t.isYaBrowser()?"Yandex":"Unknown Browser"}static getUserAgentIdentifier(){let e="webextension";return this.isChrome()?e+="-chrome":this.isFirefox()?e+="-firefox":this.isOpera()?e+="-opera":this.isEdge()?e+="-edge":this.isYaBrowser()?e+="-chrome":this.isSafari()?e+="-safari":e+="-unknown",e+"-ng"}static isTouchDevice(){if(!("ontouchstart"in self))return!1;const e=navigator.userAgent.includes("Android");return this.isIOS()||e}static isIOS(){const e=navigator.userAgent.includes("iPhone OS"),t=navigator.userAgent.includes("Macintosh")&&Boolean(navigator.maxTouchPoints&&navigator.maxTouchPoints>2);return e||t}static isIOSTouchDevice(){return"ontouchstart"in self&&this.isIOS()}static isMacApp(){return navigator.userAgent.includes("AppleWebKit/")&&navigator.userAgent.includes("LanguageTool/")&&!navigator.userAgent.includes("Chrome/")&&!navigator.userAgent.includes("Chromium/")}static isWindowsApp(){return navigator.userAgent.includes("LanguageToolWindows/")}}t._isChromium=!1,t._isChrome=!1,t._isFirefox=!1,t._isThunderbird=!1,t._isOpera=!1,t._isOldEdge=!1,t._isEdge=!1,t._isSafari=!1,t._isYaBrowser=!1,t._isUnsupportedChrome=!1,t._isUnsupportedFirefox=!1,t._isInitialized=!1,t._contructor();
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class r{}const s=class{static init(e){this._instance=e}static isProductionEnvironment(){return this._instance.isProductionEnvironment()}static isRuntimeConnected(){return this._instance.isRuntimeConnected()}static getVersion(){return this._instance.getVersion()}static getTrackingId(){return this._instance.getTrackingId()}static shouldTrack(){return this._instance.shouldTrack()}static getType(){return this._instance.getType()}static getBeforeUnloadEventName(){return this._instance.getBeforeUnloadEventName()}static getURL(e){return this._instance.getURL(e)}static getUILanguageCode(){return this._instance.getUILanguageCode()}static openWindow(e){return this._instance.openWindow(e)}static loadContentScripts(e,t){return this._instance.loadContentScripts(e,t)}static initializeLTAssistant(e,t={}){return this._instance.initializeLTAssistant(e,t)}static getPreferredLanguages(){return this._instance.getPreferredLanguages()}static startDictionarySync(){return this._instance.startDictionarySync()}static addWordToDictionary(e){return this._instance.addWordToDictionary(e)}static addWordsToDictionary(e){return this._instance.addWordsToDictionary(e)}static removeWordFromDictionary(e){return this._instance.removeWordFromDictionary(e)}static clearDictionary(){return this._instance.clearDictionary()}static updateDictionary(){return this._instance.updateDictionary()}static injectExecutor(){return this._instance.injectExecutor()}static destroyExecutor(){return this._instance.destroyExecutor()}static executeScript(e,t){return this._instance.executeScript(e,t)}static linkInputAreaProperties(e){return this._instance.linkInputAreaProperties(e)}static ping(){return this._instance.ping()}static loadSynonyms(e,t,n){return this._instance.loadSynonyms(e,t,n)}static abortSynonymsRequest(){return this._instance.abortSynonymsRequest()}static loadPhrases(e,t,n,r,s){return this._instance.loadPhrases(e,t,n,r,s)}static reportPhrase(e,t){return this._instance.reportPhrase(e,t)}static initializeUserActivity(e){return this._instance.initializeUserActivity(e)}static sendUserActivityPings(e){return this._instance.sendUserActivityPings(e)}static updateUserActivityTextStatistics(e,t){return this._instance.updateUserActivityTextStatistics(e,t)}static updateUserActivityAppliedSuggestions(e,t,n){return this._instance.updateUserActivityAppliedSuggestions(e,t,n)}static updateUserActivityAppliedRewritings(e){return this._instance.updateUserActivityAppliedRewritings(e)}static updateUserActivityMeta(e,t){return this._instance.updateUserActivityMeta(e,t)}static sendUserActivity(e){return this._instance.sendUserActivity(e)}static destroyUserActivity(e){return this._instance.destroyUserActivity(e)}static abortPhraseRequests(e){return this._instance.abortPhraseRequests(e)}static loadSplitSentence(e,t,n,r,s){return this._instance.loadSplitSentence(e,t,n,r,s)}static trackEvent(e,t){return this._instance.trackEvent(e,t)}static trackTextLength(e){return this._instance.trackTextLength(e)}static pageLoaded(e,t,n,r,s,i){return this._instance.pageLoaded(e,t,n,r,s,i)}static ltAssistantStatusChanged(e,t){return"number"==typeof e?this._instance.ltAssistantStatusChanged(e,t):this._instance.ltAssistantStatusChanged(e)}static check(e,t,n,r,s,i,a){return this._instance.check(e,t,n,r,s,i,a)}static isOptionsPageSupported(){return this._instance.isOptionsPageSupported()}static openOptionsPage(e,t){return this._instance.openOptionsPage(e,t)}static isFeedbackFormSupported(){return this._instance.isFeedbackFormSupported()}static openFeedbackForm(e,t,n){return this._instance.openFeedbackForm(e,t,n)}static openPremiumPage(e,t=0,n=0,r=0,s="",i){return this._instance.openPremiumPage(e,t,n,r,s,i)}static checkForPaidSubscription(){return this._instance.checkForPaidSubscription()}},i=3e3,a=6e4,o=36e5,c=144e5,l=864e5,u=864e5,g=1500,d=72e5,h=300,m=900,_=5e4,E=30,p="https://languagetool.org/webextension/welcome",f="https://languagetool.org/webextension/uninstall",A="https://languagetool.org/webextension/user",S="https://api.languagetool.org",T="https://rewriting.languagetoolplus.com",C=`${S}/v2`,I="https://api-fallback.languagetool.org/v2",R="https://api.languagetoolplus.com/v2",P="https://languagetoolplus.com/api/v2",y="http://localhost:8081/v2",N="https://languagetool.org/send-feedback/",v="https://languagetool.org/webextension_config.json",O="https://languagetool.org/client-login",b="https://languagetool.org/ping",L="https://languagetool.org/webapi",D="https://api.languagetoolplus.com/statistics/api/store",w=[502,503,504],x=18e4,U=4,M=50,k=1e4,G=2e4,F=4e4,B=15e4,W=Number.MAX_SAFE_INTEGER,H=5e3,V=1400,j=3500,Y=2250,Z=50,K=200,X=1e4,$=6e4,z={GRAMMAR:{UNDERLINE:"#f2b24c",BACKGROUND:"rgba(242,179,77,0.3)",EMPHASIZE:"rgba(241,179,76,0.1)"},STYLE:{UNDERLINE:"#8F7FFF",BACKGROUND:"rgba(142,128,255,0.2)",EMPHASIZE:"rgba(138,128,255,0.2)",TITLE:"#5C4CFF"},LONG_SENTENCE:{UNDERLINE:"#D2CBFF",BACKGROUND:"rgba(210,203,255,0.2)",EMPHASIZE:"rgba(210,203,255,0.1)"},IGNORED_RANGE:{UNDERLINE:"#00bbe6",BACKGROUND:"rgb(92, 222, 251, 0.2)",EMPHASIZE:"rgb(154, 232, 250, 0.1)"},SPELLING:{UNDERLINE:"#EB5757",BACKGROUND:"rgba(235,88,88,0.2)",EMPHASIZE:"rgba(239,88,88,0.1)"},SYNONYMS:{UNDERLINE:"#0042d7"},NEW_SENTENCE:{BACKGROUND:"rgba(30, 225, 151, 0.2)"},DISABLED:{UNDERLINE:"rgba(0, 0, 0, 0.2)",BACKGROUND:"rgba(0, 0, 0, 0.2)",EMPHASIZE:"rgba(0, 0, 0, 0.2)",TITLE:"rgba(0, 0, 0, 0.2)"}},q=Object.assign(Object.assign({},z),{DISABLED:{UNDERLINE:"rgba(255, 255, 255, 0.3)",BACKGROUND:"rgba(255, 255, 255, 0.3)",EMPHASIZE:"rgba(255, 255, 255, 0.3)",TITLE:"rgba(255, 255, 255, 0.3)"}}),J=5,Q=6,ee=5,te=["en","de","fr","nl","es","pt-BR","pt-PT"],ne=["en"],re=["de","de-CH","ru","sv","pt","pt-BR","el","en","eo","it","fr","es","uk","sk","sl","pl","da","ro","nl","ca"],se={UKRAINE:{countries:["UA","BY"],percent:50},"ITALY-DISCOUNT":{countries:["IT"],percent:20},"SPAIN-DISCOUNT":{countries:["ES"],percent:20},SOUTH_EUROPE:{countries:["RO","AL","GR","ME","EE","LT","LV","BG","CY","MT","SK","SI","RS","HR","XK","HU","MD","TR","PT"],percent:20},AFRICA:{countries:["NG","ET","EG","CD","CG","TZ","KE","UG","DZ","SD","MA","AO","MZ","TN","CI","DJ","SZ","MU","GQ","GA","BW","SO","CD","ER","MG"],percent:50},ASIA:{countries:["ID","PK","BD","VN","MM","PH","UZ","MY","NP","KZ","KH","UZ","TH","YE","SY","JO"],percent:50},LATIN_AMERICA:{countries:["PE","VE","EC","SV","DO","BO","SR","AR","HN","BZ","CR","PA","GT","NI","GY","UY","HT","JM","TT","CU"],percent:50},BRAZIL:{countries:["BR"],percent:50}},ie=5184e6,ae={BASIC:"Basic",PREMIUM:"Premium"},oe=["EN_QUOTES","PASSIVE_VOICE","DASH_RULE","SENTENCE_FRAGMENT","PONCTUATION_DOUBLE","TOO_LONG_SENTENCE","COMETES_TIPOGRAFIQUES","APOSTROF_TIPOGRAFIC","FALSCHE_VERWENDUNG_DES_BINDESTRICHS","HALBGEVIERTSTRICH","PARAGRAF_LEERZEICHEN","TYPOGRAFISCHE_APOSTROPHE","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH","TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2","PUNCTUATION_PARAGRAPH_END","FINAL_STOPS","FINAL_PUNCTUATION","SMART_QUOTES","DASH_SPACE_RULES","HIPHEN_SPACE_RULES","BRAK_KROPKI","DYWIZ","CUDZYSLOW_DRUKARSKI","EINDE_ZIN_ONVERWACHT","BACKTICK","GEDACHTESTREEPJE","OPTIONAL_HYPHEN","COMILLAS_TIPOGRAFICAS","COMETES_TIPOGRAFIQUES"],ce=["OXFORD_SPELLING_Z_NOT_S"],le="jeremy",ue=[{ruleId:"FALSCHES_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[„“]/,message:"Alle <lt-em>“</lt-em>…<lt-em>”</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN",suggestions:[{match:/[„“]/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"},{match:/(^»)|(«$)/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>»</lt-em>…<lt-em>«</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_CH",suggestions:[{match:/[„“]/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"},{match:/(^«)|(»$)/,message:"Alle <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> zu <lt-em>«</lt-em>…<lt-em>»</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN_2",suggestions:[{match:/[‚‘]/,message:"Alle <lt-em>'</lt-em>…<lt-em>'</lt-em> zu <lt-em>‚</lt-em>…<lt-em>‘</lt-em> ändern"},{match:/[„“]/,message:"Alle <lt-em>'</lt-em>…<lt-em>'</lt-em> zu <lt-em>„</lt-em>…<lt-em>“</lt-em> ändern"}]},{ruleId:"TYPOGRAFISCHE_APOSTROPHE",suggestions:[{match:/’/,message:"Alle Apostrophe zu <lt-em>’</lt-em> ändern"}]},{ruleId:"EN_QUOTES",suggestions:[{match:/[“”]/,message:"Change all <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> to <lt-em>“</lt-em>…<lt-em>”</lt-em>"}]},{ruleId:"WRONG_APOSTROPHE",suggestions:[{match:/'/,message:"Use <lt-em>'</lt-em> for all bad apostrophes"},{match:/’/,message:"Use <lt-em>’</lt-em> for all bad apostrophes"}]},{ruleId:"PARAGRAF_LEERZEICHEN",suggestions:[{match:/§\u00A0/,message:"Alle Leerzeichen nach <lt-em>§</lt-em> ändern"}]},{ruleId:"CONSISTENCYRULE_JE_F",suggestions:[{match:/[^e]$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le masculin"}]},{ruleId:"CONSISTENCYRULE_JE_M",suggestions:[{match:/e$/,message:"Remplacer tous les <lt-em>je</lt-em> vers le féminin"}]},{ruleId:"COMILLAS_TIPOGRAFICAS",suggestions:[{match:/[“”]/,message:"Cambiar todas las <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> por <lt-em>“</lt-em>…<lt-em>”</lt-em>"},{match:/(^«)|(»$)/,message:"Cambiar todas las <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> por <lt-em>«</lt-em>…<lt-em>»</lt-em>"}]},{ruleId:"COMETES_TIPOGRAFIQUES",suggestions:[{match:/[“”]/,message:"Canvia totes les <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> per <lt-em>“</lt-em>…<lt-em>”</lt-em>"},{match:/(^«)|(»$)/,message:"Canvia totes les <lt-em>&quot;</lt-em>…<lt-em>&quot;</lt-em> per <lt-em>«</lt-em>…<lt-em>»</lt-em>"}]}],ge=["en","de","es","ca","fr","nl","pt"],de=["de","fr"],he=3,me=/^[ \u00A0]|[ \u00A0]$/g,_e=/\u202F/g,Ee="E_ABORT",pe="E_TIMEOUT",fe="E_GENERIC",Ae=["googlesyndication.com","csync.smartadserver.com","csync-eu.smartadserver.com","csync-global.smartadserver.com","secure-assets.rubiconproject.com","eus.rubiconproject.com","cdn.flashtalking.com","gum.criteo.com","g.doubleclick.net","fls.doubleclick.net","ad.doubleclick.net","td.doubleclick.net","widgets.outbrain.com","asadcdn.com","cdn.optimizely.com","cdn-gl.nmrodam.com","s0.2mdn.net","c1.adform.net","acdn.adnxs-simple.com","vastcdn.outbrain.com","ad.yieldlab.net","js-sec.indexww.com","acdn.adnxs.com","amazon-adsystem.com","ib.adnxs.com","p.fasdeliver.com","cdn.krxd.net","ih.adscale.de","adstax-match.adrtx.net","ads.pubmatic.com","ssum-sec.casalemedia.com","as.jivox.com","ads.justpremium.com","mafo.adalliance.io","rtb.gumgum.com","p.teads.tv","sync.teads.tv","imagesrv.adition.com","usersync.gumgum.com","as.ad4m.at","cdn.cxense.com","dco-assets.everestads.net","yieldlove-d.openx.net","static.emsservice.de","secureir.ebaystatic.com","imasdk.googleapis.com","cs.iqzone.com","st.pubmatic.com","prebid.a-mo.net","bh.contextweb.com","capi.connatix.com","google-bidout-d.openx.net","consent.yahoo.com","tsdtocl.com","tag.idsync.analytics.yahoo.com","g2.gumgum.com","cs-server-s2s.yellowblue.io","cs-rtb.minutemedia-prebid.com","sync.adkernel.com","ads.servenobid.com","contextual.media.net","public.servenobid.com","onetag-sys.com","eu-u.openx.net","u.openx.net","ap.lijit.com","3lift.com","ssbsync.smartadserver.com","cs.seedtag.com","visitor.omnitagjs.com","api.theadex.com","pandg.tapad.com","tag.userreport.com","sync.richaudience.com","adfarm1.adition.com","adfarm2.adition.com"];function Se(){var e=0,t=1,n=2,r=3,s=4,i=5,a=6,o=7,c=8,l=9,u=10,g=12,d=13,h=14,m=15,_=16,E=17;function p(e,t){void 0===t&&(t=0);var n=e.charCodeAt(t);if(55296<=n&&n<=56319&&t<e.length-1){var r=n;return 56320<=(s=e.charCodeAt(t+1))&&s<=57343?1024*(r-55296)+(s-56320)+65536:r}if(56320<=n&&n<=57343&&t>=1){var s=n;return 55296<=(r=e.charCodeAt(t-1))&&r<=56319?1024*(r-55296)+(s-56320)+65536:s}return n}function f(p,f,A){var S=[p].concat(f).concat([A]),T=S[S.length-2],C=A,I=S.lastIndexOf(h);if(I>1&&S.slice(1,I).every((function(e){return e==r}))&&-1==[r,d,E].indexOf(p))return 2;var R=S.lastIndexOf(s);if(R>0&&S.slice(1,R).every((function(e){return e==s}))&&-1==[g,s].indexOf(T))return S.filter((function(e){return e==s})).length%2==1?3:4;if(T==e&&C==t)return 0;if(T==n||T==e||T==t)return C==h&&f.every((function(e){return e==r}))?2:1;if(C==n||C==e||C==t)return 1;if(T==a&&(C==a||C==o||C==l||C==u))return 0;if(!(T!=l&&T!=o||C!=o&&C!=c))return 0;if((T==u||T==c)&&C==c)return 0;if(C==r||C==m)return 0;if(C==i)return 0;if(T==g)return 0;var P=-1!=S.indexOf(r)?S.lastIndexOf(r)-1:S.length-2;return-1!=[d,E].indexOf(S[P])&&S.slice(P+1,-1).every((function(e){return e==r}))&&C==h||T==m&&-1!=[_,E].indexOf(C)?0:-1!=f.indexOf(s)?2:T==s&&C==s?0:1}function A(p){return 1536<=p&&p<=1541||1757==p||1807==p||2274==p||3406==p||69821==p||70082<=p&&p<=70083||72250==p||72326<=p&&p<=72329||73030==p?g:13==p?e:10==p?t:0<=p&&p<=9||11<=p&&p<=12||14<=p&&p<=31||127<=p&&p<=159||173==p||1564==p||6158==p||8203==p||8206<=p&&p<=8207||8232==p||8233==p||8234<=p&&p<=8238||8288<=p&&p<=8292||8293==p||8294<=p&&p<=8303||55296<=p&&p<=57343||65279==p||65520<=p&&p<=65528||65529<=p&&p<=65531||113824<=p&&p<=113827||119155<=p&&p<=119162||917504==p||917505==p||917506<=p&&p<=917535||917632<=p&&p<=917759||918e3<=p&&p<=921599?n:768<=p&&p<=879||1155<=p&&p<=1159||1160<=p&&p<=1161||1425<=p&&p<=1469||1471==p||1473<=p&&p<=1474||1476<=p&&p<=1477||1479==p||1552<=p&&p<=1562||1611<=p&&p<=1631||1648==p||1750<=p&&p<=1756||1759<=p&&p<=1764||1767<=p&&p<=1768||1770<=p&&p<=1773||1809==p||1840<=p&&p<=1866||1958<=p&&p<=1968||2027<=p&&p<=2035||2070<=p&&p<=2073||2075<=p&&p<=2083||2085<=p&&p<=2087||2089<=p&&p<=2093||2137<=p&&p<=2139||2260<=p&&p<=2273||2275<=p&&p<=2306||2362==p||2364==p||2369<=p&&p<=2376||2381==p||2385<=p&&p<=2391||2402<=p&&p<=2403||2433==p||2492==p||2494==p||2497<=p&&p<=2500||2509==p||2519==p||2530<=p&&p<=2531||2561<=p&&p<=2562||2620==p||2625<=p&&p<=2626||2631<=p&&p<=2632||2635<=p&&p<=2637||2641==p||2672<=p&&p<=2673||2677==p||2689<=p&&p<=2690||2748==p||2753<=p&&p<=2757||2759<=p&&p<=2760||2765==p||2786<=p&&p<=2787||2810<=p&&p<=2815||2817==p||2876==p||2878==p||2879==p||2881<=p&&p<=2884||2893==p||2902==p||2903==p||2914<=p&&p<=2915||2946==p||3006==p||3008==p||3021==p||3031==p||3072==p||3134<=p&&p<=3136||3142<=p&&p<=3144||3146<=p&&p<=3149||3157<=p&&p<=3158||3170<=p&&p<=3171||3201==p||3260==p||3263==p||3266==p||3270==p||3276<=p&&p<=3277||3285<=p&&p<=3286||3298<=p&&p<=3299||3328<=p&&p<=3329||3387<=p&&p<=3388||3390==p||3393<=p&&p<=3396||3405==p||3415==p||3426<=p&&p<=3427||3530==p||3535==p||3538<=p&&p<=3540||3542==p||3551==p||3633==p||3636<=p&&p<=3642||3655<=p&&p<=3662||3761==p||3764<=p&&p<=3769||3771<=p&&p<=3772||3784<=p&&p<=3789||3864<=p&&p<=3865||3893==p||3895==p||3897==p||3953<=p&&p<=3966||3968<=p&&p<=3972||3974<=p&&p<=3975||3981<=p&&p<=3991||3993<=p&&p<=4028||4038==p||4141<=p&&p<=4144||4146<=p&&p<=4151||4153<=p&&p<=4154||4157<=p&&p<=4158||4184<=p&&p<=4185||4190<=p&&p<=4192||4209<=p&&p<=4212||4226==p||4229<=p&&p<=4230||4237==p||4253==p||4957<=p&&p<=4959||5906<=p&&p<=5908||5938<=p&&p<=5940||5970<=p&&p<=5971||6002<=p&&p<=6003||6068<=p&&p<=6069||6071<=p&&p<=6077||6086==p||6089<=p&&p<=6099||6109==p||6155<=p&&p<=6157||6277<=p&&p<=6278||6313==p||6432<=p&&p<=6434||6439<=p&&p<=6440||6450==p||6457<=p&&p<=6459||6679<=p&&p<=6680||6683==p||6742==p||6744<=p&&p<=6750||6752==p||6754==p||6757<=p&&p<=6764||6771<=p&&p<=6780||6783==p||6832<=p&&p<=6845||6846==p||6912<=p&&p<=6915||6964==p||6966<=p&&p<=6970||6972==p||6978==p||7019<=p&&p<=7027||7040<=p&&p<=7041||7074<=p&&p<=7077||7080<=p&&p<=7081||7083<=p&&p<=7085||7142==p||7144<=p&&p<=7145||7149==p||7151<=p&&p<=7153||7212<=p&&p<=7219||7222<=p&&p<=7223||7376<=p&&p<=7378||7380<=p&&p<=7392||7394<=p&&p<=7400||7405==p||7412==p||7416<=p&&p<=7417||7616<=p&&p<=7673||7675<=p&&p<=7679||8204==p||8400<=p&&p<=8412||8413<=p&&p<=8416||8417==p||8418<=p&&p<=8420||8421<=p&&p<=8432||11503<=p&&p<=11505||11647==p||11744<=p&&p<=11775||12330<=p&&p<=12333||12334<=p&&p<=12335||12441<=p&&p<=12442||42607==p||42608<=p&&p<=42610||42612<=p&&p<=42621||42654<=p&&p<=42655||42736<=p&&p<=42737||43010==p||43014==p||43019==p||43045<=p&&p<=43046||43204<=p&&p<=43205||43232<=p&&p<=43249||43302<=p&&p<=43309||43335<=p&&p<=43345||43392<=p&&p<=43394||43443==p||43446<=p&&p<=43449||43452==p||43493==p||43561<=p&&p<=43566||43569<=p&&p<=43570||43573<=p&&p<=43574||43587==p||43596==p||43644==p||43696==p||43698<=p&&p<=43700||43703<=p&&p<=43704||43710<=p&&p<=43711||43713==p||43756<=p&&p<=43757||43766==p||44005==p||44008==p||44013==p||64286==p||65024<=p&&p<=65039||65056<=p&&p<=65071||65438<=p&&p<=65439||66045==p||66272==p||66422<=p&&p<=66426||68097<=p&&p<=68099||68101<=p&&p<=68102||68108<=p&&p<=68111||68152<=p&&p<=68154||68159==p||68325<=p&&p<=68326||69633==p||69688<=p&&p<=69702||69759<=p&&p<=69761||69811<=p&&p<=69814||69817<=p&&p<=69818||69888<=p&&p<=69890||69927<=p&&p<=69931||69933<=p&&p<=69940||70003==p||70016<=p&&p<=70017||70070<=p&&p<=70078||70090<=p&&p<=70092||70191<=p&&p<=70193||70196==p||70198<=p&&p<=70199||70206==p||70367==p||70371<=p&&p<=70378||70400<=p&&p<=70401||70460==p||70462==p||70464==p||70487==p||70502<=p&&p<=70508||70512<=p&&p<=70516||70712<=p&&p<=70719||70722<=p&&p<=70724||70726==p||70832==p||70835<=p&&p<=70840||70842==p||70845==p||70847<=p&&p<=70848||70850<=p&&p<=70851||71087==p||71090<=p&&p<=71093||71100<=p&&p<=71101||71103<=p&&p<=71104||71132<=p&&p<=71133||71219<=p&&p<=71226||71229==p||71231<=p&&p<=71232||71339==p||71341==p||71344<=p&&p<=71349||71351==p||71453<=p&&p<=71455||71458<=p&&p<=71461||71463<=p&&p<=71467||72193<=p&&p<=72198||72201<=p&&p<=72202||72243<=p&&p<=72248||72251<=p&&p<=72254||72263==p||72273<=p&&p<=72278||72281<=p&&p<=72283||72330<=p&&p<=72342||72344<=p&&p<=72345||72752<=p&&p<=72758||72760<=p&&p<=72765||72767==p||72850<=p&&p<=72871||72874<=p&&p<=72880||72882<=p&&p<=72883||72885<=p&&p<=72886||73009<=p&&p<=73014||73018==p||73020<=p&&p<=73021||73023<=p&&p<=73029||73031==p||92912<=p&&p<=92916||92976<=p&&p<=92982||94095<=p&&p<=94098||113821<=p&&p<=113822||119141==p||119143<=p&&p<=119145||119150<=p&&p<=119154||119163<=p&&p<=119170||119173<=p&&p<=119179||119210<=p&&p<=119213||119362<=p&&p<=119364||121344<=p&&p<=121398||121403<=p&&p<=121452||121461==p||121476==p||121499<=p&&p<=121503||121505<=p&&p<=121519||122880<=p&&p<=122886||122888<=p&&p<=122904||122907<=p&&p<=122913||122915<=p&&p<=122916||122918<=p&&p<=122922||125136<=p&&p<=125142||125252<=p&&p<=125258||917536<=p&&p<=917631||917760<=p&&p<=917999?r:127462<=p&&p<=127487?s:2307==p||2363==p||2366<=p&&p<=2368||2377<=p&&p<=2380||2382<=p&&p<=2383||2434<=p&&p<=2435||2495<=p&&p<=2496||2503<=p&&p<=2504||2507<=p&&p<=2508||2563==p||2622<=p&&p<=2624||2691==p||2750<=p&&p<=2752||2761==p||2763<=p&&p<=2764||2818<=p&&p<=2819||2880==p||2887<=p&&p<=2888||2891<=p&&p<=2892||3007==p||3009<=p&&p<=3010||3014<=p&&p<=3016||3018<=p&&p<=3020||3073<=p&&p<=3075||3137<=p&&p<=3140||3202<=p&&p<=3203||3262==p||3264<=p&&p<=3265||3267<=p&&p<=3268||3271<=p&&p<=3272||3274<=p&&p<=3275||3330<=p&&p<=3331||3391<=p&&p<=3392||3398<=p&&p<=3400||3402<=p&&p<=3404||3458<=p&&p<=3459||3536<=p&&p<=3537||3544<=p&&p<=3550||3570<=p&&p<=3571||3635==p||3763==p||3902<=p&&p<=3903||3967==p||4145==p||4155<=p&&p<=4156||4182<=p&&p<=4183||4228==p||6070==p||6078<=p&&p<=6085||6087<=p&&p<=6088||6435<=p&&p<=6438||6441<=p&&p<=6443||6448<=p&&p<=6449||6451<=p&&p<=6456||6681<=p&&p<=6682||6741==p||6743==p||6765<=p&&p<=6770||6916==p||6965==p||6971==p||6973<=p&&p<=6977||6979<=p&&p<=6980||7042==p||7073==p||7078<=p&&p<=7079||7082==p||7143==p||7146<=p&&p<=7148||7150==p||7154<=p&&p<=7155||7204<=p&&p<=7211||7220<=p&&p<=7221||7393==p||7410<=p&&p<=7411||7415==p||43043<=p&&p<=43044||43047==p||43136<=p&&p<=43137||43188<=p&&p<=43203||43346<=p&&p<=43347||43395==p||43444<=p&&p<=43445||43450<=p&&p<=43451||43453<=p&&p<=43456||43567<=p&&p<=43568||43571<=p&&p<=43572||43597==p||43755==p||43758<=p&&p<=43759||43765==p||44003<=p&&p<=44004||44006<=p&&p<=44007||44009<=p&&p<=44010||44012==p||69632==p||69634==p||69762==p||69808<=p&&p<=69810||69815<=p&&p<=69816||69932==p||70018==p||70067<=p&&p<=70069||70079<=p&&p<=70080||70188<=p&&p<=70190||70194<=p&&p<=70195||70197==p||70368<=p&&p<=70370||70402<=p&&p<=70403||70463==p||70465<=p&&p<=70468||70471<=p&&p<=70472||70475<=p&&p<=70477||70498<=p&&p<=70499||70709<=p&&p<=70711||70720<=p&&p<=70721||70725==p||70833<=p&&p<=70834||70841==p||70843<=p&&p<=70844||70846==p||70849==p||71088<=p&&p<=71089||71096<=p&&p<=71099||71102==p||71216<=p&&p<=71218||71227<=p&&p<=71228||71230==p||71340==p||71342<=p&&p<=71343||71350==p||71456<=p&&p<=71457||71462==p||72199<=p&&p<=72200||72249==p||72279<=p&&p<=72280||72343==p||72751==p||72766==p||72873==p||72881==p||72884==p||94033<=p&&p<=94078||119142==p||119149==p?i:4352<=p&&p<=4447||43360<=p&&p<=43388?a:4448<=p&&p<=4519||55216<=p&&p<=55238?o:4520<=p&&p<=4607||55243<=p&&p<=55291?c:44032==p||44060==p||44088==p||44116==p||44144==p||44172==p||44200==p||44228==p||44256==p||44284==p||44312==p||44340==p||44368==p||44396==p||44424==p||44452==p||44480==p||44508==p||44536==p||44564==p||44592==p||44620==p||44648==p||44676==p||44704==p||44732==p||44760==p||44788==p||44816==p||44844==p||44872==p||44900==p||44928==p||44956==p||44984==p||45012==p||45040==p||45068==p||45096==p||45124==p||45152==p||45180==p||45208==p||45236==p||45264==p||45292==p||45320==p||45348==p||45376==p||45404==p||45432==p||45460==p||45488==p||45516==p||45544==p||45572==p||45600==p||45628==p||45656==p||45684==p||45712==p||45740==p||45768==p||45796==p||45824==p||45852==p||45880==p||45908==p||45936==p||45964==p||45992==p||46020==p||46048==p||46076==p||46104==p||46132==p||46160==p||46188==p||46216==p||46244==p||46272==p||46300==p||46328==p||46356==p||46384==p||46412==p||46440==p||46468==p||46496==p||46524==p||46552==p||46580==p||46608==p||46636==p||46664==p||46692==p||46720==p||46748==p||46776==p||46804==p||46832==p||46860==p||46888==p||46916==p||46944==p||46972==p||47e3==p||47028==p||47056==p||47084==p||47112==p||47140==p||47168==p||47196==p||47224==p||47252==p||47280==p||47308==p||47336==p||47364==p||47392==p||47420==p||47448==p||47476==p||47504==p||47532==p||47560==p||47588==p||47616==p||47644==p||47672==p||47700==p||47728==p||47756==p||47784==p||47812==p||47840==p||47868==p||47896==p||47924==p||47952==p||47980==p||48008==p||48036==p||48064==p||48092==p||48120==p||48148==p||48176==p||48204==p||48232==p||48260==p||48288==p||48316==p||48344==p||48372==p||48400==p||48428==p||48456==p||48484==p||48512==p||48540==p||48568==p||48596==p||48624==p||48652==p||48680==p||48708==p||48736==p||48764==p||48792==p||48820==p||48848==p||48876==p||48904==p||48932==p||48960==p||48988==p||49016==p||49044==p||49072==p||49100==p||49128==p||49156==p||49184==p||49212==p||49240==p||49268==p||49296==p||49324==p||49352==p||49380==p||49408==p||49436==p||49464==p||49492==p||49520==p||49548==p||49576==p||49604==p||49632==p||49660==p||49688==p||49716==p||49744==p||49772==p||49800==p||49828==p||49856==p||49884==p||49912==p||49940==p||49968==p||49996==p||50024==p||50052==p||50080==p||50108==p||50136==p||50164==p||50192==p||50220==p||50248==p||50276==p||50304==p||50332==p||50360==p||50388==p||50416==p||50444==p||50472==p||50500==p||50528==p||50556==p||50584==p||50612==p||50640==p||50668==p||50696==p||50724==p||50752==p||50780==p||50808==p||50836==p||50864==p||50892==p||50920==p||50948==p||50976==p||51004==p||51032==p||51060==p||51088==p||51116==p||51144==p||51172==p||51200==p||51228==p||51256==p||51284==p||51312==p||51340==p||51368==p||51396==p||51424==p||51452==p||51480==p||51508==p||51536==p||51564==p||51592==p||51620==p||51648==p||51676==p||51704==p||51732==p||51760==p||51788==p||51816==p||51844==p||51872==p||51900==p||51928==p||51956==p||51984==p||52012==p||52040==p||52068==p||52096==p||52124==p||52152==p||52180==p||52208==p||52236==p||52264==p||52292==p||52320==p||52348==p||52376==p||52404==p||52432==p||52460==p||52488==p||52516==p||52544==p||52572==p||52600==p||52628==p||52656==p||52684==p||52712==p||52740==p||52768==p||52796==p||52824==p||52852==p||52880==p||52908==p||52936==p||52964==p||52992==p||53020==p||53048==p||53076==p||53104==p||53132==p||53160==p||53188==p||53216==p||53244==p||53272==p||53300==p||53328==p||53356==p||53384==p||53412==p||53440==p||53468==p||53496==p||53524==p||53552==p||53580==p||53608==p||53636==p||53664==p||53692==p||53720==p||53748==p||53776==p||53804==p||53832==p||53860==p||53888==p||53916==p||53944==p||53972==p||54e3==p||54028==p||54056==p||54084==p||54112==p||54140==p||54168==p||54196==p||54224==p||54252==p||54280==p||54308==p||54336==p||54364==p||54392==p||54420==p||54448==p||54476==p||54504==p||54532==p||54560==p||54588==p||54616==p||54644==p||54672==p||54700==p||54728==p||54756==p||54784==p||54812==p||54840==p||54868==p||54896==p||54924==p||54952==p||54980==p||55008==p||55036==p||55064==p||55092==p||55120==p||55148==p||55176==p?l:44033<=p&&p<=44059||44061<=p&&p<=44087||44089<=p&&p<=44115||44117<=p&&p<=44143||44145<=p&&p<=44171||44173<=p&&p<=44199||44201<=p&&p<=44227||44229<=p&&p<=44255||44257<=p&&p<=44283||44285<=p&&p<=44311||44313<=p&&p<=44339||44341<=p&&p<=44367||44369<=p&&p<=44395||44397<=p&&p<=44423||44425<=p&&p<=44451||44453<=p&&p<=44479||44481<=p&&p<=44507||44509<=p&&p<=44535||44537<=p&&p<=44563||44565<=p&&p<=44591||44593<=p&&p<=44619||44621<=p&&p<=44647||44649<=p&&p<=44675||44677<=p&&p<=44703||44705<=p&&p<=44731||44733<=p&&p<=44759||44761<=p&&p<=44787||44789<=p&&p<=44815||44817<=p&&p<=44843||44845<=p&&p<=44871||44873<=p&&p<=44899||44901<=p&&p<=44927||44929<=p&&p<=44955||44957<=p&&p<=44983||44985<=p&&p<=45011||45013<=p&&p<=45039||45041<=p&&p<=45067||45069<=p&&p<=45095||45097<=p&&p<=45123||45125<=p&&p<=45151||45153<=p&&p<=45179||45181<=p&&p<=45207||45209<=p&&p<=45235||45237<=p&&p<=45263||45265<=p&&p<=45291||45293<=p&&p<=45319||45321<=p&&p<=45347||45349<=p&&p<=45375||45377<=p&&p<=45403||45405<=p&&p<=45431||45433<=p&&p<=45459||45461<=p&&p<=45487||45489<=p&&p<=45515||45517<=p&&p<=45543||45545<=p&&p<=45571||45573<=p&&p<=45599||45601<=p&&p<=45627||45629<=p&&p<=45655||45657<=p&&p<=45683||45685<=p&&p<=45711||45713<=p&&p<=45739||45741<=p&&p<=45767||45769<=p&&p<=45795||45797<=p&&p<=45823||45825<=p&&p<=45851||45853<=p&&p<=45879||45881<=p&&p<=45907||45909<=p&&p<=45935||45937<=p&&p<=45963||45965<=p&&p<=45991||45993<=p&&p<=46019||46021<=p&&p<=46047||46049<=p&&p<=46075||46077<=p&&p<=46103||46105<=p&&p<=46131||46133<=p&&p<=46159||46161<=p&&p<=46187||46189<=p&&p<=46215||46217<=p&&p<=46243||46245<=p&&p<=46271||46273<=p&&p<=46299||46301<=p&&p<=46327||46329<=p&&p<=46355||46357<=p&&p<=46383||46385<=p&&p<=46411||46413<=p&&p<=46439||46441<=p&&p<=46467||46469<=p&&p<=46495||46497<=p&&p<=46523||46525<=p&&p<=46551||46553<=p&&p<=46579||46581<=p&&p<=46607||46609<=p&&p<=46635||46637<=p&&p<=46663||46665<=p&&p<=46691||46693<=p&&p<=46719||46721<=p&&p<=46747||46749<=p&&p<=46775||46777<=p&&p<=46803||46805<=p&&p<=46831||46833<=p&&p<=46859||46861<=p&&p<=46887||46889<=p&&p<=46915||46917<=p&&p<=46943||46945<=p&&p<=46971||46973<=p&&p<=46999||47001<=p&&p<=47027||47029<=p&&p<=47055||47057<=p&&p<=47083||47085<=p&&p<=47111||47113<=p&&p<=47139||47141<=p&&p<=47167||47169<=p&&p<=47195||47197<=p&&p<=47223||47225<=p&&p<=47251||47253<=p&&p<=47279||47281<=p&&p<=47307||47309<=p&&p<=47335||47337<=p&&p<=47363||47365<=p&&p<=47391||47393<=p&&p<=47419||47421<=p&&p<=47447||47449<=p&&p<=47475||47477<=p&&p<=47503||47505<=p&&p<=47531||47533<=p&&p<=47559||47561<=p&&p<=47587||47589<=p&&p<=47615||47617<=p&&p<=47643||47645<=p&&p<=47671||47673<=p&&p<=47699||47701<=p&&p<=47727||47729<=p&&p<=47755||47757<=p&&p<=47783||47785<=p&&p<=47811||47813<=p&&p<=47839||47841<=p&&p<=47867||47869<=p&&p<=47895||47897<=p&&p<=47923||47925<=p&&p<=47951||47953<=p&&p<=47979||47981<=p&&p<=48007||48009<=p&&p<=48035||48037<=p&&p<=48063||48065<=p&&p<=48091||48093<=p&&p<=48119||48121<=p&&p<=48147||48149<=p&&p<=48175||48177<=p&&p<=48203||48205<=p&&p<=48231||48233<=p&&p<=48259||48261<=p&&p<=48287||48289<=p&&p<=48315||48317<=p&&p<=48343||48345<=p&&p<=48371||48373<=p&&p<=48399||48401<=p&&p<=48427||48429<=p&&p<=48455||48457<=p&&p<=48483||48485<=p&&p<=48511||48513<=p&&p<=48539||48541<=p&&p<=48567||48569<=p&&p<=48595||48597<=p&&p<=48623||48625<=p&&p<=48651||48653<=p&&p<=48679||48681<=p&&p<=48707||48709<=p&&p<=48735||48737<=p&&p<=48763||48765<=p&&p<=48791||48793<=p&&p<=48819||48821<=p&&p<=48847||48849<=p&&p<=48875||48877<=p&&p<=48903||48905<=p&&p<=48931||48933<=p&&p<=48959||48961<=p&&p<=48987||48989<=p&&p<=49015||49017<=p&&p<=49043||49045<=p&&p<=49071||49073<=p&&p<=49099||49101<=p&&p<=49127||49129<=p&&p<=49155||49157<=p&&p<=49183||49185<=p&&p<=49211||49213<=p&&p<=49239||49241<=p&&p<=49267||49269<=p&&p<=49295||49297<=p&&p<=49323||49325<=p&&p<=49351||49353<=p&&p<=49379||49381<=p&&p<=49407||49409<=p&&p<=49435||49437<=p&&p<=49463||49465<=p&&p<=49491||49493<=p&&p<=49519||49521<=p&&p<=49547||49549<=p&&p<=49575||49577<=p&&p<=49603||49605<=p&&p<=49631||49633<=p&&p<=49659||49661<=p&&p<=49687||49689<=p&&p<=49715||49717<=p&&p<=49743||49745<=p&&p<=49771||49773<=p&&p<=49799||49801<=p&&p<=49827||49829<=p&&p<=49855||49857<=p&&p<=49883||49885<=p&&p<=49911||49913<=p&&p<=49939||49941<=p&&p<=49967||49969<=p&&p<=49995||49997<=p&&p<=50023||50025<=p&&p<=50051||50053<=p&&p<=50079||50081<=p&&p<=50107||50109<=p&&p<=50135||50137<=p&&p<=50163||50165<=p&&p<=50191||50193<=p&&p<=50219||50221<=p&&p<=50247||50249<=p&&p<=50275||50277<=p&&p<=50303||50305<=p&&p<=50331||50333<=p&&p<=50359||50361<=p&&p<=50387||50389<=p&&p<=50415||50417<=p&&p<=50443||50445<=p&&p<=50471||50473<=p&&p<=50499||50501<=p&&p<=50527||50529<=p&&p<=50555||50557<=p&&p<=50583||50585<=p&&p<=50611||50613<=p&&p<=50639||50641<=p&&p<=50667||50669<=p&&p<=50695||50697<=p&&p<=50723||50725<=p&&p<=50751||50753<=p&&p<=50779||50781<=p&&p<=50807||50809<=p&&p<=50835||50837<=p&&p<=50863||50865<=p&&p<=50891||50893<=p&&p<=50919||50921<=p&&p<=50947||50949<=p&&p<=50975||50977<=p&&p<=51003||51005<=p&&p<=51031||51033<=p&&p<=51059||51061<=p&&p<=51087||51089<=p&&p<=51115||51117<=p&&p<=51143||51145<=p&&p<=51171||51173<=p&&p<=51199||51201<=p&&p<=51227||51229<=p&&p<=51255||51257<=p&&p<=51283||51285<=p&&p<=51311||51313<=p&&p<=51339||51341<=p&&p<=51367||51369<=p&&p<=51395||51397<=p&&p<=51423||51425<=p&&p<=51451||51453<=p&&p<=51479||51481<=p&&p<=51507||51509<=p&&p<=51535||51537<=p&&p<=51563||51565<=p&&p<=51591||51593<=p&&p<=51619||51621<=p&&p<=51647||51649<=p&&p<=51675||51677<=p&&p<=51703||51705<=p&&p<=51731||51733<=p&&p<=51759||51761<=p&&p<=51787||51789<=p&&p<=51815||51817<=p&&p<=51843||51845<=p&&p<=51871||51873<=p&&p<=51899||51901<=p&&p<=51927||51929<=p&&p<=51955||51957<=p&&p<=51983||51985<=p&&p<=52011||52013<=p&&p<=52039||52041<=p&&p<=52067||52069<=p&&p<=52095||52097<=p&&p<=52123||52125<=p&&p<=52151||52153<=p&&p<=52179||52181<=p&&p<=52207||52209<=p&&p<=52235||52237<=p&&p<=52263||52265<=p&&p<=52291||52293<=p&&p<=52319||52321<=p&&p<=52347||52349<=p&&p<=52375||52377<=p&&p<=52403||52405<=p&&p<=52431||52433<=p&&p<=52459||52461<=p&&p<=52487||52489<=p&&p<=52515||52517<=p&&p<=52543||52545<=p&&p<=52571||52573<=p&&p<=52599||52601<=p&&p<=52627||52629<=p&&p<=52655||52657<=p&&p<=52683||52685<=p&&p<=52711||52713<=p&&p<=52739||52741<=p&&p<=52767||52769<=p&&p<=52795||52797<=p&&p<=52823||52825<=p&&p<=52851||52853<=p&&p<=52879||52881<=p&&p<=52907||52909<=p&&p<=52935||52937<=p&&p<=52963||52965<=p&&p<=52991||52993<=p&&p<=53019||53021<=p&&p<=53047||53049<=p&&p<=53075||53077<=p&&p<=53103||53105<=p&&p<=53131||53133<=p&&p<=53159||53161<=p&&p<=53187||53189<=p&&p<=53215||53217<=p&&p<=53243||53245<=p&&p<=53271||53273<=p&&p<=53299||53301<=p&&p<=53327||53329<=p&&p<=53355||53357<=p&&p<=53383||53385<=p&&p<=53411||53413<=p&&p<=53439||53441<=p&&p<=53467||53469<=p&&p<=53495||53497<=p&&p<=53523||53525<=p&&p<=53551||53553<=p&&p<=53579||53581<=p&&p<=53607||53609<=p&&p<=53635||53637<=p&&p<=53663||53665<=p&&p<=53691||53693<=p&&p<=53719||53721<=p&&p<=53747||53749<=p&&p<=53775||53777<=p&&p<=53803||53805<=p&&p<=53831||53833<=p&&p<=53859||53861<=p&&p<=53887||53889<=p&&p<=53915||53917<=p&&p<=53943||53945<=p&&p<=53971||53973<=p&&p<=53999||54001<=p&&p<=54027||54029<=p&&p<=54055||54057<=p&&p<=54083||54085<=p&&p<=54111||54113<=p&&p<=54139||54141<=p&&p<=54167||54169<=p&&p<=54195||54197<=p&&p<=54223||54225<=p&&p<=54251||54253<=p&&p<=54279||54281<=p&&p<=54307||54309<=p&&p<=54335||54337<=p&&p<=54363||54365<=p&&p<=54391||54393<=p&&p<=54419||54421<=p&&p<=54447||54449<=p&&p<=54475||54477<=p&&p<=54503||54505<=p&&p<=54531||54533<=p&&p<=54559||54561<=p&&p<=54587||54589<=p&&p<=54615||54617<=p&&p<=54643||54645<=p&&p<=54671||54673<=p&&p<=54699||54701<=p&&p<=54727||54729<=p&&p<=54755||54757<=p&&p<=54783||54785<=p&&p<=54811||54813<=p&&p<=54839||54841<=p&&p<=54867||54869<=p&&p<=54895||54897<=p&&p<=54923||54925<=p&&p<=54951||54953<=p&&p<=54979||54981<=p&&p<=55007||55009<=p&&p<=55035||55037<=p&&p<=55063||55065<=p&&p<=55091||55093<=p&&p<=55119||55121<=p&&p<=55147||55149<=p&&p<=55175||55177<=p&&p<=55203?u:9757==p||9977==p||9994<=p&&p<=9997||127877==p||127938<=p&&p<=127940||127943==p||127946<=p&&p<=127948||128066<=p&&p<=128067||128070<=p&&p<=128080||128110==p||128112<=p&&p<=128120||128124==p||128129<=p&&p<=128131||128133<=p&&p<=128135||128170==p||128372<=p&&p<=128373||128378==p||128400==p||128405<=p&&p<=128406||128581<=p&&p<=128583||128587<=p&&p<=128591||128675==p||128692<=p&&p<=128694||128704==p||128716==p||129304<=p&&p<=129308||129310<=p&&p<=129311||129318==p||129328<=p&&p<=129337||129341<=p&&p<=129342||129489<=p&&p<=129501?d:127995<=p&&p<=127999?h:8205==p?m:9792==p||9794==p||9877<=p&&p<=9878||9992==p||10084==p||127752==p||127806==p||127859==p||127891==p||127908==p||127912==p||127979==p||127981==p||128139==p||128187<=p&&p<=128188||128295==p||128300==p||128488==p||128640==p||128658==p?_:128102<=p&&p<=128105?E:11}return this.nextBreak=function(e,t){if(void 0===t&&(t=0),t<0)return 0;if(t>=e.length-1)return e.length;for(var n,r,s=A(p(e,t)),i=[],a=t+1;a<e.length;a++)if(r=a-1,!(55296<=(n=e).charCodeAt(r)&&n.charCodeAt(r)<=56319&&56320<=n.charCodeAt(r+1)&&n.charCodeAt(r+1)<=57343)){var o=A(p(e,a));if(f(s,i,o))return a;i.push(o)}return e.length},this.splitGraphemes=function(e){for(var t,n=[],r=0;(t=this.nextBreak(e,r))<e.length;)n.push(e.slice(r,t)),r=t;return r<e.length&&n.push(e.slice(r)),n},this.iterateGraphemes=function(e){var t=0,n={next:function(){var n,r;return(r=this.nextBreak(e,t))<e.length?(n=e.slice(t,r),t=r,{value:n,done:!1}):t<e.length?(n=e.slice(t),t=e.length,{value:n,done:!1}):{value:void 0,done:!0}}.bind(this)};return"undefined"!=typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return n}),n},this.countGraphemes=function(e){for(var t,n=0,r=0;(t=this.nextBreak(e,r))<e.length;)r=t,n++;return r<e.length&&n++,n},this}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var Te=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};let Ce;!function(){let e;try{e=new RegExp("\\p{L}","u")}catch(t){e=/[a-zäöüß]/i}Ce=function(t){return e.test(t)}}();const Ie=e=>"string"==typeof e;let Re,Pe,ye,Ne,ve;!function(){const e="\b\t          ‏　",t=new RegExp("^["+e+"]$"),n=new RegExp("["+e+"]","g");Re=function(e){return t.test(e)},Pe=function(e){return e.replace(n," ")}}(),function(){const e="​‌‍­⁠‪‫‬‭",t=new RegExp("^["+e+"]$"),n=new RegExp("["+e+"]"),r=new RegExp("["+e+"]","g");ye=function(e){return t.test(e)},Ne=function(e){const t=e.match(n);return t?t.index:-1},ve=function(e){return e.replace(r,"")}}();const Oe=function(){const e=/^[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ]+[A-ZÈÉÊÁÀÂÓÒÔÚÙÛÍÌÎÄÜÖ\-!?#@=%().:;<>'’´`"”“*+,\s]+[A-ZÈÉÊÁÀÂÓÒÔÍÌÎÄÜÖ]$/;return function(t){return e.test(t)}}();let be,Le;function De(e,t){if(e===t)return null;let n=0;const r=Math.max(e.length,t.length);for(n=0;n<r&&e[n]===t[n];n++);let s=0;const i=Math.min(e.length,t.length);for(;n+s<i;){if(e[e.length-s-1]!==t[t.length-s-1])break;s++}return{from:n,oldFragment:e.substring(n,e.length-s),newFragment:t.substring(n,t.length-s)}}function we(e,t){const n=[],r=e.split("\n"),s=t.split("\n");let i=0;const a=Math.max(r.length,s.length);for(i=0;i<a&&r[i]===s[i];i++);let o=0;const c=Math.min(r.length,s.length);for(;i+o<c;){if(r[r.length-o-1]!==s[s.length-o-1])break;o++}let l=0;for(let e=0;e<i;e++)l+=r[e].length+1;let u=l;for(let e=i;e<a-o;e++){const t=e<r.length-o?r[e]:null,i=e<s.length-o?s[e]:null;t===i&&l===u||n.push({oldText:t,newText:i,oldOffset:l,newOffset:u,textDiff:De(t||"",i||"")}),null!==t&&(l+=t.length+1),null!==i&&(u+=i.length+1)}if(l!==u)for(let e=o-1;e>=0;e--){const t=r[r.length-e-1],i=s[s.length-e-1];n.push({oldText:t,newText:i,oldOffset:l,newOffset:u,textDiff:null}),l+=t.length+1,u+=i.length+1}return n}function xe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/`/g,"&#x60;").replace(/\//g,"&#x2F;")}function Ue(e,t){let n=0,r=e.length-1;for(;n<=r;){const s=n+Math.ceil((r-n)/2),i=t(e[s]);if(i>0)n=s+1;else{if(!(i<0)){for(let n=s;n>0;n--)if(0!==t(e[n-1]))return e[n];return e[0]}r=s-1}}return null}function Me(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function ke(e){return null===e||"object"!=typeof e?e:e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e):Array.isArray(e)?Array.from(e):Object.assign({},e)}function Ge(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e);if(e instanceof RegExp)return new RegExp(e);const t=Array.isArray(e)?[]:{};for(const n in e)t[n]=Ge(e[n]);return t}!function(){let e,t;const n=/(?:\S+\s+){0,4}\S+$/,r=/^\S+(?:\s+\S+){0,4}/;try{e=new RegExp("^\\s*(-?\\p{L}+)*-?\\s*$","u"),t=new RegExp("^\\s*\\p{L}+(-\\p{L}+)*\\s*$","u")}catch(n){e=/^\s*(-?[a-zäöüß]+)*-?\s*$/i,t=/^\s*[a-zäöüß]+(-[a-zäöüß]+)*\s*$/i}be=(n,r,s=r)=>{const i=n.substring(r,s);if(!e.test(i))return null;let a=0===i.length||Ce(i[0]),o="-"===i[0],c=r;if(a||o)for(;c>0;){const e=n[c-1],t=Ce(e),r="-"===e;if(!t&&!r)break;if(r&&o)return null;c--,a=t,o=r}a=Ce(i[i.length-1]),o=i.endsWith("-");let l=s;if(a||o)for(;l<n.length;){const e=n[l],t=Ce(e),r="-"===e;if(!t&&!r)break;if(r&&o)return null;l++,a=t,o=r}const u=i.match(/\s+$/);u&&(l-=u[0].length);const g=n.substring(c,l);return t.test(g)?{start:c,end:l}:null},Le=(e,t,s)=>{const i=be(e,t,s);if(!i)return null;const a=n.exec(e.substring(0,i.start).trim());let o=a?a[0]:"";o=o.replace(/^.+\n\n/,"");const c=r.exec(e.substring(i.end).trim());let l=c?c[0]:"";return l=l.replace(/\n\n.+/,""),{word:e.substring(i.start,i.end),position:i,beforeText:o,afterText:l}}}();let Fe=null,Be=null;function We(e){return Intl.Segmenter?(Fe||(Fe=new Intl.Segmenter(void 0,{granularity:"grapheme"})),Array.from(Fe.segment(e)).map((e=>e.segment))):(Be||(Be=new Se),Be.splitGraphemes(e))}function He(){if("about:blank"===location.href||"about:srcdoc"===location.href)try{return(self.opener||self.parent).location.href}catch(e){}return location.href}function Ve(e,t=e){if(e.startsWith("about:blank"))return"blank";if(e.startsWith("about:srcdoc"))return"srcdoc";if(e.startsWith("file:"))return"file";e&&!/^([a-z\-]+:\/\/)/i.test(e)&&(e="http://"+e);try{return new URL(e).hostname}catch(e){return t}}const je=function(){const e=/^\w+\.$/;return(t,n)=>{if(!t.isSpellingError)return!1;let r=t.originalPhrase;if(e.test(r)&&(r=r.substring(0,r.length-1)),n.includes(r))return!0;if(function(e){const t=e.charAt(0);return t===t.toUpperCase()&&t!==t.toLowerCase()}(r)){const e=(s=r).charAt(0).toLowerCase()+s.substr(1);if(n.includes(e))return!0}var s;return!1}}();!function(){const e=/[\u0300-\u036f]/g,t=/\u0142/g,n=/\u00F8/g}();function Ye(e,t,n,r,s=!1){return s?e<=r&&t>=n:e<r&&t>n}function Ze(e,t,n,r=!1){if(r){if(t<=e&&e<n)return 0}else if(t<=e&&e<=n)return 0;return e-t}function Ke(e,t,n){return Te(this,void 0,void 0,(function*(){if(t.signal)throw new Error("cannot fetchWithTimeout if 'signal' is already set");const r=new AbortController;t.signal=r.signal;const s=self.setTimeout((()=>r.abort()),n);return yield fetch(e,t).finally((()=>{clearTimeout(s)}))}))}class Xe{static merge(e,t=!1){let{errors:n,pickyErrors:r,premiumErrors:s,premiumPickyErrors:i,sentenceRanges:a=[]}=this.filterAndMigrateErrors(e.existing.errors,e.existing.pickyErrors,e.existing.premiumErrors,e.existing.premiumPickyErrors,e.existing.sentenceRanges,e.existingCheckedText,e.newCheckedText);this.mergeParagraphLevelErrors(n,r,s,i,a,e.new.paragraphLevel.errors,e.new.paragraphLevel.pickyErrors,e.new.paragraphLevel.premiumErrors,e.new.paragraphLevel.premiumPickyErrors,e.new.paragraphLevel.sentenceRanges),this.mergeTextLevelErrors(n,r,s,i,e.new.textLevel.errors,e.new.textLevel.pickyErrors,e.new.textLevel.premiumErrors,e.new.textLevel.premiumPickyErrors);const o=this.getDuplicateErrors(e.existing,e.existingCheckedText,e.newCheckedText);return this.sortErrors(n,r,s,i),this.setIdsOnErrors(n,r,s,i,o),n=this.migrateOffsetsToOriginalText(n,e.newCheckedText.usedParts),r=this.migrateOffsetsToOriginalText(r,e.newCheckedText.usedParts),s=this.migrateOffsetsToOriginalText(s,e.newCheckedText.usedParts),i=this.migrateOffsetsToOriginalText(i,e.newCheckedText.usedParts),a=this.migrateOffsetsToOriginalText(a,e.newCheckedText.usedParts),t&&(r=r.filter((e=>!oe.includes(e.rule.id))),r.forEach((e=>{e.rule.id="HIDDEN_RULE",e.fixes=[]})),s=[...s,...i,...r],i=[],r=[],this.sortErrorsByOffset(s)),{errors:n,pickyErrors:r,premiumErrors:s,premiumPickyErrors:i,sentenceRanges:a}}static getDuplicateErrors(e,t,n){let{errors:r,pickyErrors:s,premiumErrors:i,premiumPickyErrors:a}=e;r=this.migrateOffsetsToValuableText(r,t.usedParts),s=this.migrateOffsetsToValuableText(s,t.usedParts),i=this.migrateOffsetsToValuableText(i,t.usedParts),a=this.migrateOffsetsToValuableText(a,t.usedParts);const o=we(t.text,n.text),c=e=>{if(!e.isParagraphLevelCheck)return!0;const t=Ue(o,(t=>{const n=t.oldOffset;if(null===t.oldText)return e.start>=n?1:-1;const r=t.oldOffset+t.oldText.length+1;return Ze(e.start,n,r,!0)}));return!(!t||!t.textDiff)||void 0};return r=r.filter(c),s=s.filter(c),i=i.filter(c),a=a.filter(c),r=this.migrateOffsetsBetweenTexts(r,o),s=this.migrateOffsetsBetweenTexts(s,o),i=this.migrateOffsetsBetweenTexts(i,o),a=this.migrateOffsetsBetweenTexts(a,o),{errors:r,pickyErrors:s,premiumErrors:i,premiumPickyErrors:a}}static migrateOffsetsToValuableText(e,t){const n=[];for(const r of e){const e=Ue(t,(e=>Ze(r.start,e.originalStart,e.originalEnd,!0))),s=Ue(t,(e=>Ze(r.end,e.originalStart,e.originalEnd)));if(!e||!s)continue;const i=Ge(r);i.start-=e.posDiff,i.end-=s.posDiff,i.length=i.end-i.start,n.push(i)}return n}static migrateOffsetsBetweenTexts(e,t,n,r){let s,i=!1;"string"==typeof t&&"string"==typeof n?(s=we(t,n),i="boolean"==typeof r&&r):(s=t,i="boolean"==typeof n&&n);const a=[];for(const t of e){const e=Ue(s,(e=>{const n=e.oldOffset;if(null===e.oldText)return t.start>=n?1:-1;const r=e.oldOffset+e.oldText.length+1;return Ze(t.start,n,r,!0)})),n=Ge(t);if(e){if(e.textDiff){if(i)continue;{const t=e.oldOffset+e.textDiff.from,r=t+e.textDiff.oldFragment.length;if(Ye(t,r,n.start,n.end,!0))continue;if(n.start>=r){const t=e.textDiff.newFragment.length-e.textDiff.oldFragment.length;n.start+=t,n.end+=t}}}n.start+=e.newOffset-e.oldOffset,n.end=n.start+n.length}a.push(n)}return a}static migrateOffsetsToOriginalText(e,t){const n=[];for(const r of e){const e=Ue(t,(e=>Ze(r.start,e.start,e.end,!0))),s=Ue(t,(e=>Ze(r.end,e.start,e.end)));if(!e||!s)continue;const i=Ge(r);i.start+=e.posDiff,i.end+=s.posDiff,i.length=i.end-i.start,n.push(i)}return n}static filterAndMigrateErrors(e,t,n,r,s,i,a){e=e.filter((e=>e.isParagraphLevelCheck)),t=t.filter((e=>e.isParagraphLevelCheck)),n=n.filter((e=>e.isParagraphLevelCheck)),r=r.filter((e=>e.isParagraphLevelCheck)),e=this.migrateOffsetsToValuableText(e,i.usedParts),t=this.migrateOffsetsToValuableText(t,i.usedParts),n=this.migrateOffsetsToValuableText(n,i.usedParts),r=this.migrateOffsetsToValuableText(r,i.usedParts),s=this.migrateOffsetsToValuableText(s||[],i.usedParts);const o=we(i.text,a.text);return{errors:e=this.migrateOffsetsBetweenTexts(e,o,!0),pickyErrors:t=this.migrateOffsetsBetweenTexts(t,o,!0),premiumErrors:n=this.migrateOffsetsBetweenTexts(n,o,!0),premiumPickyErrors:r=this.migrateOffsetsBetweenTexts(r,o,!0),sentenceRanges:s=this.migrateOffsetsBetweenTexts(s,o,!0)}}static mergeParagraphLevelErrors(e,t,n,r,s,i,a,o,c,l=[]){e.push(...i),t.push(...a),n.push(...o),r.push(...c),s.push(...l)}static mergeTextLevelErrors(e,t,n,r,s,i,a,o){for(const t of s)e.some((e=>e.start===t.start&&e.end===t.end))||e.push(t);for(const e of i)t.some((t=>t.start===e.start&&t.end===e.end))||t.push(e);for(const e of a)n.some((t=>t.start===e.start&&t.end===e.end))||n.push(e);for(const e of o)r.some((t=>t.start===e.start&&t.end===e.end))||r.push(e)}static sortErrors(e,t,n,r){this.sortErrorsByOffset(e),this.sortErrorsByOffset(t),this.sortErrorsByOffset(n),this.sortErrorsByOffset(r)}static sortErrorsByOffset(e){e.sort(((e,t)=>e.start===t.start?e.isParagraphLevelCheck?1:-1:e.start>t.start?1:-1))}static migrateErrorsBetweenSameOriginalTexts(e,t,n){const r=[];for(const s of e){let e=s.start,i=s.end,a=Ue(t.usedParts,(t=>Ze(e,t.originalStart,t.originalEnd,!0))),o=Ue(t.usedParts,(e=>Ze(i,e.originalStart,e.originalEnd)));if(!a||!o)continue;if(e-=a.posDiff,i-=o.posDiff,a=Ue(n.usedParts,(t=>Ze(e,t.start,t.end,!0))),o=Ue(n.usedParts,(e=>Ze(i,e.start,e.end))),!a||!o)continue;e+=a.posDiff,i+=o.posDiff;const c=Ge(s);c.start=e,c.end=i,c.length=i-e,r.push(c)}return r}static setIdsOnErrors(e,t,n,r,s){function i(e,t){if(e.id)return;const n=t.find((t=>{return r=e,(n=t).start===r.start&&n.end===r.end&&n.isParagraphLevelCheck===r.isParagraphLevelCheck;var n,r}));e.id=n?n.id:"error:"+ ++Xe.INCREMENTAL_ID}e.forEach((e=>i(e,s.errors))),t.forEach((e=>i(e,s.pickyErrors))),n.forEach((e=>i(e,s.premiumErrors))),r.forEach((e=>i(e,s.premiumPickyErrors)))}static sortSentenceRanges(e){e.sort((({start:e},{start:t})=>e-t))}}Xe.INCREMENTAL_ID=0;
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class $e{constructor(e=document){this._window=e.defaultView,this._document=e,this.clearCache()}_getElementCache(e){let t=this._elementCache.get(e);return t||(t={},this._elementCache.set(e,t)),t}clearCache(){this._documentVisibleBox=null,this._documentGap=null,this._documentScroll=null,this._elementCache=new WeakMap}_contains(e,t){return e&&e!==t&&e.contains(t)}_getComputedStyle(e,t,n){let r,s;return"object"==typeof t?(r=t,s=""):(r=n,s=t),r.computedStyle||(r.computedStyle=new Map),r.computedStyle.has(s)||r.computedStyle.set(s,this._window.getComputedStyle(e,s||null)),r.computedStyle.get(s)}getComputedStyle(e,t=""){return this._getComputedStyle(e,t,this._getElementCache(e))}_getComputedStyleMap(e,t){return e.computedStyleMap?(t.computedStyleMap||(t.computedStyleMap=e.computedStyleMap()),t.computedStyleMap):null}getComputedStyleMap(e){return this._getComputedStyleMap(e,this._getElementCache(e))}getInlineStyle(e,t){return e.style.getPropertyValue(t)}getStyle(e,t,n=""){return this.getStyles(e,[t],n)[t]}getStyles(e,n,r=""){let s=null,i={};const a=this._getElementCache(e);for(const o of n)if(s=s||this._getComputedStyle(e,r,a),"line-height"===o||"lineHeight"===o)i[o]=this.getInlineStyle(e,o)||s[o]||"";else if("font"!==o||s[o])if("transform"===o&&e instanceof SVGGElement&&t.isSafari()&&e.hasAttribute("transform")){const t=it(e);i[o]=`matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.e}, ${t.f})`}else i[o]="zoom"===o?s[o]||"1":s[o]||"";else{const t=s["font-style"],n=s["font-variant"],r=s["font-weight"],a=s["font-size"],c=this.getInlineStyle(e,"line-height")||s["line-height"]||"",l=s["font-family"];i[o]=`${t} ${n} ${r} ${a} ${c?"/ "+c:""} ${l}`}return i}getExactStyle(e,t){return this.getExactStyles(e,[t])[t]}getExactStyles(e,t){const n=this._getElementCache(e),r=this._getComputedStyleMap(e,n);if(r){const e={};for(const n of t){const t=r.get(n);t?"number"==typeof(s=t).value&&"string"==typeof s.unit?"number"===t.unit?e[n]=t.value.toString():e[n]=t.value+t.unit:e[n]=t.toString():e[n]=""}return e}return this.getStyles(e,t);var s}setStyles(e,t,n=!1){Array.isArray(e)||(e=[e]);for(const r of e)for(const e in t){let s=t[e].trim();const i=n||$e.IMPORTANT_REG_EXP.test(s);s=s.replace($e.IMPORTANT_REG_EXP,""),r.style.setProperty(e,s,i?"important":"")}}copyStyles(e,t,n,r=!1){const s=this.getStyles(e,n);this.setStyles(t,s,r)}resetStyles(e,t,n=!1){Array.isArray(e)||(e=[e]);let r="";for(const e in t){let s=t[e].trim();n&&!$e.IMPORTANT_REG_EXP.test(s)&&(s+=" !important"),r+=`${e}: ${s};`}for(const t of e)t.style.cssText=r}removeStyle(e,t){Array.isArray(e)||(e=[e]),this.removeStyles(e,[t])}removeStyles(e,t){Array.isArray(e)||(e=[e]);for(const n of e)for(const e of t)n.style.removeProperty(e)}_getBoundingClientRect(e,t){return t.boundingClientRect||(t.boundingClientRect=Ge(e.getBoundingClientRect())),t.boundingClientRect}getRelativeClientRect(e,t){const n=this._getBoundingClientRect(e,this._getElementCache(e)),r=this._getBoundingClientRect(t,this._getElementCache(t)),s=n.top-r.top,i=n.left-r.left,a=n.width,o=n.height;return{top:s,right:i+a,bottom:s+o,left:i,width:a,height:o}}_getBorderBox(e,t,n,r){const s="borderBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!r[s]){const i=this._getBoundingClientRect(e,r);let{top:a,left:o,width:c,height:l}=i;if(n){const t=this.getZoom(e);a*=t,o*=t,c*=t,l*=t}else{const t=this._getScaleFactor(e,r);c/=t.x,l/=t.y}if(t){const t=this.getDocumentScroll();if(a+=t.top,o+=t.left,this._document.body&&this._contains(this._document.body,e)){const e=this.getDocumentGap();a-=e.top,o-=e.left}}r[s]={top:a,right:o+c,bottom:a+l,left:o,width:c,height:l}}return r[s]}getBorderBox(e,t=!0,n=!0){return this._getBorderBox(e,t,n,this._getElementCache(e))}_getPaddingBox(e,t,n,r){const s="paddingBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!r[s]){let{top:i,left:a,width:o,height:c}=this._getBorderBox(e,t,n,r),l={x:1,y:1};n&&(l=this._getScaleFactor(e,r));const u=n?this._getZoom(e,r):1,g=this._getComputedStyle(e,r),d=(parseFloat(g["border-top-width"])||0)*l.y*u,h=(parseFloat(g["border-right-width"])||0)*l.x*u,m=(parseFloat(g["border-bottom-width"])||0)*l.y*u,_=(parseFloat(g["border-left-width"])||0)*l.x*u;let E=0,p=0;if("BackCompat"!==this._document.compatMode||e!==this._document.body||e!==this._document.scrollingElement){let{width:t,height:n}=this._getClientWidthAndHeight(e,r);t=t*l.x*u,n=n*l.y*u,E=o-_-t-h,p=c-d-n-m,E<1&&(E=0),p<1&&(p=0)}i+=d,a+=_,o=o-_-E-h,c=c-d-p-m,this._isRTL(e,r)&&(a+=E),r[s]={top:i,right:a+o,bottom:i+c,left:a,width:o,height:c,border:{top:d,right:h,bottom:m,left:_}}}return r[s]}getPaddingBox(e,t=!0,n=!0){return this._getPaddingBox(e,t,n,this._getElementCache(e))}_getContentBox(e,t,n,r){const s="contentBox"+(t?"WithScroll":"")+(n?"WithScale":"");if(!r[s]){let{top:i,left:a,width:o,height:c,border:l}=this._getPaddingBox(e,t,n,r),u={x:1,y:1};n&&(u=this._getScaleFactor(e,r));const g=n?this._getZoom(e,r):1,d=this._getComputedStyle(e,r),h=(parseFloat(d["padding-top"])||0)*u.y*g,m=(parseFloat(d["padding-right"])||0)*u.x*g,_=(parseFloat(d["padding-bottom"])||0)*u.y*g,E=(parseFloat(d["padding-left"])||0)*u.x*g;i+=h,a+=E,o=o-E-m,c=c-h-_,r[s]={top:i,right:a+o,bottom:i+c,left:a,width:o,height:c,border:l,padding:{top:h,right:m,bottom:_,left:E}}}return r[s]}getContentBox(e,t=!0,n=!0){return this._getContentBox(e,t,n,this._getElementCache(e))}_getClientWidthAndHeight(e,t){let n=e.clientWidth,r=e.clientHeight;if(0===n&&0===r&&"offsetWidth"in e){const s=this._getComputedStyle(e,t);"inline"===s.display&&(n=e.offsetWidth-parseInt(s["border-left-width"])-parseInt(s["border-right-width"]),r=e.offsetHeight-parseInt(s["border-top-width"])-parseInt(s["border-bottom-width"]))}return{width:n,height:r}}_getScrollDimensions(e,t,n){const r="scrollDimensions"+(t?"WithScale":"");if(!n[r]){let s=e.scrollWidth,i=e.scrollHeight;if(0===s&&(0===i||0===e.clientHeight)){const t=this._getClientWidthAndHeight(e,n);s=t.width,i=t.height}if(t){const t=this._getScaleFactor(e,n),r=this._getZoom(e,n);s=s*t.x*r,i=i*t.y*r}n[r]={width:s,height:i}}return n[r]}getScrollDimensions(e,t=!0){return this._getScrollDimensions(e,t,this._getElementCache(e))}_getScrollPosition(e,t,n,r){const s="scrollPosition"+(t?"WithScale":"")+(n?"WithZoom":"");if(!r[s]){let i={x:1,y:1};t&&(i=this._getScaleFactor(e,r));const a=n?this._getZoom(e,r):1,o=e===this._document.body&&"BackCompat"===this._document.compatMode,c=o?0:e.scrollTop*i.y*a,l=o?0:e.scrollLeft*i.x*a;r[s]={top:c,left:l}}return r[s]}getScrollPosition(e,t=!0,n=t){return this._getScrollPosition(e,t,n,this._getElementCache(e))}getScaleFactor(e){return this._getScaleFactor(e,this._getElementCache(e))}_getScaleFactor(e,n){if(void 0===n.scaleFactor){if(e instanceof SVGElement){if(t.isFirefox()||t.isThunderbird())return{x:1,y:1};let n=1;const r=e.getAttribute("transform")||"",s=/scale\((\d+(\.\d+)?)\)/.exec(r);return s&&(n=+s[1]),{x:n,y:n}}{const t=this._getBoundingClientRect(e,n),r=e.offsetWidth,s=e.offsetHeight;n.scaleFactor={x:1,y:1},t.width>0&&r>0&&Math.abs(t.width-r)>1&&(n.scaleFactor.x=t.width/r),t.height>0&&s>0&&Math.abs(t.height-s)>1&&(n.scaleFactor.y=t.height/s)}}return n.scaleFactor}_getZoom(e,n){if(t.isFirefox()||t.isThunderbird())return 1;if("number"!=typeof n.zoom){let t=1,r=e;for(;r&&r!==this._document.documentElement;){t*=+this.getStyle(r,"zoom"),r=r.parentElement}n.zoom=t}return n.zoom}getZoom(e){return this._getZoom(e,this._getElementCache(e))}_getStackingContextWithZIndex(e){const t=this.getComputedStyle(e),n=parseInt(t.zIndex||"");if(isNaN(n))return null;if(t.position&&$e.NON_STATIC_POSITIONS.indexOf(t.position)>-1)return{zIndex:n};if(e.parentElement){const t=this.getComputedStyle(e.parentElement);if("flex"===t.display||"grid"===t.display)return{zIndex:n}}return null}getZIndex(e,t=this._document.documentElement){let n="auto",r=e;if(!r.ownerDocument)return"auto";const s=r.ownerDocument.defaultView.Element,i=r.ownerDocument.defaultView.ShadowRoot;for(;r&&r!==this._document&&r!==t&&r instanceof s;){const e=this._getStackingContextWithZIndex(r);e&&(n=e.zIndex),r=r.parentNode instanceof i?r.parentNode.host:r.parentElement}return n}_isRTL(e,t){return"boolean"!=typeof t.isRTL&&(t.isRTL="rtl"===this.getStyle(e,"direction")),t.isRTL}isRTL(e){return this._isRTL(e,this._getElementCache(e))}isStackingContext(e){const t=this.getComputedStyle(e);return!!(t.position&&$e.NON_STATIC_POSITIONS.indexOf(t.position)>-1)||("none"!==t.transform||"none"!==t.filter||"none"!==t.clipPath||"none"!==t.perspective||Number(t.opacity)<1)}_getTextClientRects(e){const t=this._document.createRange();return t.setStart(e.node,e.start),t.setEnd(e.node,e.end),Array.from(t.getClientRects())}getTextBoundingBoxes(e,t,n=!0){Array.isArray(e)||(e=[e]);let r=[],s=0,i=0;if(n){const e=this.getDocumentScroll();if(s+=e.top,i+=e.left,this._document.body&&this._contains(this._document.body,t)){const e=this.getDocumentGap();s-=e.top,i-=e.left}}for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<$e.MIN_TEXT_BOX_WIDTH)continue;const e=r[r.length-1],n=t.top+s,a=t.right+i,o=t.bottom+s,c=t.left+i,l=t.width,u=t.height;e&&e.right===c&&e.top===n&&e.bottom===o&&e.height===u?(e.right=a,e.width=e.width+l):r.push({top:n,right:a,bottom:o,left:c,width:l,height:u})}}catch(e){}return r}getRelativeTextBoundingBoxes(e,t,n=this.getScrollPosition(t)){Array.isArray(e)||(e=[e]);let r=[];const s=this.getPaddingBox(t,!1,!1),i=s.left-n.left,a=s.top-n.top;for(const t of e)try{const e=this._getTextClientRects(t);for(const t of e){if(t.width<$e.MIN_TEXT_BOX_WIDTH)continue;const e=r[r.length-1],n=t.top-a,s=t.right-i,o=t.bottom-a,c=t.left-i,l=t.width,u=t.height;e&&e.right===c&&e.top===n&&e.bottom===o&&e.height===u?(e.right=s,e.width=e.width+l):r.push({top:n,right:s,bottom:o,left:c,width:l,height:u})}}catch(e){console.error("LT range error",e)}const o=this.getScaleFactor(t);for(const e of r)e.top=Math.round(e.top/o.y),e.right=Math.round(e.right/o.x),e.bottom=Math.round(e.bottom/o.y),e.left=Math.round(e.left/o.x),e.width=e.right-e.left,e.height=e.bottom-e.top;return r}getRelativeTextBoundingBox(e,t){const n=this.getRelativeTextBoundingBoxes(e,t),r=Math.min(...n.map((e=>e.top))),s=Math.max(...n.map((e=>e.right))),i=Math.max(...n.map((e=>e.bottom))),a=Math.min(...n.map((e=>e.left)));return{top:r,right:s,bottom:i,left:a,width:s-a,height:i-r}}_hasRelativePosition(e,t){const n=this._getComputedStyle(e,t).position||"static";return $e.NON_STATIC_POSITIONS.indexOf(n)>-1}getDocumentGap(){if(!this._documentGap&&(this._documentGap={top:0,left:0},this._document.body&&this._hasRelativePosition(this._document.body,this._getElementCache(this._document.body)))){const e=this.getBorderBox(this._document.documentElement),n=this.getBorderBox(this._document.body);let r=this._document.documentElement.offsetTop,s=this._document.documentElement.offsetLeft;if(t.isFirefox()||t.isThunderbird()){let e=null;0===r&&(e=this.getComputedStyle(this._document.documentElement),r=parseInt(e["margin-top"])||0),0===s&&(e=e||this.getComputedStyle(this._document.documentElement),s=parseInt(e["margin-left"])||0)}const i=n.top-e.top+r,a=n.left-e.left+s,o=this.getComputedStyle(this._document.body),c=parseFloat(o["border-top-width"])||0,l=parseFloat(o["border-left-width"])||0;this._documentGap={top:i+c,left:a+l}}return this._documentGap}getDocumentVisibleBox(){if(!this._documentVisibleBox){const e=this.getDocumentScroll();let n=this._document.documentElement.clientHeight,r=this._document.documentElement.clientWidth;t.isThunderbird()&&(n=self.innerHeight,r=self.innerWidth),this._documentVisibleBox={top:e.top,right:e.left+r,bottom:e.top+n,left:e.left,width:r,height:n}}return this._documentVisibleBox}getDocumentScroll(){if(!this._documentScroll){const e=this._document.documentElement&&this._document.documentElement.scrollTop||this._document.body&&this._document.body.scrollTop||0,t=this._document.documentElement&&this._document.documentElement.scrollLeft||this._document.body&&this._document.body.scrollLeft||0;this._documentScroll={top:e,left:t}}return this._documentScroll}}$e.IMPORTANT_REG_EXP=/!important$/,$e.TRANSFORM_MATRIX_REG_EXP=/(?:matrix|scale)\(([\d\.]+),/,$e.NON_STATIC_POSITIONS=["relative","fixed","absolute","sticky"],$e.MIN_TEXT_BOX_WIDTH=.1;var ze=n(412),qe=n.n(ze);function Je(){return qe()}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Qe{}Qe.eventNames={localeChanged:"lt-i18nManager.localeChanged"};const et=class{static init(e){this._instance=e}static addEventListener(e,t){this._instance.addEventListener(e,t)}static setLocale(e){this._instance.setLocale(e)}static getMessage(e,t){return this._instance.getMessage(e,t)}};
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
function tt(e=25,t=null){return new Promise((n=>setTimeout((()=>n(t)),e)))}(()=>{const e=(e,t,n,r)=>{const s=e.ownerDocument;let i=s.elementFromPoint(n,r);if(!i)return!1;if(e===i||e.contains(i))return!0;if(!t.length)return!1;return t.find((e=>e.contains(i)))&&(i=s.elementsFromPoint(n,r).find((e=>!1===t.some((t=>t.contains(e)))))||null),Boolean(i&&(e===i||e.contains(i)))}})();function nt(e,t,n={}){const r=new CustomEvent(t,{detail:n,cancelable:!0});return e.dispatchEvent(r)}(()=>{let e;const t=[]})(),(()=>{let e;const t=[]})();function rt(e){if(e.ownerDocument&&e.ownerDocument.contains(e))return!0;let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t.parentNode instanceof DocumentFragment?t.parentNode.host:t.parentNode}return!1}function st(e,t,n,r=Date.now().toString()){const s=self,i=void 0!==s.screenLeft?s.screenLeft:s.screenX,a=void 0!==s.screenTop?s.screenTop:s.screenY,o=s.innerWidth?s.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,c=s.innerHeight?s.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=o/s.screen.availWidth,u=(o-t)/2/l+i,g=(c-n)/2/l+a;return s.open(e,r,`\n      scrollbars=yes,\n\t  resizable=yes,\n      width=${t/l},\n      height=${n/l},\n      top=${g},\n      left=${u}\n      `)}function it(e){const t={a:1,b:0,c:0,d:1,e:0,f:0};for(let n=0;n<e.transform.baseVal.length;n++){const r=e.transform.baseVal[n];1===r.type?(t.a=r.matrix.a,t.b=r.matrix.b,t.c=r.matrix.c,t.d=r.matrix.d,t.e=r.matrix.e,t.f=r.matrix.f):2===r.type?(t.e=r.matrix.e,t.f=r.matrix.f):3===r.type?(t.a=r.matrix.a,t.d=r.matrix.d):5===r.type?t.b=r.matrix.b:6===r.type&&(t.c=r.matrix.c)}return t}(function(){let e,t=null;const n=t=>{t.origin.match(/^chrome|moz|safari/)&&e(t.data)}})(),function(){let e,t=null;const n=t=>{e(t.data)}}();let at,ot;!function(){const e=/ /g,t=/^#(?:[0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{8})$/i,n=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,s=/^rgba?\(/i,i=/^rgba?\((\d+),(\d+),(\d+)(?:,(\d*(?:\.\d+)?))?\)/i,a=/^hsla?\(/i,o=/^hsla?\(\d+,\d+%,(\d+)%(?:,(\d*(?:\.\d+)?))?\)/i;function c(e,t,n){const r=Math.max(e,t,n)/255,s=Math.min(e,t,n)/255;return Math.round((r+s)/2*100)}at=function(c){if("string"!=typeof c)return 3===c.length?1:c[3];if(c=c.replace(e,""),t.test(c)){const e=n.exec(c)||r.exec(c);if(e&&e[4])return parseInt(2===e[4].length?e[4]:e[4]+e[4],16)/255}else if(s.test(c)){const e=i.exec(c);if(e&&e[4])return+e[4]}else if(a.test(c)){const e=o.exec(c);if(e&&e[2])return+e[2]}return 1},ot=function(l){if("string"!=typeof l)return c(l[0],l[1],l[2]);if(l=l.replace(e,""),t.test(l)){const e=n.exec(l)||r.exec(l);if(e){return c(parseInt(2===e[1].length?e[1]:e[1]+e[1],16),parseInt(2===e[2].length?e[2]:e[2]+e[2],16),parseInt(2===e[3].length?e[3]:e[3]+e[3],16))}}else if(s.test(l)){const e=i.exec(l);if(e){return c(+e[1],+e[2],+e[3])}}else if(a.test(l)){const e=o.exec(l);if(e)return+e[1]}return 100}}();Array.from({length:16},((e,t)=>t.toString(16)));
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ct extends r{constructor(){super(...arguments),this._isProductionEnvironmentCached=null}isProductionEnvironment(){if(null===this._isProductionEnvironmentCached){if(t.isSafari())return!0;t.isFirefox()||t.isThunderbird()?this._isProductionEnvironmentCached=!Je().runtime.id.match("languagetool.dev"):this._isProductionEnvironmentCached="update_url"in Je().runtime.getManifest()}return this._isProductionEnvironmentCached}isRuntimeConnected(){try{return Je().runtime.getManifest(),!0}catch(e){return!1}}getVersion(){if(this.isRuntimeConnected()){const e=Je().runtime.getManifest();return e&&e.version?e.version:"unknown"}return"unknown"}getTrackingId(){return t.isSafari()?"13":t.isThunderbird()?"22":"12"}shouldTrack(){return"1"!==navigator.doNotTrack}getType(){return"extension"}getBeforeUnloadEventName(){return"pagehide"}getURL(e){return Je().runtime.getURL(e)}getUILanguageCode(){return Je().i18n.getUILanguage?Je().i18n.getUILanguage():navigator.language}openWindow(e){Je().runtime.sendMessage({command:"OPEN_URL",url:e})}injectExecutor(){return new Promise(((e,n)=>{if(t.isThunderbird())return e();const r=setTimeout((()=>{n()}),2e3),s=function(){const e=document.createElement("script");return e.setAttribute("data-cookieconsent","ignore"),e}();s.src=Je().runtime.getURL("/content/executor.js"),s.async=!0,s.setAttribute("fetchpriority","low"),s.onload=function(){s.remove(),clearTimeout(r),e()},s.onerror=function(){s.remove(),clearTimeout(r),n()},(document.head||document.documentElement).appendChild(s)}))}destroyExecutor(){nt(document,"lt-execute-destroy")}executeScript(e,t){const n=new self.Object;n.code=t,nt(e,"lt-execute-code",n)}linkInputAreaProperties(e){nt(e,"lt-execute-link-properties")}ping(){return new Promise(((e,t)=>{const n=self.setTimeout((()=>t("timeout")),5e3);Je().runtime.sendMessage({command:"BACKGROUND_PING"}).then((r=>{self.clearTimeout(n),"success"===r?e():t("unknown")})).catch((()=>{self.clearTimeout(n),t("error")}))}))}loadContentScripts(e,t){return this.isRuntimeConnected()?(Je().runtime.getManifest().content_scripts.forEach((n=>{if("js"===t&&n.js){const t=n.js.map((e=>{const t=this.getURL(e);return fetch(t).then((e=>e.text()))}));return Promise.all(t).then((t=>{const n=t.join("\n");if("safari"in e)try{e.eval("window.safari = window.safari || window.parent.safari;")}catch(e){}e.eval(n)}))}if("css"===t&&n.css){const t=n.css.map((e=>{const t=this.getURL(e);return fetch(t).then((e=>e.text()))}));return Promise.all(t).then((t=>{t.forEach((t=>{const n=e.document.createElement("style");n.textContent=t,(e.document.head||e.document.documentElement).appendChild(n)}))}))}})),Promise.resolve()):Promise.reject()}initializeLTAssistant(e,t={}){return Promise.resolve()}getPreferredLanguages(){return Je().runtime.sendMessage({command:"GET_PREFERRED_LANGUAGES"})}startDictionarySync(){return Je().runtime.sendMessage({command:"START_DICTIONARY_SYNC"})}updateDictionary(){return Je().runtime.sendMessage({command:"UPDATE_DICTIONARY"})}addWordToDictionary(e){const t={command:"ADD_WORD_TO_DICTIONARY",word:e};return Je().runtime.sendMessage(t)}addWordsToDictionary(e){const t={command:"BATCH_ADD_WORDS_TO_DICTIONARY",words:e};return Je().runtime.sendMessage(t)}removeWordFromDictionary(e){const t={command:"REMOVE_WORD_FROM_DICTIONARY",word:e};return Je().runtime.sendMessage(t)}clearDictionary(){return Je().runtime.sendMessage({command:"CLEAR_DICTIONARY"})}loadSynonyms(e,t,n){const r={command:"LOAD_SYNONYMS",wordContext:e,language:t,motherLanguage:n};return Je().runtime.sendMessage(r)}abortSynonymsRequest(){return Je().runtime.sendMessage({command:"ABORT_SYNONYMS_REQUEST"})}loadPhrases(e,t,n,r,s){const i={command:"LOAD_PHRASES",uuid:e,phrase:t,language:n,inhouseOnly:r,user:s};return Je().runtime.sendMessage(i)}reportPhrase(e,t){const n={command:"REPORT_PHRASE",uuid:e,report:t};return Je().runtime.sendMessage(n)}abortPhraseRequests(e){const t={command:"ABORT_PHRASE_REQUESTS",type:e};return Je().runtime.sendMessage(t)}initializeUserActivity(e){const t={command:"INITIALIZE_USER_ACTIVITY",data:e};return Je().runtime.sendMessage(t)}sendUserActivityPings(e){const t={command:"SEND_USER_ACTIVITY_PINGS",uuids:e};return Je().runtime.sendMessage(t)}updateUserActivityTextStatistics(e,t){const n={command:"UPDATE_USER_ACTIVITY_TEXT_STATISTICS",uuid:e,stats:t};return Je().runtime.sendMessage(n)}updateUserActivityAppliedSuggestions(e,t,n){const r={command:"UPDATE_USER_ACTIVITY_APPLIED_SUGGESTIONS",isPremium:n,type:t,uuid:e};return Je().runtime.sendMessage(r)}updateUserActivityAppliedRewritings(e){const t={command:"UPDATE_USER_ACTIVITY_APPLIED_REWRITINGS",uuid:e};return Je().runtime.sendMessage(t)}updateUserActivityMeta(e,t){const n={command:"UPDATE_USER_ACTIVITY_META",uuid:e,meta:t};return Je().runtime.sendMessage(n)}sendUserActivity(e){const t={command:"SEND_USER_ACTIVITY",uuid:e};return Je().runtime.sendMessage(t)}destroyUserActivity(e){const t={command:"DESTROY_USER_ACTIVITY",uuid:e};return Je().runtime.sendMessage(t)}loadSplitSentence(e,t,n,r,s){const i={command:"LOAD_SPLIT_SENTENCE",uuid:e,phrase:t,language:n,inhouseOnly:r,user:s};return Je().runtime.sendMessage(i)}trackEvent(e,t){const n={command:"TRACK_EVENT",action:e,label:t};return Je().runtime.sendMessage(n)}trackTextLength(e){const t={command:"TRACK_TEXT_LENGTH",textLength:e};return Je().runtime.sendMessage(t)}pageLoaded(e,t,n,r,s,i){const a={command:"PAGE_LOADED",enabled:e,capitalization:t,supported:n,beta:r,unsupportedMessage:s,isDarkMode:i};return Je().runtime.sendMessage(a)}ltAssistantStatusChanged(e,t){const n="object"==typeof e?e:t,r={command:"LTASSISTANT_STATUS_CHANGED",tabId:"number"==typeof e?e:void 0,enabled:n.enabled,capitalization:n.capitalization};return Je().runtime.sendMessage(r)}check(e,t,n,r,s,i){const a={command:"CHECK_TEXT",text:t,changedParagraphs:n,language:e.language,forceLanguage:e.forceLanguage,hasUserChangedLanguage:i,metaData:r,options:s};return Je().runtime.sendMessage(a)}isOptionsPageSupported(){return!0}openOptionsPage(e,t){const n={command:"OPEN_OPTIONS",target:e,ref:t};return Je().runtime.sendMessage(n)}isFeedbackFormSupported(){return!0}openFeedbackForm(e,t="",n=""){const r={command:"OPEN_FEEDBACK_FORM",url:e,title:t,html:n};return Je().runtime.sendMessage(r)}openPremiumPage(e,t=0,n=0,r=0,s="",i){const a={command:"OPEN_PREMIUM_PAGE",campaign:e,hiddenGrammarMatches:t,hiddenStyleMatches:n,hiddenPunctuationMatches:r,historicMatches:s,textLanguage:i||void 0};return Je().runtime.sendMessage(a)}checkForPaidSubscription(){return Je().runtime.sendMessage({command:"CHECK_FOR_PAID_SUBSCRIPTION"})}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class lt extends Qe{addEventListener(e,t){}setLocale(e){}getMessage(e,t){return Je().i18n.getMessage?Je().i18n.getMessage(e,t):e}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var ut=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))},gt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};class dt{static getServerBaseUrl(e,t=!1,n=!0){const r=n&&(t?this._useFallbackServerForParagraphLevelRequests:this._useFallbackServerForTextLevelRequests)&&!e.apiServerUrl;return e.apiServerUrl&&!this._isLanguageToolServer(e.apiServerUrl)?e.apiServerUrl:e.isPremium||e.user||e.apiServerUrl===R?r?P:R:r?I:C}static _getServerFullUrl(e,t=!1,n=!1){const r=this.getServerBaseUrl(e,t),s=r.endsWith("/")?"":"/",i=new URL(r+s+"check");return i.searchParams.set("c","1"),t&&!1===e.useParagraphLevelCaching||i.searchParams.set("instanceId",e.instanceId),n&&i.searchParams.set("languageChanged","true"),e.version&&i.searchParams.set("v",e.version),i.toString()}static _abortCheckRequest(e){this._textLevelAbortControllers.has(e)&&(this._textLevelAbortControllers.get(e).abort(),this._textLevelAbortControllers.delete(e))}static _abortParagraphLevelCheckRequest(e){this._paragraphLevelAbortControllers.has(e)&&(this._paragraphLevelAbortControllers.get(e).abort(),this._paragraphLevelAbortControllers.delete(e))}static _abortLanguageDetectionRequest(e){this._languageDetectionAbortControllers.has(e)&&(this._languageDetectionAbortControllers.get(e).abort(),this._languageDetectionAbortControllers.delete(e))}static _prepareText(e){return e.replace(this.ZWNJ_REGEXP,this.ZWS)}static _joinInChunks(e,t=H){const n=[];let r=0,s=[];return e.forEach((e=>{r>t&&(r=0,s=[]),s.push(e),r+=e.text.length,n.includes(s)||n.push(s)})),n}static _getRequestData(e,t,n){const r=new URLSearchParams,s={text:e};n.recipientInfo&&(n.recipientInfo.address||n.recipientInfo.fullName)&&(s.metaData={EmailToAddress:n.recipientInfo.address,FullName:n.recipientInfo.fullName}),r.append("data",JSON.stringify(s));const i=Boolean(n.isPremium||!n.apiServerUrl||n.apiServerUrl&&n.apiServerUrl.startsWith(R)||n.apiServerUrl&&!this._isLanguageToolServer(n.apiServerUrl));if(i&&n.user&&"password"in n.user?(r.append("username",n.user.email),r.append("password",n.user.password)):i&&n.user&&"token"in n.user&&(r.append("username",n.user.email),r.append("tokenV2",n.user.token)),r.append("textSessionId",n.instanceId),n.isPremium||r.append("enableHiddenRules","true"),n.motherTongue&&de.includes(n.motherTongue)&&r.append("motherTongue",n.motherTongue),"normal"!==n.checkLevel&&r.append("level",n.checkLevel.replace("hidden-","")),t)r.append("language",t.code);else{r.append("language","auto"),r.append("noopLanguages",n.preferredLanguages.join(","));const e=this._getPreferredVariants(n.languageVariants.en,n.languageVariants.de,n.languageVariants.pt,n.languageVariants.ca);e.length>0&&r.append("preferredVariants",e.toString())}const a=[];if(n.qb&&a.push("qb"),n.ggec&&a.push("deggec"),a.length&&r.append("abtest",a.join(",")),r.append("preferredLanguages",n.preferredLanguages.join(",")),n.writingGoalId){const e=this.HIGH_LEVEL_GOALS.find((e=>e.id===n.writingGoalId));e&&r.append("toneTags",e.tags.join(","))}const o=["WHITESPACE_RULE"].concat(n.disabledRules.filter((e=>ce.includes(e))));return r.append("disabledRules",o.join(",")),n.userAgent&&r.append("useragent",n.userAgent),r}static _getPreferredVariants(e,t,n,r){const s=[];return e&&s.push(e),t&&s.push(t),n&&s.push(n),r&&s.push(r),s}static _getTextLevelRequestData(e,t,n){const r=this._getRequestData(e,t,n);return r.append("mode","textLevelOnly"),r}static _getParagraphLevelCheckRequestData(e,t,n,r){const s=this._getRequestData(e,t,n);return s.append("mode","allButTextLevelOnly"),s.append("allowIncompleteResults",String(r)),s}static _sendRequest(e,t,n=_){return ut(this,void 0,void 0,(function*(){const r=fetch(e,t).catch((t=>{throw"AbortError"===t.name?{reason:"AbortError",status:0,response:t.message||""}:{reason:"ConnectionError",status:0,url:e.replace(/\?.*/,""),response:t.message||""}})).then(this._checkForException).then((e=>e.json())),s=new Promise(((t,r)=>{setTimeout((()=>{r({reason:"TimeoutError",status:0,url:e.replace(/\?.*/,""),response:""})}),n)}));return Promise.race([r,s])}))}static _isConnectionOrServerIssue(e){return w.includes(e.status)||["ConnectionError","TimeoutError"].includes(e.reason)}static _getGraphemesCount(e,t,n=0){for(let r=n;r<e.length;r++){if(t<=0)return r-n;t-=e[r].length}return e.length-n}static _getCodepointsCount(e,t,n=0){let r=0;for(let s=n;s<Math.min(e.length,n+t);s++)r+=e[s].length;return r}static _correctMatches(e,t,n){if(t!==n){const r=We(t),s=We(n);for(const t of e){const e=dt._getGraphemesCount(r,t.offset),n=dt._getGraphemesCount(r,t.length,e);t.offset=dt._getCodepointsCount(s,e),t.length=dt._getCodepointsCount(s,n,e)}}return e}static _getLeftText(e,t,n,r=15){let s=Math.max(t-r,0);if(n){const n=e.lastIndexOf("\n",t);n>=s&&(s=n+1)}let i=e.substring(s,t).replace(this.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP,"");return 0===s||n&&"\n"===e[s-1]||(i="..."+i),i}static _getRightText(e,t,n,r=15){let s=Math.min(t+r,e.length);if(n){const n=e.indexOf("\n",t);-1!==n&&n<=s&&(s=n)}let i=e.substring(t,s).replace(this.NON_ALPHANUMERIC_AT_END_REGEXP,"");return s===e.length||n&&"\n"===e[s]||(i+="..."),i}static _transformMatches(e,t,n,r=!1){return e.map((e=>{const s=e.rule.id.startsWith("DB_"),i=this.SPELLING_RULES_ID.some((t=>e.rule.id.includes(t))),a=this.STYLE_ISSUE_TYPES.some((t=>e.rule.issueType===t)),o="typographical"===e.rule.issueType&&"CASING"!==e.rule.category.id||"PUNCTUATION"===e.rule.category.id||"TYPOGRAPHY"===e.rule.category.id||e.rule.category.id.includes("KOMMA"),c=Boolean(e.rule.tags&&e.rule.tags.includes("picky")),l=t.substr(e.offset,e.length),u=`${dt._getLeftText(t,e.offset,r)}|${l}|${dt._getRightText(t,e.offset+e.length,r)}`,g=dt._getLeftText(t,e.offset,!0,60),d=dt._getRightText(t,e.offset+e.length,!0,60),h=`${xe(g)}<lt-em>${xe(l)}</lt-em>${xe(d)}`;let m="";e.shortMessage&&e.shortMessage.length<60&&e.shortMessage!==e.message&&(m=e.shortMessage.replace(this.PUNCTUATION_AT_END,""));const _=e.replacements.map((e=>({value:e.value,prefix:e.prefix,suffix:e.suffix,type:e.type,shortDescription:e.shortDescription})));return{isParagraphLevelCheck:r,rule:e.rule,isCustomError:s,isSpellingError:i,isStyleError:a,isPunctuationError:o,isPicky:c,contextForSureMatch:e.contextForSureMatch,language:{code:n.code,name:n.name},description:e.message,shortDescription:m,start:e.offset,end:e.offset+e.length,length:e.length,originalPhrase:l,contextPhrase:u,longContextPhrase:h,fixes:_}}))}static _adjustErrors(e,t,n){const r=n.recipientInfo?n.recipientInfo.fullName.split(" ").filter((e=>e)):[];return e.filter((e=>{if(n.ignoreCapitalizationErrors){if(e.fixes.some((t=>t.value.toLowerCase()===e.originalPhrase.toLowerCase())))return!1;if("UPPERCASE_SENTENCE_START"===e.rule.id)return!1}e.fixes=e.fixes.filter((t=>t.value!=="("+e.originalPhrase+")"&&t.value!==e.originalPhrase&&"(suggestion limit reached)"!==t.value&&"(se ha alcanzado el límite de sugerencias)"!==t.value&&"(Vorschlagslimit erreicht)"!==t.value)),e.language.code.startsWith("en")&&Oe(e.originalPhrase)&&!/[a-z]/i.test(e.contextPhrase)&&e.fixes.forEach((t=>{t.value.toLowerCase()!==e.originalPhrase.toLowerCase()&&(t.value=t.value.toUpperCase())})),"PT_CLICHE_REPLACE"!==e.rule.id&&"PT_WORDINESS_REPLACE"!==e.rule.id||e.fixes.forEach((t=>{(t.value.startsWith("REFORMULAR")||t.value.startsWith("APAGAR")||t.value.startsWith("ESPECIFICAR"))&&(e.description=e.description.replace(/\sÉ preferível dizer.+(REFORMULAR|APAGAR|ESPECIFICAR).+$/,""),t.value="")}));if(this.EMAIL_SIGNATURE_SEPARATOR_REGEXP.test(e.originalPhrase))return!1;if(this.ZWS_REGEXP.test(e.originalPhrase))return!1;if(e.rule.id.endsWith("WORD_REPEAT_BEGINNING_RULE")&&this.ONLY_NUMBERS_REGEXP.test(e.originalPhrase))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.COLON_WHITESPACE_REGEXP.test(e.originalPhrase))return!1;const s=t.substring(e.start-25,e.start),i=t.substr(e.end,25);if(n.ignoreCapitalizationErrorsAtLineStart&&"UPPERCASE_SENTENCE_START"===e.rule.id&&this.MID_SENTENCE_LINE_BREAK.test(s))return!1;if("DE_CASE"===e.rule.id&&this.BULLET_POINT_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.PIPE_AT_END_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.MARKDOWN_HEADLINE_REGEXP.test(s))return!1;if("DE_CASE"===e.rule.id&&this.EMOJI_SENTENCE_START_REGEXP.test(s))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP.test(i))return!1;if("LEERZEICHEN_HINTER_DOPPELPUNKT"===e.rule.id&&this.WIKI_MARKUP_AT_END_REGEXP.test(s))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&("!"===e.originalPhrase||"?"===e.originalPhrase)&&(s.endsWith("!")||s.endsWith("?")))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.ONE_LETTER_AT_END_REGEXP.test(s))return!1;if(e.rule.id.endsWith("UNPAIRED_BRACKETS")&&this.NUMBER_WITH_DOT_AT_END_REGEXP.test(s))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&s.endsWith("{!"))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&this.SINGLE_UPPERCASE_LETTER_REGEXP.test(e.originalPhrase)&&this.ABBREVIATION_AT_END_REGEXP.test(s))return!1;if("SENTENCE_WHITESPACE"===e.rule.id&&"net"===e.originalPhrase.toLowerCase())return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&this.NET_AT_BEGINNING_REGEXP.test(i))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(")")&&s.endsWith(this.ZWS))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.endsWith(".")&&this.FILE_TYPE_AT_BEGINNING_REGEXP.test(i))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&s.endsWith("(")&&(",)"===e.originalPhrase||".)"===e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&s.endsWith("\n")&&[")","}","]","."].includes(e.originalPhrase))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&i.startsWith("/"))return!1;if("COMMA_PARENTHESIS_WHITESPACE"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("WORT1_BINDESTRICH_SPACE_WORT2"===e.rule.id&&e.originalPhrase.endsWith(this.ZWS))return!1;if("MULTIPLICATION_SIGN"===e.rule.id&&(this.AT_LEAST_TWO_LETTERS_AT_END_REGEXP.test(s)||!i||this.PUNCTUATION_AT_BEGINNING_REGEXP.test(i)))return!1;if("ZBEDNA_SPACJA_PRZED"===e.rule.id&&e.originalPhrase.includes(this.ZWS))return!1;if("UNLIKELY_OPENING_PUNCTUATION"===e.rule.id&&this.PUNCTUATION_SPACE_AT_END_REGEXP.test(s))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(!this.LOWERCASE_REGEXP.test(e.originalPhrase)||e.originalPhrase.includes("-")||e.originalPhrase.includes("__")||this.SLASH_AT_END_REGEXP.test(s)||this.SLASH_AT_BEGINNING_REGEXP.test(i)))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&s.endsWith("[")&&i.startsWith("]"))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&this.QUOTE_AT_END_REGEXP.test(s)&&this.QUOTE_AT_BEGINNING_REGEXP.test(i))return!1;if("WORD_CONTAINS_UNDERSCORE"===e.rule.id&&(s.endsWith("=")||s.endsWith("&")||s.endsWith("?")))return!1;if(["APOS_INCORRECT","LOOSE_ACCENTS"].includes(e.rule.id)&&"`"===e.originalPhrase)return!1;if(["_2_AANH_B","FALSCHES_ANFUEHRUNGSZEICHEN_2"].includes(e.rule.id)&&"``"===e.originalPhrase)return!1;if("DASH_RULE"===e.rule.id&&i.startsWith(" [")&&(!s||s.endsWith("\n")))return!1;if(e.isSpellingError&&e.originalPhrase.length>6&&e.fixes.length>4&&e.language.code.startsWith("de")&&(e.fixes.length=4),e.isSpellingError||"WORD_CONTAINS_UNDERSCORE"===e.rule.id){const t=e.originalPhrase.charAt(0),a=e.originalPhrase.toLowerCase();if(je(e,n.dictionary))return!1;if((i.startsWith("_")||s.endsWith("_"))&&!e.language.code.startsWith("de"))return!1;if(e.originalPhrase.startsWith("$")&&i.startsWith("}")&&s.endsWith("{"))return!1;if(e.originalPhrase.startsWith("$")&&e.originalPhrase.endsWith("$"))return!1;if(this.HTML_ENTITIES.includes(e.originalPhrase)&&s.endsWith("&")||this.HTML_ENTITIES_WITH_AND.includes(e.originalPhrase)||this.HTML_ENTITIES_WITH_AND.includes("&"+e.originalPhrase))return!1;if(this.COMMON_TLDS.some(((e,t)=>a.endsWith("."+e)||this.COMMON_TLD_WITH_DOT_REGEXPS[t].test(i))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(s)&&this.COMMON_TLDS.includes(a))return!1;if(this.COMMON_FILE_TYPES.some(((e,t)=>a.endsWith("."+e)||this.COMMON_FILE_TYPE_WITH_DOT_REGEXPS[t].test(i))))return!1;if(this.DOT_WITH_PREFIX_REGEXP.test(s)&&this.COMMON_FILE_TYPES.includes(a))return!1;const o="@"===t||this.MENTION_SYMBOL_AT_BEGINNING_REGEXP.test(s),c="#"===t||this.HASH_SYMBOL_AT_BEGINNING_REGEXP.test(s);if(o||c)return!1;if(r.some((t=>t===e.originalPhrase)))return!1;if(this.WAVY_DASH_REGEXP.test(e.originalPhrase))return!1;for(const t of r)if(t.toLowerCase()===e.originalPhrase.toLowerCase()&&!e.fixes.some((e=>e.value===t))){e.fixes.unshift({value:t});break}}return!0}))}static _processResponse(e,t,n,r,s,i=!1){e.matches=this._correctMatches(e.matches,n,r);let a=this._transformMatches(e.matches,r,e.language,i);a=this._adjustErrors(a,r,s);let o=[],c=[],l=[];const u=!s.apiServerUrl||this._isLanguageToolServer(s.apiServerUrl);return t=this._correctMatches(t.filter((({start:e,end:t})=>t-e>-1)).map((({start:e,end:t})=>({offset:e,length:t-e}))),n,r).map((({offset:e,length:t})=>({start:e,end:e+t,length:t}))),!s.isPremium&&u&&e.language&&e.language.code.startsWith("nl")&&(a=a.filter((e=>!this.NL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],o.push(e),!1)))),!s.isPremium&&u&&e.language&&e.language.code.startsWith("pl")&&(a=a.filter((e=>!this.PL_PREMIUM_RULES.includes(e.rule.id)||(e.rule.id="HIDDEN_RULE",e.fixes=[],o.push(e),!1)))),s.isPremium&&a.forEach((e=>{this.NL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0),this.PL_PREMIUM_RULES.includes(e.rule.id)&&(e.rule.isPremium=!0)})),s.debug&&a.forEach((e=>{e.description=(e.rule.isPremium?"prem:":"")+e.rule.id+"["+(e.rule.subId||"")+"] "+e.description})),e.hiddenMatches&&(o=o.concat(this._transformMatches(e.hiddenMatches,r,e.language,i))),"hidden-picky"===s.checkLevel&&(a=a.filter((e=>!e.isPicky||(l.push(e),!1))),e.hiddenMatches&&(o=o.filter((e=>!e.isPicky||(c.push(e),!1))))),{errors:a,premiumErrors:o,pickyErrors:l,premiumPickyErrors:c,sentenceRanges:t}}static _getNonAlphaNumericalOffsets(e,t){const n=new RegExp(`^(?:\\p{L}|\\p{N}${t?"|"+t.start:""})$`,"gu"),r=new RegExp(`^(?:\\p{L}|\\p{N}${t?"|"+t.end:""})$`,"gu"),s=e.split("").reverse().join(""),i=Math.floor(e.length/2);let a,o,c=!1,l=!1,u=0,g=0;for(let t=0;t<i;t++){const i=e.charAt(t),d=s.charAt(t);if(!0===a||null!==i.match(n)&&!i.match(/\s/)?a=!0:(c=null!==i.match(this.QUOTE_AT_BEGINNING_REGEXP),u+=1,a=!1),!0===o||null!==d.match(r)&&!d.match(/\s/)?o=!0:(l=null!==d.match(this.QUOTE_AT_END_REGEXP),g+=1,o=!1),a&&o)break}return c&&!l&&(u-=1),l&&!c&&(g-=1),[u,g]}static _trimSentenceRanges(e,t){const n=[];for(const r of e){const{start:e,end:s}=r,i=t.substring(e,s);if(!i.trim())continue;const[a,o]=this._getNonAlphaNumericalOffsets(i,{start:"[¿¡(@]",end:"[?!.)…:;‽]"}),c=e+a,l=c+i.length-a-o,u=l-c;n.push({start:c,end:l,length:u})}return n}static _correctErrorOffsets(e,t){const n=[];let r=0;for(const s of e){const e=s.text.length;for(const i of t)if(i.start>=r&&i.end<=r+e){const e=Object.assign({},i);e.start=e.start-r+s.offset,e.end=e.start+e.length,n.push(e)}r+=e+2}return n}static checkTextLevel(e,t,n,r=!1){return ut(this,void 0,void 0,(function*(){if(!(e=this._prepareText(e)).trim()||/^( *\n)* *$/g.test(e))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortCheckRequest(n.instanceId),this._textLevelAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForTextLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=x&&(this._useFallbackServerForTextLevelRequests=!1);const s=e.normalize(),i=this._getServerFullUrl(n,!1,r),a={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(s,t,n),signal:this._textLevelAbortControllers.get(n.instanceId).signal};return this._sendRequest(i,a).then((t=>{const{errors:r,premiumErrors:i,pickyErrors:a,premiumPickyErrors:o}=this._processResponse(t,[],s,e,n);return{language:{code:t.language.code,name:t.language.name,detectedLanguage:t.language.detectedLanguage},errors:r,premiumErrors:i,pickyErrors:a,premiumPickyErrors:o}})).catch((r=>{if(this._isConnectionOrServerIssue(r)){this._abortCheckRequest(n.instanceId);if(!n.apiServerUrl&&!this._useFallbackServerForTextLevelRequests)return this._useFallbackServerForTextLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkTextLevel(e,t,n)}throw r}))}))}static checkParagraphLevel(e,t,n,r=!1){return ut(this,void 0,void 0,(function*(){e.forEach((e=>{e.text=this._prepareText(e.text)}));if(!e.some((e=>!!e.text.trim())))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[],isIncompleteResult:!1};this._abortParagraphLevelCheckRequest(n.instanceId),this._paragraphLevelAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForParagraphLevelRequests&&Date.now()-this._mainServerUnavailabilityTimeStamp>=x&&(this._useFallbackServerForParagraphLevelRequests=!1);const s=this._getServerFullUrl(n,!0),i=this._joinInChunks(e),a=[];for(const e of i){const i=e.map((e=>e.text)).join("\n\n"),o=i.normalize(),c={method:"post",mode:"cors",credentials:"omit",body:this._getParagraphLevelCheckRequestData(o,t,n,r),signal:this._paragraphLevelAbortControllers.get(n.instanceId).signal},l=this._sendRequest(s,c).then((t=>{const{language:r,warnings:s,sentenceRanges:a}=t,c=(a||[]).map((([e,t])=>({start:e,end:t,length:t-e})));let l=t.ignoreRanges||[];n.debug&&l.length&&(t.matches=this._filterErrorsInIgnoredRanges(t.matches,l),t.hiddenMatches&&(t.hiddenMatches=this._filterErrorsInIgnoredRanges(t.hiddenMatches,l)),this._addIgnoredRangeMatches(o,t.matches,l));const u=this._processResponse(t,this._trimSentenceRanges(c,o),o,i,n,!0),{errors:g,premiumErrors:d,pickyErrors:h,premiumPickyErrors:m}=u;let _=gt(u,["errors","premiumErrors","pickyErrors","premiumPickyErrors"]).sentenceRanges;const E=this._correctErrorOffsets(e,g),p=this._correctErrorOffsets(e,d),f=this._correctErrorOffsets(e,h),A=this._correctErrorOffsets(e,m);return _=this._correctErrorOffsets(e,_),{language:{code:r.code,name:r.name},errors:E,premiumErrors:p,pickyErrors:f,premiumPickyErrors:A,isIncompleteResult:!!s&&s.incompleteResults,sentenceRanges:_}}));a.push(l)}return Promise.all(a).then((e=>({language:e[0].language,errors:Array.prototype.concat.apply([],e.map((e=>e.errors))),premiumErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumErrors))),premiumPickyErrors:Array.prototype.concat.apply([],e.map((e=>e.premiumPickyErrors))),pickyErrors:Array.prototype.concat.apply([],e.map((e=>e.pickyErrors))),isIncompleteResult:e.some((e=>e.isIncompleteResult)),sentenceRanges:Array.prototype.concat.apply([],e.filter((e=>Boolean(e.sentenceRanges))).map((e=>e.sentenceRanges)))}))).catch((s=>{if(this._isConnectionOrServerIssue(s)){this._abortParagraphLevelCheckRequest(n.instanceId);if((!n.apiServerUrl||this._isLanguageToolServer(n.apiServerUrl))&&!this._useFallbackServerForParagraphLevelRequests)return this._useFallbackServerForParagraphLevelRequests=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.checkParagraphLevel(e,t,n,r)}throw s}))}))}static _filterErrorsInIgnoredRanges(e,t){return e.filter((e=>{const n=e.offset,r=e.offset+e.length;return!t.some((e=>n>=e.from&&n<=e.to||r>=e.from&&r<=e.to))}))}static _addIgnoredRangeMatches(e,t,n){n.forEach((n=>{let r=n.to-n.from;const s=e.substring(n.from,n.to).match(/\s+$/);s&&(r-=s[0].length);const i={offset:n.from,length:r,rule:{id:"IGNORED_RANGE",category:{id:"IGNORED_RANGE",name:"Ignored Range"},issueType:"ignoredRange",description:"",isPremium:!1},contextForSureMatch:0,message:"This text is in a different language than the rest of the text.",shortMessage:"Different language: "+n.language.code,replacements:[]};t.push(i)}))}static detectLanguage(e,t,n){return ut(this,void 0,void 0,(function*(){if(e=this._prepareText(e),t||!e.trim()||/^( *\n)* *$/g.test(e))return{language:t,errors:[],premiumErrors:[],pickyErrors:[],premiumPickyErrors:[]};this._abortLanguageDetectionRequest(n.instanceId),this._languageDetectionAbortControllers.set(n.instanceId,new AbortController),this._useFallbackServerForLanguageDetection&&Date.now()-this._mainServerUnavailabilityTimeStamp>=x&&(this._useFallbackServerForLanguageDetection=!1);const r=e.substr(0,1e3).normalize(),s=this._getServerFullUrl(n,!1),i={method:"post",mode:"cors",credentials:"omit",body:this._getTextLevelRequestData(r,t,n),signal:this._languageDetectionAbortControllers.get(n.instanceId).signal};return this._sendRequest(s,i).then((e=>({language:{code:e.language.code,name:e.language.name},errors:[],premiumErrors:[],premiumPickyErrors:[],pickyErrors:[]}))).catch((r=>{if(this._isConnectionOrServerIssue(r)){this._abortLanguageDetectionRequest(n.instanceId);if((!n.apiServerUrl||this._isLanguageToolServer(n.apiServerUrl))&&!this._useFallbackServerForLanguageDetection)return this._useFallbackServerForLanguageDetection=!0,this._mainServerUnavailabilityTimeStamp=Date.now(),this.detectLanguage(e,t,n)}throw r}))}))}static _isLanguageToolServer(e){return!!e&&(e.includes("api.languagetool.org")||e.includes("languagetool.org/api")||e.includes("api.languagetoolplus.com"))}static checkForPaidSubscription(e,t,n,r=R){return new Promise(((s,i)=>{r+=r.endsWith("/")?"check":"/check";const a=new URLSearchParams;a.append("language","en-us"),a.append("data",JSON.stringify({text:"The languagetool testrule 8634756."})),e&&t?(a.append("username",e),a.append("password",t)):e&&n&&(a.append("username",e),a.append("tokenV2",n));const o={method:"post",mode:"cors",credentials:"omit",body:a};this._sendRequest(r,o).then((e=>{const t=e.matches.some((e=>"PREMIUM_FAKE_RULE"===e.rule.id));s(t)})).catch(i)}))}static addWordToDictionary(e,t){const n=this.getServerBaseUrl(t),r=n.endsWith("/")?"":"/",s=new URL(n+r+"words/add");if(t.user&&"token"in t.user)s.searchParams.set("username",t.user.email),s.searchParams.set("tokenV2",t.user.token);else{if(!t.user||!("password"in t.user))return Promise.reject(new Error("Not logged-in for adding words to dictionary"));s.searchParams.set("username",t.user.email),s.searchParams.set("password",t.user.password)}return s.searchParams.set("word",e.trim()),fetch(s.toString(),{method:"POST"}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`))))}}dt.NL_PREMIUM_RULES=["FAAG_VAAG","TOO_LONG_SENTENCE","_2_LEESTEKENS","WEEKEND","CASU_QUO","MOMENTEEL","SLECHTS","LEENWOORDEN","KOMMA_HOOR","RELEVANT","HINTS","CHECKEN","ALLEEN_BE","MACHTE","ECHTER","COMMUNICEREN","DESIGN","SANDAAL_ZANDAAL","N","MIDDELS","INTEGREREN","PRIMAIR","OVERIGENS","BETREFFENDE","AGENDA","ERGO","TEN_BEHOEVE","KOMMA_AANH","TM","IE","TER_ZAKE","SIGNIFICANT","GELIEVE","BEHOREN","NAAR_AANLEIDING_VAN","VAN_PLAN_ZIJN","HEDEN","TEN_DODE","VREEMD_VRZ_HIJ","DES","IMPACT","IMMER","BOVENSTAAND","XXXYJE","DUTCH_WRONG_WORD_IN_CONTEXT","LANCEREN","MET_BEHULP_VAN","PRIORITEIT","UWENTWEGE","CATEGORIE","CRITERIUM","GEMOTIVEERD"],dt.PL_PREMIUM_RULES=["BOWIEM_ZAS","ZE_Z_SPOL","SPACJA_ZNAK_ROWNOSCI","BRAK_PRZECINKA_GDY","PYTANIE_CO","BRAK_PRZECINKA_JESLI","PRZECINEK_ANI","SKROTOWCE_BEZ_DYWIZU","NIEZGODNOSC_PRZYPADKU_PO_LICZEBNIKU","PODMIOT_ORZECZENIE","ROWNIE_JAK","JAK_I","PRZECINEK_POROWNANIE","WOLACZ_BEZ_PRZECINKA","ODNOSNIE_DO","GENERALNIE","BOWIEM_ZAS_PRZECINEK","WYDAWAC_SIE_BYC","POSIADAC_MIEC","PL_GUILLEMET","ITP_ITD","SPACJA_PROCENT","PO","W_TEMACIE","PL_DWA_WYRAZY","W_NAWIAZANIU_DO","WE_W","POKI_CO","VS","DZIEN_DZISIEJSZY","WIELOKROTNE_WYSTPIENIE_TEGO_SAMEGO_WYRAENIA_PRZYIMKOWEGO","I_LUB","PELNIC_ROLE","OKRES_CZASU","UZNAC_JAKO","EFEKT_KONCOWY","DLATEGO_PONIEWAZ","NA_DZIEN_DZISIEJSZY","DODATKOWO_CO_WIECEJ","OWY_W","DZIEN_JUTRZEJSZY","ADRES_ZAMIESZKANIA","W_CHWILI_OBECNEJ","BYC_ZNAJDOWAC_SIE_W_POSIADANIU","DO_TERAZ","PROTOKOL_Z_CZEGO","PO_NAJMNIEJSZEJ_LINII","POTRAFIACY","zarowno_jak_rowniez","GRAC_FAIR_PLAY","DRUGI_NAJWIEKSZY","COFAC_SIE_DO_TYLU","DZIEN_WCZORAJSZY","NA_PRZESTRZENI","IDENTYCZNY_JAK","ZA_WYJATKIEM","MAPA_DROGOWA","W_PRZECIGU_TYGODNIA_W_CIGU","NAPOTKAC_NA","PRZERWA_KAWOWA","WYSOKA_FREKWENCJA","UBRAC_ZALOZYC","PRZY_UDZIALE","W_SLAD_ZA","WYRAZIC_POPARCIE","W_TYM_WZGLEDZIE","PO_PIERWSZE_PRIMO","DOMYSLEC_SIE","WARTY","IDENTYCZNY_DO","W_DRODZE_WYJATKU","PRZEDKLADAC_WNIOSEK","POD_RZAD","PRZYJAZNY_DLA_UZYTKOWNIKA","NA_WSKUTEK","SWIECIC_SUKCESY","W_WEGRZECH","KONDYCJA_FINANSOWA","RULE_NIEMNIEJ","FORMULA_KREMU","PODDAWAC_W_WATPLIWOSC","OPATRZEC_SIE","ODGRYWAC_ZNACZENIE","INFORMACJE_WRAZLIWE","DO_DZIS_DZIEN","CO_I_RAZ","OKRAGLY_ROK","SZERSZE_INFORMACJE","WYSOKA_FORMA","CZEKAC_ZA","BYNAJMNIEJ","WYWIERAC_PIETNO","DOPATRZEC_SIE","ZLA_RENOMA","W_PELNYM_TEGO","W_KAZDYM_BADZ","KOSZTOWAC_TANIEJ","DYGITALNY"],dt.SPELLING_RULES_ID=["SPELLER_RULE","MORFOLOGIK_RULE","HUNSPELL","SPELLING_RULE","ORTHOGRAPHY"],dt.STYLE_ISSUE_TYPES=["style","locale-violation","register"],dt.EMAIL_SIGNATURE_SEPARATOR_REGEXP=/^[\‐|\-]{2,}|[\‐|\-]{2,}$/,dt.ONLY_NUMBERS_REGEXP=/^[0-9]+$/,dt.COLON_WHITESPACE_REGEXP=/^[;:]\s/,dt.ONE_LETTER_AT_END_REGEXP=/(\s|^|\()[a-z]\.?\s?$/i,dt.NUMBER_WITH_DOT_AT_END_REGEXP=/\d\.?\s?$/,dt.NUMBER_WITH_PARENTHESIS_AT_END_REGEXP=/\d\.?\)\s$/,dt.PUNCTUATION_AT_END=/(\.|\!)$/,dt.BULLET_POINT_REGEXP=/(\u25b6\ufe0e|\u25BA|\*|-|–|\u2606|\u2605|\u25cf|\u2022|\u25e6|\u27A4|\u2714)\s+$/,dt.LOWERCASE_REGEXP=/[a-z]/,dt.DOT_WITH_PREFIX_REGEXP=/\w\.$/,dt.SLASH_AT_END_REGEXP=/(\/|\\)$/,dt.AT_LEAST_TWO_LETTERS_AT_END_REGEXP=/[a-z]{2}$/i,dt.SLASH_AT_BEGINNING_REGEXP=/^(\/|\\)/,dt.QUOTE_AT_END_REGEXP=/[\"\“\”\„]$/,dt.QUOTE_AT_BEGINNING_REGEXP=/^[\"\“\”\„]/,dt.PUNCTUATION_AT_BEGINNING_REGEXP=/^\s?[\.\!\?,:…]/,dt.PUNCTUATION_SPACE_AT_END_REGEXP=/[\.…\?\!]\s+/,dt.MARKDOWN_HEADLINE_REGEXP=/^#{1,6}\s/m,dt.MARKDOWN_INLINE_FORMAT_AT_BEGINNING_REGEXP=/^[\*\~\_\^\+\%\@]/m,dt.WIKI_MARKUP_AT_END_REGEXP=/\[\[[a-z]+$/,dt.PIPE_AT_END_REGEXP=/\|\s+$/,dt.MENTION_SYMBOL_AT_BEGINNING_REGEXP=/@[a-z\.\-]*$/i,dt.HASH_SYMBOL_AT_BEGINNING_REGEXP=/#[a-z\.\-]*$/i,dt.EMOJI_SENTENCE_START_REGEXP=/(\.|!|\?|^)\s?(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])\s+/,dt.ABBREVIATION_AT_END_REGEXP=/(\s|\(|^)[A-Z]\.$/,dt.NET_AT_BEGINNING_REGEXP=/^net\b/i,dt.SINGLE_UPPERCASE_LETTER_REGEXP=/^[A-Z]$/,dt.NON_ALPHANUMERIC_AT_BEGINNING_REGEXP=/^[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]{1,3}/i,dt.NON_ALPHANUMERIC_AT_END_REGEXP=/[^a-z0-9äöüßáàâéèêíìîóòôúùû\.\?\!,\:\;¿¡]{1,3}$/i,dt.HTML_ENTITIES=["amp","nbsp","gt","lt","bull","euro","copy","laquo","raquo","hellip","middot"],dt.HTML_ENTITIES_WITH_AND=dt.HTML_ENTITIES.map((e=>`&${e}`)),dt.WAVY_DASH_REGEXP=/^\u3030+$/,dt.ZWS_REGEXP=/^\uFEFF+$/,dt.ZWNJ_REGEXP=/\u200B|\u200C/g,dt.ZWS="\ufeff",dt.MID_SENTENCE_LINE_BREAK=/[\wáàâóòìíéèùúâôîêûäöüß,\)][\u0020\u00A0\uFEFF]*\n\n\n?[\u0020\u00A0\uFEFF"„»«“‘]*$/,dt.COMMON_TLDS=["com","co","org","net","de","info","biz","es","fr","be","in","gov","nl","ca","com.br","br","at","us","au","ru","pl","ly","it","cat","edu","jp","ko","cn","se","no","mil","ch","dk","com.mx","mx","eu","co.uk","uk","ir","cz","ua","kr","gr","tw","nz","co.nz","za","ro","vn","io","tr","me","fi","tv","xyz","pt","ie","app"],dt.COMMON_TLD_WITH_DOT_REGEXPS=dt.COMMON_TLDS.map((e=>new RegExp(`^\\.${e.replace(".","\\.")}\\b`,"i"))),dt.COMMON_FILE_TYPES=["jpeg","jpg","gif","png","bmp","indd","stl","svg","ai","sketch","ico","ics","env","amf","ps","psd","tiff","tif","mp3","wav","midi","mid","aif","mpa","ogg","wma","wpl","cda","7z","arj","deb","pkg","plist","rar","rpm","tar.gz","tar","zip","bin","dmg","iso","toast","vcd","csv","dat","db","log","mdb","sav","sql","xml","apk","bat","bin","cgi","com","exe","gadget","jar","py","js","jsx","json","wsf","ts","tsx","fnt","fon","otf","ttf","woff","woff2","rb","java","php","html","asp","aspx","cer","cfm","cgi","pl","css","scss","htm","jsp","part","rss","xhtml","key","odp","pps","ppt","pptx","class","cpp","cs","h","sh","swift","vb","ods","odt","xlr","xls","xlsx","xlt","xltx","bak","cab","cfg","cpl","cur","dll","dmp","msi","ini","tmp","3g2","3gp","avi","flv","h264","m4v","mkv","mov","mp4","mpg","mpeg","rm","swf","vob","wmv","doc","docx","dot","dotx","pdf","rtf","srx","text","tex","wks","wps","wpd","txt","yaml","yml","csl","md","adm"],dt.COMMON_FILE_TYPE_WITH_DOT_REGEXPS=dt.COMMON_FILE_TYPES.map((e=>new RegExp(`^[\\wáàâóòìíéèùúâôîêûäöüß\\-\\.\\(\\)]*?\\.${e}\\b`,"i"))),dt.FILE_TYPE_AT_BEGINNING_REGEXP=new RegExp(`(${dt.COMMON_FILE_TYPES.join("|")})\b`,"i"),dt.HIGH_LEVEL_GOALS=[{id:"professional",tags:["clarity","confident","formal","general","positive","professional"]},{id:"scientific",tags:["academic","clarity","formal","general","objective","povrem","scientific"]},{id:"persuasive",tags:["clarity","confident","general","persuasive","positive"]},{id:"personal",tags:["clarity","general","informal","positive","povadd"]},{id:"creative",tags:["clarity","general"]}],dt._textLevelAbortControllers=new Map,dt._paragraphLevelAbortControllers=new Map,dt._languageDetectionAbortControllers=new Map,dt._useFallbackServerForTextLevelRequests=!1,dt._useFallbackServerForParagraphLevelRequests=!1,dt._useFallbackServerForLanguageDetection=!1,dt._mainServerUnavailabilityTimeStamp=0,dt._checkForException=e=>e.ok?e:e.text().catch((()=>"")).then((t=>{const n=t.toLowerCase();if(n.includes("too many error"))throw{reason:"TooManyErrors",status:e.status,response:t};if(413===e.status||n.includes("text exceeds the limit"))throw{reason:"TextTooLong",status:e.status,response:t};if(t.toLowerCase().includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};if(429===e.status)throw{reason:"TooManyRequests",status:e.status,response:t};if(403===e.status){if(n.includes("client request size limit")||n.includes("client request limit")||n.includes("ip request limit")||n.includes("ip request size limit"))throw{reason:"TooManyRequests",status:e.status,response:t};if(n.includes("authexception"))throw{reason:"InvalidCredentials",status:e.status,response:t};throw{reason:"AccessDenied",status:e.status,response:t}}if(n.includes("checking took longer than"))throw{reason:"TimeoutError",status:e.status,url:e.url?e.url.replace(/\?.*/,"?..."):"unknown",response:t};throw{reason:"UnknownError",status:e.status,response:t}}));
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ht{constructor(){this._eventHandlers=new Map}subscribe(e,t){this._eventHandlers.has(e)||this._eventHandlers.set(e,[]),this._eventHandlers.get(e).push(t)}fire(e,t){const n=this._eventHandlers.get(e);n&&n.forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}destroy(){this._eventHandlers.clear()}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class mt{static get LANGUAGES(){return this._languages||(this._languages=[{code:"ar",name:et.getMessage("ar")},{code:"ast-es",name:et.getMessage("ast")},{code:"be-by",name:et.getMessage("be")},{code:"br-fr",name:et.getMessage("br")},{code:"ca-es",name:et.getMessage("ca")},{code:"ca-es-valencia",name:et.getMessage("ca_ES_valencia")},{code:"da-dk",name:et.getMessage("da_DK")},{code:"de-at",name:et.getMessage("de_AT")},{code:"de-ch",name:et.getMessage("de_CH")},{code:"de-de",name:et.getMessage("de_DE")},{code:"el-gr",name:et.getMessage("el")},{code:"en-au",name:et.getMessage("en_AU")},{code:"en-ca",name:et.getMessage("en_CA")},{code:"en-gb",name:et.getMessage("en_GB")},{code:"en-nz",name:et.getMessage("en_NZ")},{code:"en-us",name:et.getMessage("en_US")},{code:"en-za",name:et.getMessage("en_ZA")},{code:"eo",name:et.getMessage("eo")},{code:"es",name:et.getMessage("es")},{code:"fa",name:et.getMessage("fa")},{code:"ga-ie",name:et.getMessage("ga")},{code:"fr",name:et.getMessage("fr")},{code:"gl-es",name:et.getMessage("gl")},{code:"it",name:et.getMessage("it")},{code:"ja-jp",name:et.getMessage("ja")},{code:"km-kh",name:et.getMessage("km")},{code:"nl",name:et.getMessage("nl")},{code:"no",name:et.getMessage("no")},{code:"pl-pl",name:et.getMessage("pl")},{code:"pt-ao",name:et.getMessage("pt_AO")},{code:"pt-br",name:et.getMessage("pt_BR")},{code:"pt-mz",name:et.getMessage("pt_MZ")},{code:"pt-pt",name:et.getMessage("pt_PT")},{code:"ro-ro",name:et.getMessage("ro")},{code:"ru-ru",name:et.getMessage("ru")},{code:"sk-sk",name:et.getMessage("sk")},{code:"sl-si",name:et.getMessage("sl")},{code:"sv",name:et.getMessage("sv")},{code:"ta-in",name:et.getMessage("ta")},{code:"tl-ph",name:et.getMessage("tl")},{code:"uk-ua",name:et.getMessage("uk")},{code:"zh-cn",name:et.getMessage("zh")}],this._languages.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),this._isSubscribed||(et.addEventListener(Qe.eventNames.localeChanged,(()=>this._languages=null)),this._isSubscribed=!0)),this._languages}static isLanguageVariant(e){return e.code.includes("-")}static getPrimaryLanguageCode(e){return e.split("-")[0]}static formatLanguageCode(e){const t=e.split("-");return 1===t.length?t[0]:2===t.length?t[0]+"-"+t[1].toUpperCase():t[0]+"-"+t[1].toUpperCase()+"-"+t[2]}static getUserLanguageCode(){for(const e of navigator.languages){if(e.includes("-")&&e.startsWith(navigator.language))return e}return navigator.language}static getUserLanguageCodes(){const e=Array.from(navigator.languages,(e=>this.getPrimaryLanguageCode(e).toLowerCase()));try{e.push(this.getPrimaryLanguageCode(s.getUILanguageCode()).toLowerCase())}catch(e){}return Me(e)}static getPreferredLanguageVariant(e){const t={"en-in":"en-us","en-ie":"en-gb"},n=navigator.languages||[];for(let r of n){r=r.toLowerCase(),r=t[r]||r;for(const t of e){const e=t.toLowerCase();if(r.length>2&&r===e)return t}}return null}static getLanguagesForGeoIPCountry(){return new Promise((function(e,t){let n=!1;const r=self.setTimeout((()=>{n=!0,t(new Error("geoip timeout"))}),15e3);fetch("https://languagetool.org/webextension/init",{method:"GET",mode:"cors"}).then((e=>e.json())).then((t=>{if(!n){const n=(t.geoIpCountry||"").toUpperCase();e({geoIpLanguages:t.geoIpLanguages||[],geoIpCountry:n}),clearTimeout(r)}})).catch((e=>{console.error(e),n||(t(e),clearTimeout(r))}))}))}static getSynonymsRequestLanguage(e){let t=this.getPrimaryLanguageCode(e);return"de-ch"===e.toLowerCase()?t="de-CH":"pt-br"===e.toLowerCase()&&(t="pt-BR"),re.includes(t)?t:null}}mt._languages=null,mt._isSubscribed=!1,mt.ALL_LANGUAGES=[{code:"af",name:"Afrikaans"},{code:"ak",name:"Akan"},{code:"am",name:"አማርኛ"},{code:"an",name:"aragonés"},{code:"ar",name:"عربي"},{code:"as",name:"অসমীয়া"},{code:"ast",name:"Asturianu"},{code:"be",name:"Беларуская"},{code:"bg",name:"Български"},{code:"bm",name:"Bamanankan"},{code:"bn",name:"বাংলা"},{code:"br",name:"Brezhoneg"},{code:"bs",name:"босански"},{code:"ca",name:"Català"},{code:"cs",name:"čeština"},{code:"cy",name:"Cymraeg"},{code:"da",name:"Dansk"},{code:"de",name:"Deutsch"},{code:"el",name:"Ελληνικά"},{code:"en",name:"English"},{code:"eo",name:"Esperanto"},{code:"es",name:"Español"},{code:"et",name:"Eesti keel"},{code:"eu",name:"Euskara"},{code:"fa",name:"فارسی"},{code:"fi",name:"suomi"},{code:"fj",name:"Vosa vaka-Viti"},{code:"fr",name:"Français"},{code:"ga",name:"Gaeilge"},{code:"gd",name:"Gàidhlig"},{code:"gl",name:"Galego"},{code:"gn",name:"Avañe'ẽ"},{code:"gu",name:"ગુજરાતી"},{code:"ha",name:"هَرْشَن هَوْسَ‎"},{code:"he",name:"עברית"},{code:"hi",name:"हिन्दी"},{code:"hr",name:"hrvatski"},{code:"hu",name:"magyar"},{code:"hy",name:"Հայերեն"},{code:"ia",name:"Interlingua"},{code:"id",name:"Bahasa Indonesia"},{code:"ig",name:"Ásụ̀sụ̀ Ìgbò"},{code:"is",name:"íslenska"},{code:"it",name:"Italiano"},{code:"ja",name:"日本語"},{code:"kk",name:"Қазақ"},{code:"km",name:"ខ្មែរ"},{code:"kn",name:"ಕನ್ನಡ"},{code:"ko",name:"한국어"},{code:"ku",name:"Kurdî"},{code:"ks",name:"كشمیری"},{code:"la",name:"Latina"},{code:"lg",name:"Luganda"},{code:"lo",name:"ພາສາລາວ"},{code:"lt",name:"Lietuvių"},{code:"lv",name:"Latviešu"},{code:"mg",name:"malagasy"},{code:"mi",name:"Māori"},{code:"ml",name:"മലയാളം"},{code:"mk",name:"Македонски"},{code:"mn",name:"Монгол"},{code:"mr",name:"मराठी"},{code:"ms",name:"Melayu"},{code:"my",name:"မြန်မာဘာသာ"},{code:"nb",name:"Norsk bokmål"},{code:"ne",name:"नेपाली"},{code:"nn",name:"Norsk nynorsk"},{code:"no",name:"Norsk"},{code:"nl",name:"Nederlands"},{code:"nr",name:"isiNdebele"},{code:"oc",name:"Occitano"},{code:"or",name:"ଓଡ଼ିଆ"},{code:"pa",name:"ਪੰਜਾਬੀ"},{code:"pl",name:"Polski"},{code:"ps",name:"پښتو"},{code:"pt",name:"Português"},{code:"rm",name:"rumantsch"},{code:"ro",name:"românesc"},{code:"ru",name:"Русский"},{code:"rw",name:"Ikinyarwanda"},{code:"sa",name:"संस्कृत"},{code:"si",name:"සිංහල"},{code:"sk",name:"slovenčina"},{code:"sl",name:"Slovenščina"},{code:"so",name:"Soomaali"},{code:"sr",name:"Српски"},{code:"ss",name:"siSwati"},{code:"st",name:"Sesotho"},{code:"sv",name:"Svenska"},{code:"ta",name:"தமிழ்"},{code:"te",name:"తెలుగు"},{code:"th",name:"ภาษาไทย"},{code:"tl",name:"Tagalog"},{code:"fil",name:"Filipino"},{code:"tr",name:"Türkçe"},{code:"ts",name:"Xitsonga"},{code:"tt",name:"Tatarça"},{code:"uk",name:"Українська"},{code:"ur",name:"اُردو"},{code:"uz",name:"Oʻzbek tili"},{code:"ve",name:"Tshivenḓa"},{code:"vi",name:"Tiếng Việt"},{code:"yo",name:"عِدعِ يوْرُبا"},{code:"zh",name:"中文"},{code:"zu",name:"isiZulu"}],mt.POPULAR_LANGUAGES=["de","en","es","fr","nl","pl","pt","ru","uk","zh","it","hi"];
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var _t=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};class Et{static get DEFAULT_SETTINGS(){return null===this.DEFAULT_SETTINGS_CACHED&&(this.DEFAULT_SETTINGS_CACHED={apiServerUrl:C,autoCheck:!0,knownEmail:"",username:"",password:"",token:"",userId:null,dpaLevel:0,motherTongue:"",geoIpLanguages:[],geoIpCountry:"",preferredLanguages:[],enVariant:mt.getPreferredLanguageVariant(["en-US","en-GB","en-AU","en-CA","en-NZ","en-ZA"])||"en-US",deVariant:mt.getPreferredLanguageVariant(["de-DE","de-AT","de-CH"])||"de-DE",ptVariant:mt.getPreferredLanguageVariant(["pt-PT","pt-BR","pt-MZ","pt-AO"])||"pt-BR",caVariant:"ca-ES",dictionary:[],hasSynonymsEnabled:!1,hasPickyModeEnabledGlobally:!1,openCardHotkey:"",isDictionarySynced:!1,ignoredRules:[],disabledDomains:[],disabledEditorGroups:[],disabledDomainsCapitalization:[],ignoreCheckOnDomains:[],autoCheckOnDomains:[],remainingRephrasingsAmount:null,remainingRephrasingsDate:null,hasRephrasingEnabled:!0}),this.DEFAULT_SETTINGS_CACHED}static _combineObjects(e,t){const n=Ge(e);for(const e in n)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}static _dec2hex(e){return("0"+e.toString(16)).substr(-2)}static _generateUniqueId(){const e=new Uint8Array(8);return crypto.getRandomValues(e),Array.from(e,Et._dec2hex).join("")}static _normalizeDomain(e=""){return e.toLowerCase().trim().replace(/^www\./,"")}static _isListContainsDomain(e,t){const n=Et._normalizeDomain(t);return(e||[]).some((e=>{const t=Et._normalizeDomain(e);return t===n||n.endsWith("."+t)}))}static getDefaultSettings(){return Ge(Et.DEFAULT_SETTINGS)}static getDefaultPrivacySettings(){return ke(Et.DEFAULT_PRIVACY_SETTINGS)}constructor(){this._eventBus=new ht,this._onReadyCallbacks=[]}addEventListener(e,t){this._eventBus.subscribe(e,t)}disableDomain(e){const t=Et._normalizeDomain(e),n=this.getSettings(),r="object"==typeof n.disabledDomains?n.disabledDomains:[];return r.push(t),this.updateSettings({disabledDomains:r})}enableDomain(e){const t=Et._normalizeDomain(e),n=this.getSettings();let r="object"==typeof n.disabledDomains?n.disabledDomains:[];return r=r.filter((e=>{const n=Et._normalizeDomain(e);return n!==t&&!t.endsWith("."+n)})),this.updateSettings({disabledDomains:r})}disableEditorGroup(e,t){const n=Et._normalizeDomain(e),r=this.getSettings(),s="object"==typeof r.disabledEditorGroups?r.disabledEditorGroups:[];return s.push({domain:n,editorGroupId:t}),this.updateSettings({disabledEditorGroups:s})}enableEditorGroup(e,t){const n=Et._normalizeDomain(e),r=this.getSettings();let s="object"==typeof r.disabledEditorGroups?r.disabledEditorGroups:[];const i=s.filter((e=>!(e.domain===n&&e.editorGroupId===t)));return i.length!==s.length?this.updateSettings({disabledEditorGroups:i}):Promise.resolve()}enableDomainAndEditorGroup(e,t){return this.getCheckSettings(e,t).isEditorGroupDisabled&&this.enableEditorGroup(e,t),this.enableDomain(e)}disableCapitalization(e){const t=Et._normalizeDomain(e),n=this.getSettings(),r="object"==typeof n.disabledDomainsCapitalization?n.disabledDomainsCapitalization:[];return r.push(t),this.updateSettings({disabledDomainsCapitalization:r})}enableCapitalization(e){const t=Et._normalizeDomain(e),n=this.getSettings();let r="object"==typeof n.disabledDomainsCapitalization?n.disabledDomainsCapitalization:[];return r=r.filter((e=>{const n=Et._normalizeDomain(e);return n!==t&&!t.endsWith("."+n)})),this.updateSettings({disabledDomainsCapitalization:r})}grantUnlimitedRephrasings(){return this.updateSettings({remainingRephrasingsAmount:null,remainingRephrasingsDate:null})}restrictRephrasings(){const{remainingRephrasingsAmount:e,remainingRephrasingsDate:t}=this.getSettings();return this.updateSettings({remainingRephrasingsAmount:null!=e?e:he,remainingRephrasingsDate:t||(new Date).toISOString()})}enablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!0})}disablePaidSubscription(){return this.updateUIState({hasPaidSubscription:!1})}getIgnoredRuleIds(){return this.getSettings().ignoredRules.map((e=>e.id))}hasIgnoredRule(e){return this.getIgnoredRuleIds().includes(e)}addIgnoredRule(e){const{ignoredRules:t}=this.getSettings();this.hasIgnoredRule(e.id)||this.updateSettings({ignoredRules:[...t,e]})}removeIgnoredRule(e){return _t(this,void 0,void 0,(function*(){if(this.hasIgnoredRule(e)){const t=this.getSettings().ignoredRules.filter((t=>t.id!==e));yield this.updateSettings({ignoredRules:t})}}))}destroy(){this._eventBus.destroy(),this._onReadyCallbacks=[]}}Et.eventNames={settingsChanged:"lt-storageController.settingsChanged",userCredentialsChanged:"lt-storageController.userCredentialsChanged",configurationChanged:"lt-storageController.configurationChanged",privacySettingsChanged:"lt-storageController.privacySettingsChanged",uiStateChanged:"lt-storageController.uiStateChanged"},Et.DEFAULT_SETTINGS_CACHED=null,Et.DEFAULT_MANAGED_SETTINGS={apiServerUrl:"",loginUrl:"",disablePrivacyConfirmation:!1,disablePersonalDictionary:!1,disableIgnoredRules:!1},Et.DEFAULT_CONFIGURATION={unsupportedDomains:[]},Et.DEFAULT_PRIVACY_SETTINGS={allowRemoteCheck:!1,confirmedGPT3:!1},Et.DEFAULT_STATISTICS={usageCount:0,sessionCount:0,appliedSuggestions:0,appliedSynonyms:0,hiddenErrors:[],firstVisit:null,lastActivity:null,ratingValue:null,premiumClicks:0,campaign:null,userActivityStates:{}},Et.DEFAULT_UI_STATE={hasSeenPrivacyConfirmationDialog:!1,hasPaidSubscription:!1,hasRated:!1,hasUsedValidator:!1,hasSeenOnboarding:!1,isNewUser:!1,hasSeenNewOverleafTeaser:!1,hasSeenNewGoogleDocsTeaser:!1,hasSeenNewGoogleSlidesTeaser:!1,hasSeenGoogleDocsMenuBarHint:!1,lastChangelogNov2022Seen:null,changelogNov2022CountdownEnd:null,changelogNov2022Coupon:null,showRuleId:!1,dialogPosition:"default",countMode:"characters",hasSeenTurnOnMessagePopup:!1,isDarkModeEnabled:!1},Et.DEFAULT_TEST_FLAGS={enableQuillBot:null,enableGGec:null};class pt{static init(e){this._instanceCtor=e}static create(){return this._instanceCtor()}}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class ft extends Et{static _getStringSize(...e){let t=0;for(const n of e)for(let e=0;e<n.length;e++){const r=n.charCodeAt(e);t+=r<128?1:r<2048?2:r<65536?3:r<1<<21?4:r<1<<26?5:r<1<<31?6:Number.NaN}return t}static _getStorage(){const e=Je();return e.storage.sync&&!t.isFirefox()?e.storage.sync:e.storage.local}static _getManagedStorage(){return Je().storage.managed}constructor(){super(),this._onStoredDataChanged=(e,t)=>{const n=["username","token"].filter((t=>e.hasOwnProperty(t)&&e[t].oldValue!==e[t].newValue)),r=[],s=[];for(const e of ft.SETTINGS_CHUNKED_PROPERTIES)r.push(!1),s.push(new RegExp(`^${e}(_\\d+)?$`));let i=!1,a=!1,o=!1,c=!1;for(const n in e)if("managed"!==t){for(let e=0;e<ft.SETTINGS_CHUNKED_PROPERTIES.length;e++)if(s[e].test(n)){r[e]=!0;break}if(this._settings&&Et.DEFAULT_SETTINGS.hasOwnProperty(n)&&!ft.SETTINGS_CHUNKED_PROPERTIES.includes(n)){const t=!("oldValue"in e[n])&&Et.DEFAULT_SETTINGS[n]===e[n].newValue,r=e[n].oldValue!==e[n].newValue;this._settings[n]=e[n].newValue,i=!1===t&&r}this._configuration&&Et.DEFAULT_CONFIGURATION.hasOwnProperty(n)&&(this._configuration[n]=e[n].newValue,a=!0),this._privacySettings&&Et.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(n)&&(this._privacySettings[n]=e[n].newValue,o=!0),this._statistics&&Et.DEFAULT_STATISTICS.hasOwnProperty(n)&&(this._statistics[n]=e[n].newValue),this._uiState&&Et.DEFAULT_UI_STATE.hasOwnProperty(n)&&(this._uiState[n]=e[n].newValue,c=!0),this._testFlags&&Et.DEFAULT_TEST_FLAGS.hasOwnProperty(n)&&(this._testFlags[n]=e[n].newValue),"uniqueId"===n&&(this._uniqueId=e[n].newValue)}else this._managedSettings&&Et.DEFAULT_MANAGED_SETTINGS.hasOwnProperty(n)&&(this._managedSettings[n]=e[n].newValue);i&&(this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(Et.eventNames.settingsChanged,e)),n.length&&this._eventBus.fire(Et.eventNames.userCredentialsChanged,n.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{})),r.some((e=>e))&&this._storage.get().then((e=>{if(!this._settings)return;const t={};for(let n=0;n<ft.SETTINGS_CHUNKED_PROPERTIES.length;n++)if(r[n]){const r=ft.SETTINGS_CHUNKED_PROPERTIES[n],s=this._joinChunks(e,r);t[r]={oldValue:this._settings[r],newValue:s},this._settings[r]=s}this._ensureIgnoredRuleTurnOffDate(),this._eventBus.fire(Et.eventNames.settingsChanged,t)})),a&&this._eventBus.fire(Et.eventNames.configurationChanged,e),o&&this._eventBus.fire(Et.eventNames.privacySettingsChanged,e),c&&this._eventBus.fire(Et.eventNames.uiStateChanged,e)},this._storage=ft._getStorage(),this._managedStorage=ft._getManagedStorage(),this._isInitialized=!1,this._loadData(),Je().storage.onChanged.addListener(this._onStoredDataChanged)}_splitInChunks(e,t,n=this._storage.QUOTA_BYTES_PER_ITEM){let r=e[t];if(!r)return;let s=0,i=[],a=ft._getStringSize(t,"[]");for(;r.length;){const o=r.shift(),c=JSON.stringify(o),l=ft._getStringSize(`,${c}`);if(a+l<=n)i.push(o),a+=l;else{e[0===s?t:`${t}_${s}`]=i,s++,i=[o],a=ft._getStringSize(`${t}_${s}`,`[${c}]`)}if(0===r.length){e[0===s?t:`${t}_${s}`]=i}}e[`${t}_${s+1}`]=[]}_joinChunks(e,t,n=this._storage.MAX_ITEMS){let r=e[t]||[];for(let s=1;s<n;s++){const n=e[`${t}_${s}`];if(void 0===n||0===n.length)break;r=r.concat(n)}return r}_loadData(){const e=this._storage.get().then((e=>{const t=Et._combineObjects(Et.DEFAULT_SETTINGS,e);for(const n of ft.SETTINGS_CHUNKED_PROPERTIES)t[n]=this._joinChunks(e,n);for(const e of t.ignoredRules){if(void 0===e.description){const t=Et.DEFAULT_SETTINGS.ignoredRules.find((t=>t.id===e.id&&t.language===e.language));e.description=t?t.description:""}if(void 0===e.turnOffDate){const t=Et.DEFAULT_SETTINGS.ignoredRules.some((t=>t.id===e.id&&t.language===e.language));e.turnOffDate=t?null:new Date(2019,9,1)}else null!==e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}t.disabledDomains=t.disabledDomains.map((e=>Ve(e,""))).filter((e=>e)),t.ignoreCheckOnDomains=t.ignoreCheckOnDomains.map((e=>Ve(e,""))).filter((e=>e)),t.autoCheckOnDomains=t.autoCheckOnDomains.map((e=>Ve(e,""))).filter((e=>e)),this._settings=t,this._configuration=Et._combineObjects(Et.DEFAULT_CONFIGURATION,e),this._privacySettings=Et._combineObjects(Et.DEFAULT_PRIVACY_SETTINGS,e),this._statistics=Et._combineObjects(Et.DEFAULT_STATISTICS,e),this._uiState=Et._combineObjects(Et.DEFAULT_UI_STATE,e),this._testFlags=Et._combineObjects(Et.DEFAULT_TEST_FLAGS,e),e.uniqueId?this._uniqueId=e.uniqueId:(this._uniqueId=Et._generateUniqueId(),this._storage.set({uniqueId:this._uniqueId})),this._statistics.firstVisit||this.updateStatistics({firstVisit:Math.round(Date.now()/1e3)})})),t=this._managedStorage.get().then((e=>{this._managedSettings=Et._combineObjects(Et.DEFAULT_MANAGED_SETTINGS,e)})).catch((()=>{this._managedSettings=Et._combineObjects(Et.DEFAULT_MANAGED_SETTINGS,{})}));Promise.all([e,t]).then((()=>{this._isInitialized=!0,this._onReadyCallbacks.forEach((e=>e(this))),this._onReadyCallbacks=[]}))}_ensureIgnoredRuleTurnOffDate(){if(this._settings)for(const e of this._settings.ignoredRules)e.turnOffDate&&"string"==typeof e.turnOffDate&&(e.turnOffDate=new Date(e.turnOffDate))}isReady(){return this._isInitialized}onReady(e){this._isInitialized?e(this):this._onReadyCallbacks.push(e)}getUniqueId(){return this._uniqueId}getSettings(){return Ge(this._settings)}updateSettings(e){for(const t in e)if(!Et.DEFAULT_SETTINGS.hasOwnProperty(t))throw new Error(`Unknown setting ${t}`);if(Object.assign(this._settings||{},Ge(e)),void 0!==e.ignoredRules)for(const t of e.ignoredRules)t.turnOffDate&&"string"!=typeof t.turnOffDate&&(t.turnOffDate=t.turnOffDate.toISOString());if(!t.isFirefox()&&!t.isThunderbird()){e=Ge(e);for(let t=0;t<ft.SETTINGS_CHUNKED_PROPERTIES.length;t++){const n=ft.SETTINGS_CHUNKED_PROPERTIES[t];void 0!==e[n]&&this._splitInChunks(e,n)}}return this._storage.set(e)}getCheckSettings(e,t){if(!this._settings)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0,shouldCapitalizationBeChecked:!0};if(e===Je().runtime.id)return{isDomainDisabled:!1,isEditorGroupDisabled:!1,isAutoCheckEnabled:!0,shouldCapitalizationBeChecked:!0};const n=(this._settings.disabledEditorGroups||[]).some((n=>Et._normalizeDomain(n.domain)===Et._normalizeDomain(e)&&n.editorGroupId===t)),r=Et._isListContainsDomain(this._settings.disabledDomains,e),s=!Et._isListContainsDomain(this._settings.disabledDomainsCapitalization,e);if(this._settings.autoCheck){return{isDomainDisabled:r,isEditorGroupDisabled:n,isAutoCheckEnabled:!Et._isListContainsDomain(this._settings.ignoreCheckOnDomains,e),shouldCapitalizationBeChecked:s}}return{isDomainDisabled:r,isEditorGroupDisabled:n,isAutoCheckEnabled:Et._isListContainsDomain(this._settings.autoCheckOnDomains,e),shouldCapitalizationBeChecked:s}}hasLanguageToolAccount(){return Boolean(this._settings&&this._settings.username&&!this.hasCustomServer())}hasCustomServer(){return this._managedSettings&&this._managedSettings.apiServerUrl?this._managedSettings.apiServerUrl!==Et.DEFAULT_SETTINGS.apiServerUrl:Boolean(this._settings&&this._settings.apiServerUrl&&this._settings.apiServerUrl.trim()&&this._settings.apiServerUrl!==C&&this._settings.apiServerUrl!==R)}getCustomServerUrl(){if(this.hasCustomServer())return this._managedSettings.apiServerUrl||this._settings.apiServerUrl}getManagedSettings(){return ke(this._managedSettings)}getConfiguration(){return ke(this._configuration)}updateConfiguration(e){for(const t in e)if(!Et.DEFAULT_CONFIGURATION.hasOwnProperty(t))throw new Error(`Unknown configuration ${t}`);return Object.assign(this._configuration||{},ke(e)),this._storage.set(e)}isDomainSupported(e){return!this._configuration||!this._configuration.unsupportedDomains.includes("*")&&!Et._isListContainsDomain(this._configuration.unsupportedDomains,e)}getPrivacySettings(){return ke(this._privacySettings)}updatePrivacySettings(e){for(const t in e)if(!Et.DEFAULT_PRIVACY_SETTINGS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return Object.assign(this._privacySettings||{},e),this._storage.set(e)}getStatistics(){return Ge(this._statistics)}updateStatistics(e){for(const t in e)if(!Et.DEFAULT_STATISTICS.hasOwnProperty(t))throw new Error(`Unknown privacy setting ${t}`);return Object.assign(this._statistics||{},e),this._storage.set(e)}getUIState(){return Ge(this._uiState)}updateUIState(e){for(const t in e)if(!Et.DEFAULT_UI_STATE.hasOwnProperty(t))throw new Error(`Unknown UI state ${t}`);return Object.assign(this._uiState||{},e),this._storage.set(e)}checkForPaidSubscription(){return new Promise(((e,t)=>{this.onReady((()=>{const{username:n,password:r,token:s}=this.getSettings();let i;this.hasCustomServer()&&(i=this.getCustomServerUrl()),dt.checkForPaidSubscription(n,r,s,i).then((t=>{t?(this.enablePaidSubscription(),this.grantUnlimitedRephrasings()):(this.disablePaidSubscription(),this.restrictRephrasings()),e(t)})).catch(t)}))}))}getTestFlags(){return ke(this._testFlags)}updateTestFlags(e){for(const t in e)if(!Et.DEFAULT_TEST_FLAGS.hasOwnProperty(t))throw new Error(`Unknown test flag ${t}`);return Object.assign(this._testFlags||{},e),this._storage.set(e)}getActiveCoupon(){const{changelogNov2022CountdownEnd:e,changelogNov2022Coupon:t,hasPaidSubscription:n}=this.getUIState();if(n)return null;if(e&&t&&Date.now()<e){const n=20,{geoIpCountry:r}=this.getSettings(),s=this._getDefaultCoupon(r);return s&&s.percent>n?Object.assign(Object.assign({},s),{expires:e}):{code:t,expires:e,percent:n}}return null}_getDefaultCoupon(e){for(const t in se)if(se.hasOwnProperty(t)&&se[t].countries.includes(e))return{code:t,percent:se[t].percent};return null}isRelevantForChangelogCoupon(){if(this.hasCustomServer())return{status:!1,reason:1};const{geoIpCountry:e}=this.getSettings();if("RU"===e)return{status:!1,reason:2};const{hasPaidSubscription:t}=this.getUIState();if(t)return{status:!1,reason:3};let{firstVisit:n,appliedSuggestions:r}=this.getStatistics();if(!n)return{status:!1,reason:4};n*=1e3;return Date.now()-n<6048e5?{status:!1,reason:5}:r<8?{status:!1,reason:6}:{status:!0}}startChangelogCoupon(){if(!this.canStartChangelogCoupon())return;const e=Date.now();var t,n;this.updateUIState({changelogNov2022Coupon:"2022-NOV-CHANGELOG",changelogNov2022CountdownEnd:e+1656e5+(t=0,n=72e5,t=Math.ceil(t),n=Math.floor(n),Math.floor(Math.random()*(n-t+1))+t)})}isChangelogCouponRunning(){if(!this.isRelevantForChangelogCoupon().status)return!1;const{changelogNov2022CountdownEnd:e}=this.getUIState();return Boolean(e&&e>Date.now())}canStartChangelogCoupon(){if(!this.isRelevantForChangelogCoupon().status)return!1;const e=Date.now(),{changelogNov2022CountdownEnd:t}=this.getUIState();return!t||e-t>ie}destroy(){this._isInitialized=!1,super.destroy();try{Je().storage.onChanged.removeListener(this._onStoredDataChanged)}catch(e){}}}ft.SETTINGS_CHUNKED_PROPERTIES=t.isSafari()?[]:["dictionary","ignoredRules","disabledDomains","disabledDomainsCapitalization","disabledEditorGroups","ignoreCheckOnDomains","autoCheckOnDomains"];class At{static getOrCreateShadow(e){let t=document.querySelector("lt-container");if(t||(t=document.createElement("lt-container"),document.documentElement.appendChild(t)),!t.shadowRoot)try{t.attachShadow({mode:"open"})}catch(e){}let n=t.shadowRoot.querySelector("slot");var r;return n||(n=document.createElement("slot"),t.shadowRoot.append(n)),r=t.shadowRoot,["content/styles/shadow.css"].forEach((e=>{const t=Je().runtime.getURL(e);if(!r.querySelector(`[href="${t}"]`)){const e=document.createElement("link");e.href=t,e.rel="stylesheet",r.append(e)}})),{root:t.shadowRoot,slot:n}}static isComposer(e){return function(e){return location.href.startsWith("about:blank?compose")&&"BODY"===e.tagName&&"on"===document.designMode}(e)}static registerComposeScripts(){const e=Je(),t=e.composeScripts;if(t){const n=[],r=[],s=e.runtime.getURL("");e.runtime.getManifest().content_scripts.forEach((e=>{e.js&&e.js.forEach((e=>{n.push({file:e.replace(s,"")})})),e.css&&e.css.forEach((e=>{r.push({file:e.replace(s,"")})}))})),t.register({css:r,js:n})}}static setNativeSpellCheck(e){const t=Je().spellcheck;t&&t.setValue(e)}}At.COMPOSE_URL="about:blank?compose",At.COMPOSE_URL_REGEXP=/^about:blank\?compose/;
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class St{static init(){if(St._isInitialized)return;this.TRACKING_SITE_ID=s.getTrackingId(),this.VERSION=s.getVersion(),this._storageController=pt.create();const e=s.getURL("/");self.addEventListener("error",(t=>{const n=t.message,r=t.filename,s=t.lineno,i=t.error;if(!r||!r.startsWith(e))return;if("string"!=typeof n)return;if(n.includes("ResizeObserver"))return;const a=i&&function(e){if(!e.stack)return;let t=[];if(e.stack.split(/\n/).forEach((e=>{const n=e.match(/([\w_<>]+)\s+\(.+?([\w_\-]+\.(js|html))/);n&&t.push(`${n[2]}:${n[1]}`)})),!t.length){const n=e.stack.match(/([\w_\-]+\.(js|html))/);n&&t.push(n[1])}return t.join(",").substr(0,140)}(i);a?St.trackError("js",n,a):St.trackError("js",n,`${r}:${s}`)})),St._isInitialized=!0,this.trackActiveAfterOneWeek()}static getCustomDimensions(e){const t=St._storageController.getSettings(),n=St._storageController.getUIState(),r=St._storageController.getTestFlags(),s={dimension2:this.VERSION,dimension3:String(n.hasPaidSubscription),dimension4:String(Boolean(t.username&&(t.password||t.token))),dimension5:t.preferredLanguages.join(","),dimension6:String(t.hasPickyModeEnabledGlobally),dimension7:String(r.enableQuillBot),dimension10:String(r.enableGGec)};return(null==e?void 0:e.writingGoal)&&(s.dimension8=e.writingGoal),(null==e?void 0:e.errorType)&&(s.dimension9=e.errorType),s}static _getTrackingUrlForPageView(e,t){return e=(e=e.replace(/^(chrome|moz|safari|edge)-extension:\/\/.+?\//i,"")).replace(/^[a-z0-9]{8}\//i,"/"),e=`${St.TRACKING_BASE_PAGE_URL}${e}`,new Promise(((n,r)=>{St._storageController.onReady((()=>{var r,s,i,a;const{firstVisit:o,sessionCount:c}=St._storageController.getStatistics(),l=St._storageController.getUniqueId(),u=new URL(St.TRACKING_BASE_URL),g=[null!==(s=null===(r=self.screen)||void 0===r?void 0:r.width)&&void 0!==s?s:0,null!==(a=null===(i=self.screen)||void 0===i?void 0:i.height)&&void 0!==a?a:0],d=Object.assign({idsite:St.TRACKING_SITE_ID,rec:"1",url:e,rand:String(Date.now()),apiv:"1",res:g.join("x"),_id:String(l),_idts:String(o),_idvc:String(c)},this.getCustomDimensions(t));for(const[e,t]of Object.entries(d))u.searchParams.append(e,t);n(u.toString())}))}))}static _getTrackingUrlForEvent(e,t,n="",r,s){return r=r||St.TRACKING_BASE_PAGE_URL,new Promise(((i,a)=>{St._storageController.onReady((()=>{var a,o,c,l;const{firstVisit:u,sessionCount:g}=St._storageController.getStatistics(),d=St._storageController.getUniqueId(),h=new URL(St.TRACKING_BASE_URL),m=[null!==(o=null===(a=self.screen)||void 0===a?void 0:a.width)&&void 0!==o?o:0,null!==(l=null===(c=self.screen)||void 0===c?void 0:c.height)&&void 0!==l?l:0],_=Object.assign({idsite:St.TRACKING_SITE_ID,rec:"1",url:r||"",action_name:t,rand:String(Date.now()),apiv:"1",res:m.join("x"),_id:d,_idts:String(u),_idvc:String(g),e_c:e,e_a:t,e_n:null!=n?n:""},this.getCustomDimensions(s));for(const[e,t]of Object.entries(_))h.searchParams.append(e,t);i(h.toString())}))}))}static _sendRequest(e){!s.shouldTrack()||St._storageController.hasCustomServer()||navigator.webdriver||Ke(e,{mode:"no-cors",referrerPolicy:"no-referrer",keepalive:"standalone"===s.getType()},1e4).catch((()=>null))}static trackPageView(e,t){e=e||He(),St._getTrackingUrlForPageView(e,t).then((t=>{s.isProductionEnvironment()?St._sendRequest(t):console.log("LT Page view tracking disabled in dev mode",{pageUrl:e,trackingUrl:t})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}static trackDisabledRule(e,t,n,r){if(!e.match(/^de|en|nl|es|fr|ca|pt/i))return;const i=r?ae.PREMIUM:ae.BASIC,a=e+":"+t,o=n,c=new URL(St.TRACKING_BASE_URL);c.searchParams.append("idsite","18"),c.searchParams.append("rec","1"),c.searchParams.append("url",St.TRACKING_BASE_PAGE_URL),c.searchParams.append("action_name",i),c.searchParams.append("rand",String(Date.now())),c.searchParams.append("apiv","1"),c.searchParams.append("_id",this._storageController.getUniqueId()),c.searchParams.append("e_c",i),c.searchParams.append("e_a",a),c.searchParams.append("e_n",n),s.isProductionEnvironment()?this._sendRequest(c.toString()):console.log("LT Event tracking disabled in dev mode",{actionCategory:i,action:a,actionName:o,trackingUrl:c})}static trackDictionaryEvent(e,t,n=!1){if(!e.match(/^de|en|nl|es|fr|it|pt|ru|ca|pl/i))return;const r=n?"TemporaryIgnored":"PersistentlyIgnored",i=`${e}:add_word`,a=t,o=new URL(St.TRACKING_BASE_URL);o.searchParams.append("idsite","19"),o.searchParams.append("rec","1"),o.searchParams.append("url",St.TRACKING_BASE_PAGE_URL),o.searchParams.append("action_name",r),o.searchParams.append("rand",String(Date.now())),o.searchParams.append("apiv","1"),o.searchParams.append("_id",this._storageController.getUniqueId()),o.searchParams.append("e_c",r),o.searchParams.append("e_a",i),o.searchParams.append("e_n",t),s.isProductionEnvironment()?this._sendRequest(o.toString()):console.log("LT Event tracking disabled in dev mode",{actionCategory:r,action:i,actionName:a,trackingUrl:o})}static trackEvent(e,t,n,r,i){this._getTrackingUrlForEvent(e,t,n,r,i).then((r=>{s.isProductionEnvironment()?this._sendRequest(r):console.log("LT Event tracking disabled in dev mode",{actionCategory:e,action:t,actionName:n,trackingUrl:r})})).catch((e=>{console.log("LT could not track because:",e&&e.message)}))}static trackInstall(){St.trackEvent("Action","install",mt.getPrimaryLanguageCode(navigator.language)),this._storageController.updateUIState({isNewUser:!0})}static trackActivity(){this._storageController.onReady((()=>{const e=Date.now(),{sessionCount:t,lastActivity:n}=this._storageController.getStatistics();(!n||e-n>St.ACTIVITY_TRACK_INTERVAL)&&this._storageController.updateStatistics({sessionCount:t+1,lastActivity:e}).then((()=>{this.trackEvent("Action","ping",mt.getPrimaryLanguageCode(navigator.language)),this.trackUserActivity()}))}))}static trackActiveAfterOneWeek(){this._storageController.onReady((()=>{const e=Date.now(),{firstVisit:t}=this._storageController.getStatistics(),{isNewUser:n}=this._storageController.getUIState();if(n&&t){const n=6048e5,r=e-1e3*t;r>n&&r<8*n&&this._storageController.updateUIState({isNewUser:!1}).then((()=>{this.trackEvent("Action","active_after_one_week",mt.getPrimaryLanguageCode(navigator.language))})).catch((()=>null))}}))}static trackUserActivity(){this._storageController.onReady((()=>{const{username:e}=this._storageController.getSettings();if(!e||this._storageController.hasCustomServer())return;const n=new FormData;n.append("email",e),n.append("useragent",t.getUserAgentIdentifier()),Ke(b,{method:"POST",mode:"cors",credentials:"omit",body:n},1e4).catch((()=>null))}))}static trackError(e,n,r=""){try{if(t.isUnsupportedBrowser())return;if(St._errorCount++,St._errorCount>Q)return;if("string"!=typeof n)return;if(St._loggedErrors)if(St._loggedErrors.length<St.THROTTLE_REQUESTS)St._loggedErrors.push(Date.now());else{const e=Date.now();if(!(e-St._loggedErrors[0]>=St.MAX_TIME))return;St._loggedErrors.push(e),St._loggedErrors.splice(0,1)}else St._loggedErrors=[Date.now()];let s="JS-Error";"message"===e?s="Message-Error":"http"===e?s="HTTP-Error":"other"===e&&(s="Other-Error");let i=He();i=i.replace(/^moz-extension:\/\/[a-z0-9\-]+\//,"moz-extension://xxxx-xxxx-xxxx-xxxx/"),i.match(/(chrome|moz|safari)\-extension:/)||(i=void 0),this.trackEvent(s,n,r||i,i)}catch(e){console.error("Error while logging error from language tool",e)}}static trackStat(e,t){0===Math.floor(10*Math.random())&&St.trackEvent("Stat",e,t)}static trackTextLength(e){if(0===e)return;let t="";t=e<=100?"1-100":e<=1e3?"101-1000":e<=2500?"1001-2500":e<=5e3?"2501-5000":e<=7500?"5001-7500":e<=1e4?"7501-10000":e<=15e3?"10001-15000":e<=2e4?"15001-20000":e<=4e4?"20001-40000":e<=6e4?"40001-60000":e<=8e4?"60001-80000":e<=1e5?"80001-100000":">100000",this.trackStat("text_length",t)}}St.TRACKING_BASE_URL="https://analytics.languagetoolplus.com/matomo/piwik.php",St.TRACKING_BASE_PAGE_URL="https://fake/",St.ACTIVITY_TRACK_INTERVAL=864e5,St.MAX_TIME=6e4,St.THROTTLE_REQUESTS=10,St._isInitialized=!1,St._loggedErrors=null,St._errorCount=0;
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
class Tt{static init(){this._isInitialized||(this._storageController=pt.create(),this._startSync(),this._isInitialized=!0)}static _startSync(){this._storageController.onReady((()=>{if(!this._isSyncCapable())return;const{isDictionarySynced:e}=this._storageController.getSettings();e?this.downloadAll():this.checkForInitialSync()}))}static _isSyncCapable(){if(!this._storageController.isReady())return!1;if("extension"!==s.getType())return!1;if(this._storageController.hasCustomServer())return!1;const{username:e,password:t,token:n}=this._storageController.getSettings();return e&&(t||n)}static disableSync(){return this._storageController.updateSettings({isDictionarySynced:!1})}static checkForInitialSync(){this._storageController.onReady((()=>{const{isDictionarySynced:e,dictionary:t}=this._storageController.getSettings();if(e)return;if(!this._isSyncCapable())return;St.trackEvent("Action","dict_sync:started");const n=t.slice(0),r=t.length;this.addBatch(n).then((()=>this.downloadList())).then((e=>{const t=e.filter((e=>n.includes(e))).length,s=t/r;s<.9&&r-t>=10?St.trackEvent("Action","dict_sync:failed_comparison",String(s)):this._storageController.updateSettings({isDictionarySynced:!0,dictionary:e}).then((()=>{St.trackEvent("Action","dict_sync:succeeded")})).catch((()=>{St.trackEvent("Action","dict_sync:failed_storage")}))})).catch((()=>{St.trackEvent("Action","dict_sync:failed_sync")}))}))}static addBatch(e){if(this._syncing)return Promise.reject();if(!this._isSyncCapable())return Promise.reject();if(e.length>this.MAX_WORDS)return St.trackEvent("Action","too_many_words_for_dictionary_batch_add",String(e.length)),Promise.reject();this._syncing=!0;const t=this._chunkBatches(e);let n=0;return new Promise(((e,r)=>{const s=()=>{const i=t.shift();if(!(null==i?void 0:i.length)&&!t.length)return this._syncing=!1,void e();const a=this._filterValidWords(i);a.length?this.addWord(a).then((()=>tt(1400))).then(s).catch((e=>++n>4?(this._syncing=!1,void r(e)):s())):s()};s()}))}static _filterValidWords(e){return(Array.isArray(e)?e:[e]).filter((e=>Boolean((null==e?void 0:e.trim())&&!e.trim().match(/\s/)&&!e.match(this.EMOJI_REGEXP))))}static _chunkBatches(e){const t=[],n=e.slice(0,this.MAX_WORDS);let r;for(;(r=n.splice(0,this.BATCH_SIZE))&&r.length>0;)t.push(r);return t}static removeBatch(e){return this._deleting?Promise.reject():this._isSyncCapable()?(St.trackEvent("Action","dict_batch_delete:started",String(e.length)),e=e.slice(0,this.MAX_WORDS),this._deleting=!0,new Promise(((t,n)=>{const r=()=>{if(void 0===e.shift()&&!e.length)return this._deleting=!1,St.trackEvent("Action","dict_batch_delete:succeeded"),void t();const s=this._filterValidWords(e);s.length?this.removeWord(s).then((()=>tt(1500))).then(r).catch((e=>{this._deleting=!1,St.trackEvent("Action","dict_batch_delete:failed",e&&e.message),n(e)})):r()};r()}))):Promise.reject()}static downloadAll(){this._deleting||this._storageController.onReady((()=>{if(!this._isSyncCapable())return;const{isDictionarySynced:e}=this._storageController.getSettings();e&&this.downloadList().then((e=>{this._storageController.updateSettings({dictionary:e})})).catch((()=>null))}))}static _getBaseUrl(){const e=new URL("/enterprise/v1/dictionary/words",R);return e.searchParams.append("type","personal"),e}static _getHeaders(){const{username:e,token:t}=this._storageController.getSettings(),n=new Headers;if(!e||!t)return[n,new Error("User must be authenticated for interacting with the dictionary")];{const r=btoa(`${e}:${t}`);n.append("Authorization",`Basic ${r}`),n.append("Content-Type","application/json")}return[n,null]}static addWord(e,t=!1){const n=this._getBaseUrl(),[r,s]=this._getHeaders(),i=(Array.isArray(e)?e:[e]).map((e=>e.trim()));return s?Promise.reject(s):fetch(n.toString(),{method:"POST",body:JSON.stringify({words:i}),headers:r}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`)))).catch((n=>t?(St.trackEvent("Action","dict_sync_add:failed",i.slice(0,3).concat(["…"]).join(",")),Promise.reject(n)):tt(5e3).then((()=>this.addWord(e,!0)))))}static removeWord(e,t=!1){const n=this._getBaseUrl(),[r,s]=this._getHeaders(),i=(Array.isArray(e)?e:[e]).map((e=>e.trim()));return s?Promise.reject(s):fetch(n.toString(),{method:"DELETE",body:JSON.stringify({words:i}),headers:r}).then((e=>e.ok?Promise.resolve():Promise.reject(new Error(`Status: ${e.status}`)))).catch((n=>t?(St.trackEvent("Action","dict_sync_remove:failed",i.slice(0,3).concat(["…"]).join(",")),Promise.reject(n)):tt(5e3).then((()=>this.removeWord(e,!0)))))}static downloadList(){let e=this._getBaseUrl();const[t,n]=this._getHeaders();return n?Promise.reject(n):(e.searchParams.append("limit",String(2e3)),fetch(e.toString(),{method:"GET",headers:t}).then((e=>e.ok?e.json():Promise.reject(new Error(`[${e.status}] Download request failed`)))).then((e=>Array.isArray(null==e?void 0:e.words)?Promise.resolve(e.words.filter((e=>"string"==typeof e))):Promise.reject(new Error("Empty response while loading dictionary")))).catch((e=>(St.trackEvent("Action","dict_download:failed",e&&e.message),Promise.reject(e)))))}}Tt.MAX_WORDS=5e3,Tt.BATCH_SIZE=250,Tt._isInitialized=!1,Tt._syncing=!1,Tt._deleting=!1,Tt.EMOJI_REGEXP=/\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]/;var Ct=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};const It={accept:"application/json","content-type":"application/json"};let Rt="claudia";function Pt(e){return"object"==typeof e&&null!==e&&"string"==typeof e.text&&("number"==typeof(t=e.score)||"object"==typeof t&&null!==t&&!1===Object.values(t).some((e=>"number"!=typeof e)))&&"string"==typeof e.label&&"string"==typeof e.origin&&"string"==typeof e.uuid;var t}function yt(){return Ct(this,void 0,void 0,(function*(){const t=function(){const t=(typeof e).indexOf("o")>-1;return Rt=t?le:Rt,("__"+Rt+"::"+~~(+new Date/1e3)).substring(2,64)}();return yield function(e){return Te(this,void 0,void 0,(function*(){const t=(new TextEncoder).encode(e),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}))}(t)}))}class Nt{static load(e,t,n,r,s){var i;return Ct(this,void 0,void 0,(function*(){const a=this._rewriteCache.get(t.trim()),o=null!==(i=this._history.get(t))&&void 0!==i?i:null;if(a)return Promise.resolve({rephrases:a,previousSentence:o});const c=(yield this._request("rewrite","/rewriting/rewrite",e,t,n,r,s)).filter((e=>Pt(e))).map((({text:e,score:t,label:n,origin:r,uuid:s})=>({text:e,score:t,label:n,origin:r,uuid:s}))).filter((({text:e},t,n)=>n.findIndex((({text:t})=>e===t))===t));return c.length>0&&this._rewriteCache.set(t.trim(),c),{rephrases:c,previousSentence:o}}))}static report(e,t){return Ct(this,void 0,void 0,(function*(){this.abort("report"),"string"==typeof t.chosenSentence&&this._history.set(t.chosenSentence,t.originalSentence);const n=new AbortController,r=JSON.stringify(Object.assign(Object.assign({},t),{uuid:e})),s=this._abortControllers.get("report")||[];s.push(n),this._abortControllers.set("report",s);try{return yield fetch(`${L}/rewriting/report`,{method:"post",signal:n.signal,mode:"cors",headers:It,body:JSON.stringify({data:r})}),!0}catch(e){return!1}}))}static abort(e){const t=void 0===e?["report","rewrite"]:[e];for(const e of t){const t=this._abortControllers.get(e)||[];this._abortCurrentRequests(t),this._abortControllers.set(e,[])}}static _request(e,t,n,r,s,i,a){return Ct(this,void 0,void 0,(function*(){this.abort(e);const o=JSON.stringify({text:r,offset:0,length:0,count:"rewrite"===e?5:1,userID:n,language:s.slice(0,2),inhouseOnly:i,email:null==a?void 0:a.email,token:null==a?void 0:a.token,p:null==a?void 0:a.isPremium}),c=new AbortController,l=this._abortControllers.get(e)||[];It["X-LT-checksum"]=yield yt(),(null==a?void 0:a.isPremium)&&(It["X-LT-p"]="1"),l.push(c),this._abortControllers.set(e,l);const u=yield fetch(T+t,{method:"post",signal:c.signal,mode:"cors",headers:It,body:o});if(!1===u.ok){const e=524===u.status?"ServerTimeout":`ServerFailure (${u.status})`;throw new Error(e)}const g=yield u.json(),{rewrites:d=[]}=g||{};return d}))}static requestSplitSentence(e,t,n,r,s){return Ct(this,void 0,void 0,(function*(){const i=this._splitSentenceCache.get(t.trim());if(i)return Promise.resolve(i);const[a]=yield this._request("sentence-splitting","/rewriting/rewrite/sentence_splitting",e,t,n,r,s);return Pt(a)?(this._splitSentenceCache.set(t.trim(),a),a):null}))}static _abortCurrentRequests(e){for(const t of e)t.abort()}}Nt._rewriteCache=new Map,Nt._splitSentenceCache=new Map,Nt._history=new Map,Nt._abortControllers=new Map([["rewrite",[]],["report",[]],["sentence-splitting",[]]]);
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var vt=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};class Ot{static load(e,t,n){return-1===re.indexOf(t)?Promise.reject(new Error("Sorry, synonyms are not supported in this language.")):this._request(e,t,n)}static abort(){return vt(this,void 0,void 0,(function*(){this._abortCurrentRequest()}))}static _request(e,t,n){const r=e.word,s=this._prepareWord(e.word),i=this._getFromCache(s,e.beforeText,e.afterText,t,n);if(i)return Promise.resolve(i);this._abortCurrentRequest(),clearTimeout(this._timeout),this._currentRequest=new AbortController;const a={method:"get",mode:"cors",signal:this._currentRequest.signal};this._timeout=self.setTimeout((()=>this._abortCurrentRequest),this.HTTP_TIMEOUT);const o=new URL(`https://synonyms.languagetool.org/synonyms/${t}/${s}`);return o.searchParams.set("before",e.beforeText),o.searchParams.set("after",e.afterText),n&&o.searchParams.set("motherTongue",n),fetch(o.toString(),a).then((e=>e.json())).then((i=>{if(!i||!i.synsets)throw new Error("Error loading synonyms.");const a=this._buildSynonymSets(s,r,i),o={dataSource:i.dataSource,synonymSets:a,genders:i.genders};return this._setInCache(s,e.beforeText,e.afterText,t,n,o),o})).finally((()=>{this._currentRequest=null,clearTimeout(this._timeout)}))}static _prepareWord(e){return e=e.trim(),Oe(e)?e.charAt(0)+e.substr(1).toLowerCase():e}static _containsSynonymObj(e,t){return e.some((e=>e.word===t.word))}static _buildSynonymSets(e,t,n){const r=[],s=Oe(t)&&t.length>3;return n.synsets.forEach((n=>{if(!n.terms.length)return;let i="",a="";n.terms[0].term.match(this.IS_ONLY_HINT_REGEXP)?(i=`${t} ${n.terms[0].term}`,a=n.terms[0].term.replace(/[\(\)]/g,""),n.terms.shift()):i=n.terms[0].term;const o=[];if(n.terms.forEach((t=>{let n=Array.from(t.term.match(this.HINT_REGEXP)||[]);if(n=n.map((e=>e.replace(this.TERM_REGEXP,"").trim())),n=n.filter((e=>!e.match(/similar/))),n.indexOf("(antonym)")>-1)return;let r=t.term.replace(this.HINT_REGEXP,"").trim();r.match(/[\!\?\,\:\;]/)||r.toLowerCase()!==e.toLowerCase()&&(s&&(r=r.toUpperCase()),r.trim()&&o.push({word:r,hints:n}))})),!o.length)return;const c=r.find((e=>e.type===a&&e.title===i&&e.synonyms.find((e=>this._containsSynonymObj(o,e)))));if(c)o.forEach((e=>{this._containsSynonymObj(c.synonyms,e)||c.synonyms.push(e)}));else{if(a){if(r.filter((e=>e.type===a)).length>=3)return}r.push({title:i,type:a,synonyms:o})}})),r}static _abortCurrentRequest(){this._currentRequest&&(this._currentRequest.abort(),this._currentRequest=null)}static _getFromCache(e,t,n,r,s){const i=this._cache.find((i=>i.word===e&&i.beforeText===t&&i.afterText===n&&i.language===r&&i.motherTongue===s));if(i)return i.result}static _setInCache(e,t,n,r,s,i){this._cache.unshift({word:e,beforeText:t,afterText:n,language:r,motherTongue:s,result:i}),this._cache.length=Math.min(this._cache.length,100)}}Ot.HTTP_TIMEOUT=5e3,Ot._currentRequest=null,Ot._cache=[],Ot.IS_ONLY_HINT_REGEXP=/^\s*\([^\)]+\)\s*$/,Ot.TERM_REGEXP=/\sterm/,Ot.HINT_REGEXP=/(\s|^)\((.+?)\)/g,Ot.emptySynonymResult={synonymSets:[],dataSource:{licenseUrl:"",sourceName:"",sourceUrl:""},genders:null};var bt=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};const Lt=3*X,Dt=()=>({spelling:0,grammar:0,style:0,punctuation:0,typography:0});let wt;function xt(e){if(!wt)return;const{userActivityStates:t}=wt.getStatistics();return t[e]}function Ut(e,t){if(!wt)return;let{userActivityStates:n}=wt.getStatistics();n[e]=t;try{wt.updateStatistics({userActivityStates:n})}catch(e){}}function Mt(e){return bt(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{null==wt||wt.onReady((()=>bt(this,void 0,void 0,(function*(){if(!xt(e))return void n(new Error(`Failed to destroy activity; no User Activity found for UUID "${e}"`));const r=yield kt(e);!function(e){if(!wt)return;let{userActivityStates:t}=wt.getStatistics();delete t[e],wt.updateStatistics({userActivityStates:t})}(e),t(r)}))))}))}))}function kt(e){return bt(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{null==wt||wt.onReady((()=>bt(this,void 0,void 0,(function*(){const r=xt(e);if(r)try{const n={source:r.source,data:Object.assign(Object.assign(Object.assign({rewritings:r.rewritings},r.statistics),r.suggestions),r.meta)};if(!function({data:e}){const t=["checkLevel","writingGoalId","isNewText","language"];return Object.entries(e).filter((([e])=>!1===t.includes(e))).some((([,e])=>Boolean(e)))&&Ie(e.language)}(n))return void t("no_update");!function(e){let t=xt(e);t&&(t=Object.assign(Object.assign({},t),{suggestions:Dt(),statistics:{words:0,sentences:0,hiddenMatches:0,premiumMatches:0,pickyErrors:0,isNewText:!1},rewritings:0}),Ut(e,t))}(e);const s={method:"POST",referrerPolicy:"no-referrer",credentials:"omit",mode:"cors",headers:{Authorization:`Basic ${btoa([r.email,r.token].join(":"))}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};"standalone"===r.source&&(s.keepalive=!0),yield Ke(D,s,3e4),t("success")}catch(e){n("error")}else t("unknown_uuid")}))))}))}))}
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
var Gt,Ft=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((r=r.apply(e,t||[])).next())}))};class Bt{static _initThunderbird(){t.isThunderbird()&&At.registerComposeScripts()}static _installUpdate(){Je().tabs.query({}).then((e=>{e.forEach((e=>{if(!e.id)return;Je().tabs.sendMessage(e.id,{command:"DESTROY"}).catch(console.error.bind(console))}))})),St.trackEvent("Action","pre_update"),self.setTimeout((()=>{Je().runtime.reload()}),2e3)}static _assignToTestGroups(){s.isProductionEnvironment()}static _queryForDarkMode(){return Ft(this,void 0,void 0,(function*(){if(yield this._hasDarkTheme())return!0;const e=yield this._getActiveTabs(),[{id:t}={}]=e;if("number"!=typeof t)return null;const n=yield Je().tabs.sendMessage(t,{command:"CHECK_IS_DARK_MODE"}).catch((()=>({}))),{isDarkMode:r=null}=function(e){return"CHECK_IS_DARK_MODE"===e.initialCommand}(n)?n:{};return r}))}static _hasDarkTheme(){var e;return Ft(this,void 0,void 0,(function*(){if(t.isFirefox()||t.isThunderbird()&&Je().theme){const t=yield Je().theme.getCurrent();if(null===(e=null==t?void 0:t.colors)||void 0===e?void 0:e.toolbar){return ot(t.colors.toolbar)<=35}}return null}))}static _updateIcon(e=!1){t.isSafari()||this._storageController.onReady((()=>Ft(this,void 0,void 0,(function*(){const t=yield this._queryForDarkMode();null!==t?this.setIcon(t,e):this._storageController.updateUIState({isDarkModeEnabled:void 0})}))))}static setIcon(e,n=!1){return Ft(this,void 0,void 0,(function*(){if(t.isSafari())return;const{isDarkModeEnabled:r}=this._storageController.getUIState();(r!==e||n)&&(e?this._browserAction.setIcon({path:{16:"/assets/images/icons/icon16_white.png",32:"/assets/images/icons/icon32_white.png",48:"/assets/images/icons/icon48_white.png",64:"/assets/images/icons/icon64_white.png",128:"/assets/images/icons/icon128_white.png"}}):this._browserAction.setIcon({path:{16:"/assets/images/icons/icon16.png",32:"/assets/images/icons/icon32.png",48:"/assets/images/icons/icon48.png",64:"/assets/images/icons/icon64.png",128:"/assets/images/icons/icon128.png"}}),yield this._storageController.updateUIState({isDarkModeEnabled:e}))}))}static _setContextMenu(){if(!this._contextMenu)return;let e=et.getMessage("contextMenuValidate");this._storageController.hasLanguageToolAccount()&&(e=et.getMessage("contextMenuValidateInEditor")),this._contextMenu.removeAll().then((()=>{this._contextMenu.create({title:e,id:this.CONTEXT_MENU_ID,contexts:["selection"]}),this._contextMenu.onClicked.addListener(((e,t)=>{e.menuItemId===this.CONTEXT_MENU_ID&&this._onContextMenuItemClicked(e,t)})),this._storageController.onReady((()=>this._updateContextMenu()))}))}static _updateContextMenu(){if(!this._contextMenu)return;let e=et.getMessage("contextMenuValidate");this._storageController.hasLanguageToolAccount()&&(e=et.getMessage("contextMenuValidateInEditor")),this._contextMenu.update(this.CONTEXT_MENU_ID,{title:e})}static _updateBadge(e,n){this._browserAction.setBadgeTextColor&&this._browserAction.setBadgeTextColor({tabId:e,color:"#FFFFFF"}),n.enabled&&n.supported?n.capitalization?this._browserAction.setBadgeText({tabId:e,text:""}).catch(console.error.bind(console)):(this._browserAction.setBadgeBackgroundColor&&this._browserAction.setBadgeBackgroundColor({tabId:e,color:"#45A8FC"}).catch(console.error.bind(console)),this._browserAction.setBadgeText({tabId:e,text:t.isOpera()?"":"abc"}).catch(console.error.bind(console))):(this._browserAction.setBadgeBackgroundColor&&this._browserAction.setBadgeBackgroundColor({tabId:e,color:"#F53987"}).catch(console.error.bind(console)),this._browserAction.setBadgeText({tabId:e,text:t.isOpera()?"":"OFF"}).catch(console.error.bind(console)))}static _updateUninstallURL(e="unknown"){const t=this._storageController.getSettings(),n=this._storageController.getPrivacySettings(),r=this._storageController.getStatistics(),i=this._storageController.getTestFlags(),a=Je().runtime.getManifest(),o=a&&a.version||"unknown";e=e.replace("www.","").slice(0,25);const c=new URL(f);c.searchParams.set("autoCheck",String(t.autoCheck)),c.searchParams.set("host",e),c.searchParams.set("v",o),c.searchParams.set("privacyConfirmed",String(n.allowRemoteCheck)),c.searchParams.set("globalPickyMode",String(t.hasPickyModeEnabledGlobally)),c.searchParams.set("usages",String(r.usageCount)),c.searchParams.set("sessions",String(r.sessionCount));const l=this._storageController.getUniqueId();l&&c.searchParams.set("matomo",l);for(const e in i)i.hasOwnProperty(e)&&c.searchParams.set(e,i[e]);s.isProductionEnvironment()||c.searchParams.set("dev",""),Je().runtime.setUninstallURL(c.toString().slice(0,255))}static _setMotherTongue(){this._storageController.onReady((()=>{const{motherTongue:e,geoIpLanguages:t}=this._storageController.getSettings();if(e)return;const n=t.some((e=>!!e.match(/^de/i)))&&navigator.languages[0]&&navigator.languages[0].match(/^de/i),r=Array.from(navigator.languages).some((e=>!e.match(/^(de|en)/i)));n&&!r&&(St.trackEvent("Action","set_mother_tongue","de"),this._storageController.updateSettings({motherTongue:"de"}));const s=t.some((e=>!!e.match(/^fr/i)))&&navigator.languages[0]&&navigator.languages[0].match(/^fr/i),i=Array.from(navigator.languages).some((e=>!e.match(/^(fr|en)/i)));s&&!i&&(St.trackEvent("Action","set_mother_tongue","fr"),this._storageController.updateSettings({motherTongue:"fr"}))}))}static _launchEditor(e,n){let r;e&&(r=Math.round(99999*Math.random())+":"+Date.now(),this._validatorsData.set(r,{id:r,text:e,html:n,timestamp:Date.now()}));let i=s.getURL(`/validator/validator.html?id=${r}`);const{username:a,token:o}=this._storageController.getSettings();if(t.isSafari()){const t=this._storageController.getSettings().userId||void 0;Je().runtime.sendMessage({userId:t,message:{username:a,token:o,text:e,html:n},command:"LAUNCH_DESKTOP_EDITOR"})}else a&&o&&navigator.onLine&&(i=function(e,t,n){const r=new URL("https://languagetool.org/webextension/login");return r.searchParams.set("email",e),r.searchParams.set("addon_token",t),n&&r.searchParams.set("temp_text_id",n),r.toString()}(a,o,r)),Je().tabs.create({url:i}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0})}))}static _onDataLoaded(){St.trackActivity(),this._updateUninstallURL(),this._applyManagedSettings()}static _checkForChangelogPage(){if(t.isThunderbird())return;if(t.isSafari())return;const e=this._storageController.isRelevantForChangelogCoupon();if(!e.status)return void St.trackEvent("Action","changelog:dont_open_page",String(e.reason));const{lastChangelogNov2022Seen:n}=this._storageController.getUIState();n?St.trackEvent("Action","changelog:dont_open_page","already_seen"):t.isSafari()?setTimeout((()=>this._openChangelogPage()),15e3):this._openChangelogPage()}static _openChangelogPage(){const e=Je().runtime.getURL("/changelog/changelog.html");this._changelogOpened||(this._changelogOpened=!0,Je().windows.getAll({windowTypes:["normal"]}).then((n=>{St.trackEvent("Action","changelog:open",n.length?"existing-window":"empty-window");const r=(n||[]).find((e=>e.focused&&"normal"===e.type));if(t.isSafari()){const t="https://languagetool.org/favicon.ico";Je().tabs.create({active:!1,url:t}).then((()=>tt(500))).then((()=>Je().tabs.query({}))).then((n=>{const r=n.find((e=>e.url===t));r&&r.id&&Je().tabs.update(r.id,{url:e})}))}else r?Je().tabs.create({windowId:r.id,active:!1,url:e}):Je().tabs.create({active:!1,url:e})}),(()=>{St.trackError("other","changelog:get_window_error")})))}static _applyManagedSettings(){const{disablePrivacyConfirmation:e}=this._storageController.getManagedSettings(),{allowRemoteCheck:t}=this._storageController.getPrivacySettings();!0!==e||t||(this._storageController.updatePrivacySettings({allowRemoteCheck:!0}),St.trackEvent("Action","accept_privacy_note","managed"))}static _loadConfiguration(){this._storageController.onReady((()=>{if(this._storageController.hasCustomServer())return;const e=Je().runtime.getManifest(),t=e&&e.version||"unknown",n=new URL(v);n.searchParams.set("v",t),Ke(n.toString(),{credentials:"omit"},1e4).then((e=>e.json())).then((e=>{if(e.disabledSites&&Array.isArray(e.disabledSites)){const t={unsupportedDomains:e.disabledSites};this._storageController.updateConfiguration(t)}}))}))}static _checkForPaidSubscription(){this._storageController.checkForPaidSubscription().catch(console.error)}static _syncUserData(){const e=Date.now();this._lastUserDataSync&&this._lastUserDataSync+u>e||(this._lastUserDataSync=e,this._storageController.onReady((e=>Ft(this,void 0,void 0,(function*(){const{username:t,token:n}=e.getSettings();if(!e.hasCustomServer()&&t&&n)try{const r=new URLSearchParams({email:t,addon_token:n}),s=yield Ke(`${A}?${r.toString()}`,{mode:"cors",credentials:"omit"},1e4),{data:i={},error:a}=yield s.json().catch((()=>({error:"Request failed"})));if("string"==typeof a&&a.length>0)return void St.trackError("http","user_data_sync_error",a);const o=Object.assign(Object.assign({},"number"==typeof i.id?{userId:i.id}:void 0),"number"==typeof i.dpa_level?{dpaLevel:i.dpa_level}:void 0);if(e.updateSettings(o),!0===i.prefer_oxford_spelling)e.removeIgnoredRule("OXFORD_SPELLING_Z_NOT_S");else{const t={id:"OXFORD_SPELLING_Z_NOT_S",language:"en",turnOffDate:new Date};e.addIgnoredRule(t)}}catch(e){St.trackError("other","user_data_sync_failed")}})))))}static _onInstalled(e){const{reason:t,previousVersion:n}=e;this._updateIcon(),Je().alarms.create("UPDATE_ICON",{periodInMinutes:a/1e3/60}),this._checkForPaidSubscription(),Je().alarms.create("CHECK_FOR_PAID_SUBSCRIPTION",{periodInMinutes:o/1e3/60}),this._loadConfiguration(),Je().alarms.create("LOAD_CONFIGURATION",{periodInMinutes:c/1e3/60}),this._syncUserData(),Je().alarms.create("SYNC_USER_DATA",{periodInMinutes:u/1e3/60}),Je().alarms.create("SYNC_DICTIONARY",{periodInMinutes:d/1e3/60}),Je().alarms.create("SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES",{periodInMinutes:$/1e3/60}),this._storageController.onReady((()=>{if(this._applyManagedSettings(),"install"===t){if(!this._storageController.getPrivacySettings().allowRemoteCheck&&!this._storageController.getUIState().hasSeenPrivacyConfirmationDialog){this._storageController.updateUIState({hasSeenPrivacyConfirmationDialog:!0});let e=`${p}?new`;s.isProductionEnvironment()||(e+="&dev"),Je().tabs.create({url:e}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0})})),this._assignToTestGroups(),this._updateUninstallURL(),mt.getLanguagesForGeoIPCountry().then((e=>{const t={geoIpLanguages:e.geoIpLanguages,geoIpCountry:e.geoIpCountry||""};"GB"===e.geoIpCountry||"IE"===e.geoIpCountry?t.enVariant="en-GB":"US"===e.geoIpCountry?t.enVariant="en-US":"CA"===e.geoIpCountry?t.enVariant="en-CA":"NZ"===e.geoIpCountry?t.enVariant="en-NZ":"AU"===e.geoIpCountry?t.enVariant="en-AU":"ZA"===e.geoIpCountry?t.enVariant="en-ZA":"DE"===e.geoIpCountry?t.deVariant="de-DE":"AT"===e.geoIpCountry?t.deVariant="de-AT":"CH"===e.geoIpCountry?t.deVariant="de-CH":"BR"===e.geoIpCountry?t.ptVariant="pt-BR":["PT","IT","DE","ES","NL","BE","CH","AT","FR","LU","GB","IE","PL","CZ"].includes(e.geoIpCountry)&&(t.ptVariant="pt-PT");const n="CA"===e.geoIpCountry,r=navigator.languages.some((e=>"en-ca"===e.toLowerCase())),s=navigator.languages.some((e=>"fr-ca"===e.toLowerCase()));if(n||r||s){const e={id:"FRENCH_WHITESPACE",language:"fr",description:"Insertion des espaces fines insécables",turnOffDate:new Date},n=this._storageController.getSettings().ignoredRules;n.push(e),t.ignoredRules=n}if("ZA"===e.geoIpCountry){const e={id:"COMMA_PERIOD_CONFUSION",language:"en",description:"Decimal separator in numbers",turnOffDate:new Date},n=this._storageController.getSettings().ignoredRules;n.push(e),t.ignoredRules=n}{const e={id:"OXFORD_SPELLING_Z_NOT_S",language:"en",turnOffDate:new Date},{ignoredRules:n}=this._storageController.getSettings();n.push(e),t.ignoredRules=n}this._storageController.updateSettings(t),this._setMotherTongue(),this._setPreferredLanguages()})).catch((e=>{this._setPreferredLanguages(),console.error(e),St.trackError("js",e&&e.message)})),St.trackInstall(),At.setNativeSpellCheck(!1)}}else if("update"===t){this._assignToTestGroups(),this._updateUninstallURL(),this._migrate();const e=Je().runtime.getManifest(),t=e&&e.version||"unknown";n!==t&&St.trackEvent("Action","update",String(t))}}))}static _migrate(){this._setPreferredLanguages(),this._updateAPIUrl(),this._setRemainingRephrasings(),this._replacePasswordWithAddOnToken()}static _setPreferredLanguages(){this._storageController.updateSettings({preferredLanguages:this._getInitialPreferredLanguages()})}static _updateAPIUrl(){const{apiServerUrl:e}=this._storageController.getSettings();e.match(/^https?:\/\/languagetool.org\/api/)&&this._storageController.updateSettings({apiServerUrl:C})}static _setRemainingRephrasings(){const e=this._storageController.getSettings(),{hasPaidSubscription:t}=this._storageController.getUIState(),n={};"remainingRephrasingsAmount"in e||(n.remainingRephrasingsAmount=t?null:he),"remainingRephrasingsDate"in e||(n.remainingRephrasingsDate=t?null:(new Date).toISOString()),this._storageController.updateSettings(n)}static _replacePasswordWithAddOnToken(){return Ft(this,void 0,void 0,(function*(){const{username:e,token:t,password:n}=this._storageController.getSettings();if(!e||!n||t.length>0)return;let r=500;try{const t=btoa(`${e}:${n}`),s=this._storageController.getCustomServerUrl()||R,i=new URL("/v2/users/me",s),a=yield fetch(i.toString(),{method:"GET",headers:{Authorization:`Basic ${t}`}}),{addon_token:o,id:c}=yield a.json().catch((()=>({})));if(!o||!c)throw r=a.status,new Error;yield this._storageController.updateSettings({password:"",token:o,userId:c}),St.trackEvent("Action","token_migration_succeeded")}catch(e){St.trackError("http","token_migration_failed",String(r))}}))}static _onMessage(e,t){return new Promise(((e,t)=>{const n=self.setTimeout((()=>t()),3e4);this._storageController.onReady((()=>{self.clearTimeout(n),e()}))})).then((()=>{let n;return!
/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
function(e){return"PAGE_LOADED"===e.command}(e)?!function(e){return"LTASSISTANT_STATUS_CHANGED"===e.command}(e)?!function(e){return"CHECK_FOR_PAID_SUBSCRIPTION"===e.command}(e)?!function(e){return"TRACK_TEXT_LENGTH"===e.command}(e)?!function(e){return"TRACK_EVENT"===e.command}(e)?!function(e){return"OPEN_FEEDBACK_FORM"===e.command}(e)?!function(e){return"SEND_FEEDBACK"===e.command}(e)?!function(e){return"OPEN_OPTIONS"===e.command}(e)?!function(e){return"OPEN_PRIVACY_CONFIRMATION"===e.command}(e)?!function(e){return"CLOSE_CURRENT_TAB"===e.command}(e)?!function(e){return"CHECK_TEXT"===e.command}(e)?!function(e){return"LAUNCH_EDITOR"===e.command}(e)?!function(e){return"GET_VALIDATOR_DATA"===e.command}(e)?!function(e){return"START_DICTIONARY_SYNC"===e.command}(e)?!function(e){return"ADD_WORD_TO_DICTIONARY"===e.command}(e)?!function(e){return"BATCH_ADD_WORDS_TO_DICTIONARY"===e.command}(e)?!function(e){return"REMOVE_WORD_FROM_DICTIONARY"===e.command}(e)?!function(e){return"CLEAR_DICTIONARY"===e.command}(e)?!function(e){return"GET_PREFERRED_LANGUAGES"===e.command}(e)?!function(e){return"LOAD_SYNONYMS"===e.command}(e)?!function(e){return"ABORT_SYNONYMS_REQUEST"===e.command}(e)?!function(e){return"LOAD_PHRASES"===e.command}(e)?!function(e){return"REPORT_PHRASE"===e.command}(e)?!function(e){return"ABORT_PHRASE_REQUESTS"===e.command}(e)?!function(e){return"LOAD_SPLIT_SENTENCE"===e.command}(e)?!function(e){return"UPDATE_DICTIONARY"===e.command}(e)?!function(e){return"OPEN_URL"===e.command}(e)?!function(e){return"OPEN_PREMIUM_PAGE"===e.command}(e)?!function(e){return"LOGIN"===e.command}(e)?!function(e){return"LOGOUT"===e.command}(e)?!function(e){return"ON_LOGIN"===e.command}(e)?!function(e){return"ON_LOGOUT"===e.command}(e)?!function(e){return"BACKGROUND_PING"===e.command}(e)?!function(e){return"INITIALIZE_USER_ACTIVITY"===e.command}(e)?!function(e){return"SEND_USER_ACTIVITY_PINGS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_TEXT_STATISTICS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_APPLIED_SUGGESTIONS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_APPLIED_REWRITINGS"===e.command}(e)?!function(e){return"UPDATE_USER_ACTIVITY_META"===e.command}(e)?!function(e){return"DESTROY_USER_ACTIVITY"===e.command}(e)?function(e){return"SEND_USER_ACTIVITY"===e.command}(e)&&(n=this._onSendUserActivity(t,e)):n=this._onDestroyUserActivity(t,e):n=this._onUpdateUserActivityMeta(t,e):n=this._onUpdateUserActivityAppliedRewritings(t,e):n=this._onUpdateUserActivityAppliedSuggestions(t,e):n=this._onUpdateUserActivityTextStatistics(t,e):n=this._onHandleUserActivityPings(t,e):n=this._onInitializeUserActivity(t,e):n=this._onManifestV3Ping(t,e):n=this._onLogoutUserMessage(t,e):n=this._onLoginUserMessage(t,e):n=this._logoutUserMessage(t,e):n=this._loginUserMessage(t,e):n=this._openPremiumPage(t,e):n=this._onOpenURLMessage(t,e):n=this._onUpdateDictionaryMessage(t,e):n=this._onLoadSplitSentenceMessage(t,e):n=this._onAbortPhraseRequestsMessage(t,e):n=this._onReportRephraseMessage(t,e):n=this._onLoadPhrasesMessage(t,e):n=this._onAbortSynonymsRequestMessage():n=this._onLoadSynonymsMessage(t,e):n=this._onGetPreferredLanguagesMessage(t,e):n=this._onClearDictionaryMessage(t,e):n=this._onRemoveWordFromDictionaryMessage(t,e):n=this._onBatchAddWordToDictionaryMessage(t,e):n=this._onAddWordToDictionaryMessage(t,e):n=this._onStartDictionarySyncMessage(t,e):n=this._onGetValidatorDataMessage(t,e):n=this._onLaunchEditorMessage(t,e):n=this._onCheckTextMessage(t,e):n=this._onCloseCurrentTabMessage(t,e):n=this._onOpenPrivacyConfirmationMessage(t,e):n=this._onOpenOptionsMessage(t,e):n=this._onSendFeedbackMessage(t,e):n=this._onOpenFeedbackFormMessage(t,e):n=this._onTrackEventMessage(t,e):n=this._onTrackTextLengthMessage(t,e):n=this._onCheckForPaidSubscriptionMessage():n=this._onLTAssistantStatusChangedMessage(t,e):n=this._onPageLoadedMessage(t,e),n||Promise.resolve(null)}))}static _onUserCredentialsChanged(e){var t,n;(Boolean(null===(t=e.username)||void 0===t?void 0:t.newValue)||Boolean(null===(n=e.token)||void 0===n?void 0:n.newValue))&&Tt.checkForInitialSync()}static _onAlarm(e){switch(e.name){case"UPDATE_ICON":this._updateIcon();break;case"CHECK_FOR_PAID_SUBSCRIPTION":this._checkForPaidSubscription();break;case"LOAD_CONFIGURATION":this._loadConfiguration();break;case"SYNC_USER_DATA":this._syncUserData();break;case"SYNC_DICTIONARY":Tt.checkForInitialSync();break;case"SEND_AND_DESTROY_COMPLETED_USER_ACTIVITIES":!function(){bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>bt(this,void 0,void 0,(function*(){const e=Date.now();let t=3;const{userActivityStates:n}=wt.getStatistics();for(let r in n)if(e-n[r].lastPing>Lt&&(yield Mt(r),!--t))break}))))}))}();break;default:console.warn("Unknown alarm '%s'",e.name)}}static _onPageLoadedMessage(e,t){if(0!==e.frameId||!e.tab)return;const n=e.tab.id,r={enabled:t.enabled,capitalization:t.capitalization,supported:t.supported,unsupportedMessage:t.unsupportedMessage,language:null,beta:t.beta};this._extensionStates.set(n,r),Je().tabs.detectLanguage&&Je().tabs.detectLanguage(n).then((e=>{e&&"und"!==e&&(r.language=mt.getPrimaryLanguageCode(e))})).catch((e=>{console.error("Error detecting language",e)}));const s=e.tab.url||"about:blank";this._updateUninstallURL(Ve(s)),this._updateBadge(n,r),this._hasDarkTheme().then((e=>{null===e?this.setIcon(t.isDarkMode):this.setIcon(e)})).catch((()=>null))}static _onCheckForPaidSubscriptionMessage(){return Ft(this,void 0,void 0,(function*(){try{return{initialCommand:"CHECK_FOR_PAID_SUBSCRIPTION",isSuccessful:!0,hasPaidSubscription:yield this._storageController.checkForPaidSubscription()}}catch(e){return{initialCommand:"CHECK_FOR_PAID_SUBSCRIPTION",isSuccessful:!1,error:{reason:e.reason,status:e.status,response:e.response,url:e.url,stack:e.stack}}}}))}static _onLTAssistantStatusChangedMessage(e,t){const n=t.tabId||e.tab.id;if(!this._extensionStates.has(n))return;const r=this._extensionStates.get(n);"boolean"==typeof t.enabled&&(r.enabled=t.enabled),"boolean"==typeof t.capitalization&&(r.capitalization=t.capitalization),this._updateBadge(n,r)}static _onTrackTextLengthMessage(e,t){St.trackTextLength(t.textLength)}static _onTrackEventMessage(e,t){St.trackEvent("Action",t.action,t.label)}static _onOpenFeedbackFormMessage(e,n){this._lastScreenshot=null;var r;("function"!=typeof Je().tabs.captureVisibleTab?Promise.reject():"number"==typeof(null===(r=e.tab)||void 0===r?void 0:r.windowId)?Je().tabs.captureVisibleTab(e.tab.windowId):Je().tabs.captureVisibleTab()).then((e=>{this._lastScreenshot=function(e){const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),s=new Uint8Array(r);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return new Blob([r],{type:n})}(e)})).catch((()=>null)).then((()=>{const e=new URL("/feedbackForm/feedbackForm.html","http://example.com");return e.searchParams.append("url",n.url.substr(0,200)),n.html&&e.searchParams.append("html",n.html.substr(0,600)),n.title&&e.searchParams.append("title",n.title),this._lastScreenshot&&e.searchParams.append("screenshot",String(this._lastScreenshot?1:0)),Je().windows.create({url:s.getURL(e.pathname+e.search),type:"popup",width:380,height:520})})).then((e=>{var n,r;e&&e.id&&Je().windows.update(e.id,{left:Math.round((t.isChromium()&&e.left||0)+(((null===(n=self.screen)||void 0===n?void 0:n.availWidth)||760)-380)/2),top:Math.round((t.isChromium()&&e.top||0)+(((null===(r=self.screen)||void 0===r?void 0:r.availHeight)||1040)-520)/2)})}))}static _onSendFeedbackMessage(e,t){const n=new FormData;n.append("sender",t.sender),n.append("text",t.text),this._lastScreenshot&&t.includeScreenshot&&(n.append("screenshot",this._lastScreenshot,`screenshot_${Date.now()}.jpg`),this._lastScreenshot=null),fetch(N,{method:"POST",mode:"cors",credentials:"omit",body:n}).catch((()=>{St.trackError("http","error_send_feedback")}))}static _onOpenOptionsMessage(e,t){let n="/options/options.html";t.ref&&(n+=`?ref=${encodeURIComponent(t.ref)}`),t.target&&(n+=`#${t.target}`),Je().tabs.create({url:s.getURL(n)}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0}).catch(console.error)}))}static _onOpenPrivacyConfirmationMessage(e,t){Je().tabs.create({url:p}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0}).catch(console.error)}))}static _onCloseCurrentTabMessage(e,t){Je().tabs.query({currentWindow:!0,active:!0}).then((e=>{e.length&&Je().tabs.remove(e[0].id).catch((()=>null))}))}static _getInitialPreferredLanguages(){const{geoIpLanguages:e,motherTongue:t,preferredLanguages:n}=this._storageController.getSettings();if(Array.isArray(n)&&n.length)return n;const r=mt.getPrimaryLanguageCode(mt.getUserLanguageCode()),s=navigator.languages.map((e=>mt.getPrimaryLanguageCode(e)));return Me([t,r].concat(e,s,["en"]).filter(Boolean)).map((e=>"nb"===e?"no":"fil"===e?"tl":e))}static _getPreferredLanguages(e){const{preferredLanguages:t,motherTongue:n}=this._storageController.getSettings();if(e.tab){const n=this._extensionStates.get(e.tab.id);n&&n.language&&t.push(n.language)}return n&&t.push(n),t.push("en"),Me(t)}static _onCheckTextMessage(e,n){if(St.trackActivity(),0===this._checkThrottlingCount&&setTimeout((()=>{this._checkThrottlingCount=0}),5e3),this._checkThrottlingCount++,this._checkThrottlingCount>n.options.throttlingLimit){const e={initialCommand:"CHECK_TEXT",isSuccessful:!1,instanceId:n.metaData.instanceId,error:{status:0,reason:"TooManyRequests"}};return Promise.resolve(e)}let r=this._getPreferredLanguages(e);if(n.metaData.elementLanguage){const e=mt.getPrimaryLanguageCode(n.metaData.elementLanguage.toLowerCase());mt.LANGUAGES.some((t=>mt.getPrimaryLanguageCode(t.code)===e))?r=[e]:r.push(e)}const i=this._storageController.getStatistics().usageCount+1;this._storageController.updateStatistics({usageCount:i});const a=Ve(n.metaData.pageUrl);this._updateUninstallURL(a);const o=[],{username:c,password:l,token:u,motherTongue:g,enVariant:d,deVariant:h,ptVariant:m,caVariant:_,dictionary:E}=this._storageController.getSettings(),{hasPaidSubscription:p,showRuleId:f}=this._storageController.getUIState(),A=this._storageController.getCheckSettings(a,"unknown");let S=null;c&&u?S={email:c,token:u}:c&&l&&(S={email:c,password:l});const T=this._storageController.getCustomServerUrl();"extension"!==s.getType()||T||p||(S=null);const C={instanceId:n.metaData.instanceId,user:S,isPremium:p,apiServerUrl:T,languageVariants:{en:d,de:h,pt:m,ca:_},dictionary:E,disabledRules:this._storageController.getIgnoredRuleIds(),preferredLanguages:r,motherTongue:g,checkLevel:n.metaData.checkLevel,recipientInfo:n.metaData.recipientInfo,writingGoalId:null,ignoreCapitalizationErrors:!A.shouldCapitalizationBeChecked,ignoreCapitalizationErrorsAtLineStart:n.options.ignoreCapitalizationErrorsAtLineStart,useParagraphLevelCaching:n.options.useParagraphLevelCaching,debug:f,userAgent:t.getUserAgentIdentifier(),version:s.getVersion(),qb:n.options.enableQuillBot,ggec:n.options.enableGGec};return n.options.checkTextLevel?o.push(dt.checkTextLevel(n.text,n.forceLanguage?n.language:null,C,n.hasUserChangedLanguage)):o.push(dt.detectLanguage(n.text,n.forceLanguage?n.language:null,C)),o.push(dt.checkParagraphLevel(n.changedParagraphs,n.language,C,!n.forceLanguage)),Promise.all(o).then((([e,t])=>{let r=e.language||n.language;const s=!(!r||r.name!==this.UNSUPPORTED_LANGUAGE_NAME);s&&(r=null);return{initialCommand:"CHECK_TEXT",isSuccessful:!0,instanceId:n.metaData.instanceId,text:n.text,changedParagraphs:n.changedParagraphs,language:r,isUnsupportedLanguage:s,isIncompleteResult:t.isIncompleteResult,textLevelErrors:e.errors,textLevelPremiumErrors:e.premiumErrors,textLevelPremiumPickyErrors:e.premiumPickyErrors,textLevelPickyErrors:e.pickyErrors,paragraphLevelErrors:t.errors,paragraphLevelPremiumErrors:t.premiumErrors,paragraphLevelPremiumPickyErrors:t.premiumPickyErrors,paragraphLevelPickyErrors:t.pickyErrors,paragraphLevelSentenceRanges:t.sentenceRanges}})).catch((e=>{if(e&&"AbortError"===e.reason)return;n.options.textTooLongMessage&&"TextTooLong"===e.reason&&(e.message=n.options.textTooLongMessage);return{initialCommand:"CHECK_TEXT",isSuccessful:!1,instanceId:n.metaData.instanceId,error:{reason:e.reason,status:e.status,response:e.response,url:e.url,stack:e.stack}}}))}static _onLaunchEditorMessage(e,t){this._launchEditor(t.text)}static _onGetValidatorDataMessage(e,t){const n=this._validatorsData.get(t.id);this._validatorsData.delete(t.id);const r={initialCommand:"GET_VALIDATOR_DATA",isSuccessful:!0,text:n?n.text:"",html:n?n.html:void 0};return Promise.resolve(r)}static _onStartDictionarySyncMessage(e,t){Tt.checkForInitialSync()}static _onAddWordToDictionaryMessage(e,t){Tt.addWord(t.word).catch((()=>null))}static _onBatchAddWordToDictionaryMessage(e,t){Tt.addBatch(t.words).catch((()=>null))}static _onRemoveWordFromDictionaryMessage(e,t){Tt.removeWord(t.word).catch((()=>null))}static _onClearDictionaryMessage(e,t){Tt.removeBatch(this._storageController.getSettings().dictionary).catch((()=>null))}static _onUpdateDictionaryMessage(e,t){Tt.downloadAll()}static _onOpenURLMessage(e,t){const{tabs:n}=Je();St.trackEvent("Action","open_tab",t.url),"self"===t.target?n.update({url:t.url}):n.create({url:t.url}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0})}))}static _onGetPreferredLanguagesMessage(e,t){const n=this._getPreferredLanguages(e),r=this._storageController.getSettings(),s=n.map((e=>r[`${e}Variant`]||e));return Promise.resolve(s)}static _onLoadSynonymsMessage(e,t){return Ot.load(t.wordContext,t.language,t.motherLanguage)}static _onAbortSynonymsRequestMessage(){return Ot.abort()}static _onLoadPhrasesMessage(e,{uuid:t,phrase:n,language:r,inhouseOnly:s,user:i}){return Nt.load(t,n,r,s,i).then((e=>e),(e=>{switch(!0){case"AbortError"===e.name:throw new Error(Ee);case"ServerTimeout"===e.message:throw new Error(pe);default:throw new Error(fe)}}))}static _onReportRephraseMessage(e,{uuid:t,report:n}){return Nt.report(t,n)}static _onAbortPhraseRequestsMessage(e,{type:t}){return Nt.abort(t)}static _onLoadSplitSentenceMessage(e,{uuid:t,phrase:n,language:r,inhouseOnly:s,user:i}){return Nt.requestSplitSentence(t,n,r,s,i)}static _onContextMenuItemClicked(e,n){if(n&&n.id&&!t.isThunderbird()){const t={command:"GET_SELECTED_TEXT"};Je().tabs.sendMessage(n.id,t).then((e=>{this._launchEditor(e.selectedText,e.selectedHTML)})).catch((t=>{console.warn("Could not get selected text",t),this._launchEditor(e.selectionText)}))}else this._launchEditor(e.selectionText);this._storageController.updateUIState({hasUsedValidator:!0})}static _openPremiumPage(e,n){if(t.isSafari()&&!n.campaign.startsWith("addon2-changelog")){const e=this._storageController.getSettings().userId||void 0,t="safari";return St.trackEvent("Action","go_to_apple_upgrade",n.campaign),void Je().runtime.sendMessage({message:Object.assign(Object.assign({},n),{userId:e,target:t}),command:"LAUNCH_APPLE_UPGRADE"})}let r=function(e,t=0,n=0,r=0,s="",i){const a=new URL("https://languagetool.org/premium");return a.searchParams.set("utm_campaign",e),i&&a.searchParams.set("textLang",i),s&&a.searchParams.set("historicMatches",s),t&&a.searchParams.set("grammarMatches",String(t)),r&&a.searchParams.set("punctuationMatches",String(r)),n&&a.searchParams.set("styleMatches",String(n)),navigator.webdriver&&a.searchParams.set("disable_test","1"),a.toString()}(n.campaign,n.hiddenGrammarMatches,n.hiddenStyleMatches,n.hiddenPunctuationMatches,n.historicMatches,n.textLanguage);t.isThunderbird()&&Je().windows.openDefaultBrowser?Je().windows.openDefaultBrowser(r):Je().tabs.create({url:r}).then((e=>{e&&e.windowId&&Je().windows.update(e.windowId,{focused:!0})}))}static _loginUserMessage(e,n){t.isSafari()&&Je().runtime.sendMessage({command:"LOGIN"})}static _logoutUserMessage(e,n){t.isSafari()&&Je().runtime.sendMessage({command:"LOGOUT"})}static _onLoginUserMessage(e,t){this._storageController.updateSettings({username:t.username,password:"",userId:t.userId,token:t.token,knownEmail:t.username,apiServerUrl:C}).then((()=>{this._storageController.checkForPaidSubscription()})),s.isProductionEnvironment()||s.startDictionarySync()}static _onLogoutUserMessage(e,t){this._storageController.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1}).then((()=>{this._storageController.checkForPaidSubscription()}))}static _onManifestV3Ping(e,t){return Promise.resolve("success")}static _onInitializeUserActivity(e,t){return function(e){return bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>{Ut(e.uuid,{email:e.email,token:e.token,source:e.source,suggestions:Dt(),statistics:{words:0,sentences:0,hiddenMatches:0,premiumMatches:0,pickyErrors:0,isNewText:e.isNewText},meta:{language:e.language,writingGoalId:e.writingGoalId,checkLevel:e.checkLevel},rewritings:0,lastPing:Date.now()})}))}))}(t.data)}static _onHandleUserActivityPings(e,t){return function(e){return bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>{e.forEach((e=>{const t=xt(e);t&&(t.lastPing=Date.now(),Ut(e,t))}))}))}))}(t.uuids)}static _onUpdateUserActivityTextStatistics(e,t){return function(e,t){return bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>{const n=xt(e);if(!n)return;const r=Object.entries(t).reduce(((e,[t,n])=>("number"==typeof n?e[t]+=n:e[t]=n,e)),n.statistics);Ut(e,Object.assign(Object.assign({},n),{statistics:r,lastPing:Date.now()}))}))}))}(t.uuid,t.stats)}static _onUpdateUserActivityAppliedSuggestions(e,t){return function(e,t,n){return bt(this,void 0,void 0,(function*(){(function(e){return"custom"===e})(t)||null==wt||wt.onReady((()=>{const r=xt(e);if(!r)return;const s=r.statistics.premiumMatches+Number(n);Ut(e,Object.assign(Object.assign({},r),{suggestions:Object.assign(Object.assign({},r.suggestions),{[t]:r.suggestions[t]+1}),statistics:Object.assign(Object.assign({},r.statistics),{premiumMatches:s}),lastPing:Date.now()}))}))}))}(t.uuid,t.type,t.isPremium)}static _onUpdateUserActivityAppliedRewritings(e,t){return function(e){return bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>{const t=xt(e);t&&Ut(e,Object.assign(Object.assign({},t),{rewritings:t.rewritings+1,lastPing:Date.now()}))}))}))}(t.uuid)}static _onUpdateUserActivityMeta(e,t){return function(e,t){return bt(this,void 0,void 0,(function*(){null==wt||wt.onReady((()=>{const n=xt(e);n&&Ut(e,Object.assign(Object.assign({},n),{meta:t,lastPing:Date.now()}))}))}))}(t.uuid,t.meta)}static _onSendUserActivity(e,t){return kt(t.uuid)}static _onDestroyUserActivity(e,t){return Mt(t.uuid)}static _getActiveTabs(){return Ft(this,void 0,void 0,(function*(){try{return yield Je().tabs.query({currentWindow:!0,status:"complete",windowType:"normal"})}catch(e){return[]}}))}}Gt=Bt,Bt.UNSUPPORTED_LANGUAGE_NAME="NoopLanguage",Bt.CONTEXT_MENU_ID="languagetool-menu",Bt._lastUserDataSync=null,Bt._extensionStates=new Map,Bt._validatorsData=new Map,Bt._checkThrottlingCount=0,Bt._lastScreenshot=null,Bt._changelogOpened=!1,(()=>{const{manifest_version:e}=Je().runtime.getManifest();if(et.init(new lt),pt.init((()=>new ft)),s.init(new ct),Tt.init(),St.init(),wt=wt||pt.create(),self.addEventListener("unhandledrejection",(function(e){const t=String(e.reason);t.includes("AbortError")||t.includes("browser is shutting down")||t.includes("FILE_ERROR_NO_SPACE")||St.trackError("js","unhandled_promise_rejection",t)})),Gt._onDataLoaded=Gt._onDataLoaded.bind(Gt),Gt._onInstalled=Gt._onInstalled.bind(Gt),Gt._onMessage=Gt._onMessage.bind(Gt),Gt._onAlarm=Gt._onAlarm.bind(Gt),Gt._onContextMenuItemClicked=Gt._onContextMenuItemClicked.bind(Gt),Gt._storageController=pt.create(),Gt._storageController.onReady(Gt._onDataLoaded),Gt._storageController.addEventListener(Et.eventNames.userCredentialsChanged,Gt._onUserCredentialsChanged),Gt._updateIcon(!0),Je().runtime.onInstalled.addListener(Gt._onInstalled),Je().runtime.onMessage.addListener(Gt._onMessage),Je().alarms.onAlarm.addListener(Gt._onAlarm),Gt._browserAction=(3===e?Je().action:Je().browserAction)||Je().composeAction,Gt._contextMenu=Je().contextMenus||Je().menus,Gt._setContextMenu(),t.isFirefox()||t.isThunderbird()){const e=()=>{Je().runtime.onUpdateAvailable.removeListener(e),Gt._installUpdate()};Je().runtime.onUpdateAvailable.addListener(e)}Gt._initThunderbird()})()})()})();